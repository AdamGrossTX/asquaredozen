<!doctype html><html lang=en-us><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=keyword content="ConfigMgr Microsoft MVP Gross Intune Windows"><meta name=viewport content="width=device-width"><meta name=description content="A.Gross Blog | Adam Gross Enterprise Mobility MVP"><link rel="shortcut icon" href=/img/favicon.ico><title>ConfigMgr AdminService and WMI Methods – A match made in the cloud (1910)-A Square Dozen | A. Gross Blog</title>
<link rel=canonical href=/2019/11/29/configmgr-adminservice-and-wmi-methods-a-match-made-in-the-cloud-1910/><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=https://www.asquaredozen.com/css/custom.css><script src=https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js></script><script src=https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js></script><script src=https://www.asquaredozen.com/js/jquery.slicknav.js></script><script src=https://www.asquaredozen.com/js/asd_SlickNav_Mobile.js></script><script src=https://www.asquaredozen.com/js/custom.js></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-DYVXTRTXN4"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-DYVXTRTXN4",{anonymize_ip:!1})}</script><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.asquaredozen.com/img/ASquareDozen-Logo_Horiz_Twitter.png"><meta name=twitter:title content="ConfigMgr AdminService and WMI Methods – A match made in the cloud (1910)"><meta name=twitter:description content="This post applies to Microsoft Endpoint Configuration Manager 1910 Current Branch
At Microsoft Ignite 2019 Brad Anderson demoed a few things in his sessions, later covered more in depth in other sessions, that highlighted some new features to allow you to leverage the cloud console to manage ConfigMgr-only devices. As I watched these sessions, I realized that they were using the ConfigMgr Administration Service to do integrate into the cloud."><meta property="og:title" content="ConfigMgr AdminService and WMI Methods – A match made in the cloud (1910)"><meta property="og:description" content="This post applies to Microsoft Endpoint Configuration Manager 1910 Current Branch
At Microsoft Ignite 2019 Brad Anderson demoed a few things in his sessions, later covered more in depth in other sessions, that highlighted some new features to allow you to leverage the cloud console to manage ConfigMgr-only devices. As I watched these sessions, I realized that they were using the ConfigMgr Administration Service to do integrate into the cloud."><meta property="og:type" content="article"><meta property="og:url" content="https://www.asquaredozen.com/2019/11/29/configmgr-adminservice-and-wmi-methods-a-match-made-in-the-cloud-1910/"><meta property="og:image" content="https://www.asquaredozen.com/img/ASquareDozen-Logo_Horiz_Twitter.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-11-29T22:12:08+00:00"><meta property="article:modified_time" content="2019-11-29T22:12:08+00:00"><meta property="og:site_name" content="A Square Dozen | A. Gross Blog"></head><body class="home blog"><div id=asd-container><div id=top-bar><div class=container><div id=nav-wrapper><ul class=menu id=menu-top-menu><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/>Home</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=#><span>Feature Updates</span></a><ul class="sub-menu menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2020/07/26/demystifying-windows-10-feature-update-blocks/>Demystifying Windows 10 Feature Update Blocks</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2019/08/22/windows-10-feature-updates-leveraging-setupdiag-for-better-reporting/>Windows 10 Feature Updates – Leveraging SetupDiag for Better Reporting</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2019/10/05/windows-10-feature-updates-the-challenge-of-servicing-in-the-enterprise/>Windows 10 Feature Updates – The Challenge of Servicing in the Enterprise</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2019/08/25/windows-10-feature-updates-using-custom-action-scripts/>Windows 10 Feature Updates – Using Custom Action Scripts</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2019/08/25/windows-10-feature-updates-using-setupconfig-ini-to-manage-feature-updates-in-the-enterprise/>Windows 10 Feature Updates – Using Setupconfig.ini to Manage Feature Updates in the Enterprise</a></li></ul></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2019/02/12/the-system-center-configuration-manager-adminservice-guide/><span>ConfigMgr AdminService</span></a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=#><span>802.1x for OSD</span></a><ul class="sub-menu menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/07/29/configuring-802-1x-authentication-for-windows-deployment-part-1-building-an-802-1x-computer-authentication-script/>Part 1 – Building an 802.1x Computer Authentication Script</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/07/29/configuring-802-1x-authentication-for-windows-deployment-part-2-building-an-802-1x-enabled-winpe-boot-image/>Part 2 – Building an 802.1x Enabled WinPE Boot Image</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/07/29/configuring-802-1x-authentication-for-windows-deployment-part-3-integrating-802-1x-authentication-into-a-bare-metal-task-sequence/>Part 3 – Integrating 802.1x Authentication into a Bare Metal Task Sequence</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/07/29/configuring-802-1x-authentication-for-windows-deployment-part-4-integrating-802-1x-authentication-into-an-in-place-upgrade-task-sequence/>Part 4 – Integrating 802.1x Authentication into an In-Place Upgrade Task Sequence</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/09/29/configuring-802-1x-authentication-for-windows-deployment-part-5-dynamic-whitelisting-using-the-cisco-ise-external-restful-service/>Part 5 – Dynamic Whitelisting using the Cisco ISE External RESTful Service</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/07/29/configuring-802-1x-authentication-for-windows-deployment-tips-and-tricks/>Tips and Tricks</a></li></ul></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=#><span>Task Sequence Hacks</span></a><ul class="sub-menu menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/11/29/building-a-better-task-sequence/>Building a Better Task Sequence</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2019/04/30/building-a-smarter-task-sequence/>Building a Smarter Task Sequence</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/12/14/building-an-even-better-task-sequence/>Building An Even Better Task Sequence</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/07/16/clearing-local-group-policies-during-an-windows-7-to-10-in-place-upgrade-task-sequence/>Clearing Local Group Policies during an Windows 7 to 10 In-Place Upgrade Task Sequence</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/10/03/debugging-sccm-configmgr-task-sequences-on-the-fly/>Debugging SCCM/ConfigMgr Task Sequences on the Fly</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/07/11/dynamically-updating-unattend-xml-during-an-osd-task-sequence-using-mdt-variables-and-zti-scripts/>Dynamically Updating Unattend.XML during an OSD Task Sequence using MDT Variables and ZTI Scripts.</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/06/14/triggering-configmgr-client-actions-from-a-task-sequence/>Triggering ConfigMgr Client Actions from a Task Sequence</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/08/27/using-sccm-task-sequence-variables-as-scripts/>Using SCCM Task Sequence Variables as Scripts</a></li></ul></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=https://github.com/AdamGrossTX><span>GitHub</span></a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=#><span>MORE></span></a><ul class="sub-menu menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/about/>About</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/consulting/>Consulting</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/contact/>Contact</a></li></ul></li></ul></div><div id=top-search><a href=# class=search><i class="fa fa-search"></i></a><div class=show-search><form role=search method=get action=https://www.google.com/search id=searchform><input type=search placeholder="Search and hit enter..." name=q id=q title="Search and hit enter...">
<input type=hidden name=sitesearch value=https://www.asquaredozen.com>
<button type=submit value=Search></form></div></div><div class=menu id=menu-mobile></div></div></div><header id=header class=noslider><div class=container><div id=logo><h1><a href=https://www.asquaredozen.com><img src=/img/A-Square-Dozen-Logo-BlogHeader-1.png alt="A Square Dozen"></a></h1></div></div></header><div class=container><div id=content><div id=main class=fullwidth><article class="post type-post status-publish format-standard has-post-thumbnail hentry"><div class=post-header><h1>ConfigMgr AdminService and WMI Methods – A match made in the cloud (1910)</h1><span class=post-date>November 29, 2019</span></div><div class=post-entry><hr><p>This post applies to <a href=https://docs.microsoft.com/configmgr/core/plan-design/changes/whats-new-in-version-1910>Microsoft Endpoint Configuration Manager 1910 Current Branch</a></p><hr><p>At Microsoft Ignite 2019 Brad Anderson demoed a few things in his sessions, later covered more in depth in other sessions, that highlighted some new features to allow you to leverage the cloud console to manage ConfigMgr-only devices. As I watched these sessions, I realized that they were using the ConfigMgr Administration Service to do integrate into the cloud.</p><hr><p>Watch these sessions for more background on what&rsquo;s coming
BRK008 - <a href="https://myignite.techcommunity.microsoft.com/sessions/81268?source=sessions">Modern management: How/why you do it now</a>
BRK2082 - <a href="https://myignite.techcommunity.microsoft.com/sessions/81685?source=sessions">What&rsquo;s new in Microsoft Endpoint Manager, including Microsoft Intune and Configuration Manager (Part 1 of 2)</a>
BRK3220 - <a href=https://myignite.techcommunity.microsoft.com/sessions/83532>What&rsquo;s new in Microsoft Endpoint Manager, including Microsoft Intune and Configuration Manager (Part 2 of 2)</a></p><hr><p>Paul Mayfield showed how to sync ConfigMgr client policies on ConfigMgr-only, non co-managed, non Intune registered device (<a href="https://myignite.techcommunity.microsoft.com/sessions/81685?source=sessions">BRK2082</a> 11:50 timestamp)</p><p><div class=image><figure><a href=image-77.png target=_blank><img src=image-77.png alt="A Square Dozen Image"></a></figure></div></p><p>Brad Anderson shows a real-time application install on a ConfigMgr-only, non co-managed, non Intune registered device (<a href="https://myignite.techcommunity.microsoft.com/sessions/81268?source=sessions">BRK008</a> 11:00 - timestamp)</p><p><div class=image><figure><a href=image-78.png target=_blank><img src=image-78.png alt="A Square Dozen Image"></a></figure></div></p><p>Both of these demos use the ConfigMgr AdminService on the backend. I know I&rsquo;ve been trying to sell the AdminService as a replacement for WMI, but it&rsquo;s so much more. The AdminService will leverage your Cloud Management Gateway as a web proxy and allow you to take actions on <strong>Any Device from Anywhere</strong> (within reason). With Co-Managed and Intune-only devices, you already had much of this functionality; now with the Microsoft Endpoint Admin Center, you can leverage a centralized cloud console to manage devices, regardless of how they are managed.</p><p>In this post, I&rsquo;d like to highlight some of the new features that have been enabled in in the AdminService in Microsoft Endpoint Configuration Manager 1910 Current Branch. *<em>If you were at <a href=https://mmsmoa.com/>MMSJazz</a>, you may have heard me talk about this in the 1911 Technical Preview.</em></p><h2 id=wmi-methods>WMI Methods!</h2><p>Up until now, the AdminService has been largely read-only - you could only read WMI classes, but none of the WMI methods were available until now. In 1910, the WMI methods are all here! You can see them by listing the WMI route metadata and looking for <strong><code>ActionImport</code></strong> in the XML output.
<strong><code>https://&lt;SERVERNAME>/AdminService/wmi/$metadata</code></strong></p><p><div class=image><figure><a href=image-79.png target=_blank><img src=image-79.png alt="A Square Dozen Image"></a></figure></div></p><p>If you visit the <a href=https://docs.microsoft.com/configmgr/develop/reference/configuration-manager-reference>reference</a> for the WMI class in question, you will be able to find the methods and method syntax. From there, you should be able to work out how to execute any WMI method.</p><h2 id=sms_clientoperation><strong>SMS_ClientOperation</strong></h2><p>The Inside the ConfigMgr console, the right-click menu has several options which leverage the BGB (Big Green Button) or Fast Channel to communicate with the client. These include:</p><ul><li>Run Script</li><li>Install Application</li><li>Client Notification<ul><li>Download Computer Policy</li><li>Download User Policy</li><li>Collect Discovery Data</li><li>Collect Software Inventory</li><li>Collect Hardware Inventory</li><li>Evaluate Application Deployments</li><li>Evaluate Software Update Deployments</li><li>Switch To Next Software Update Point</li><li>Evaluate Device Health Attestation</li><li>Check Conditional Access Compliance</li><li>Wake Up</li><li>Restart</li></ul></li><li>Client Diagnostics<ul><li>Enable Verbose Logging</li><li>Disable Verbose Logging</li></ul></li><li>Endpoint Protection<ul><li>Full Scan</li><li>Quick Scan</li><li>Download Definition</li></ul></li></ul><p><div class=image><figure><a href=image-73.png target=_blank><img src=image-73.png alt="A Square Dozen Image"></a></figure></div></p><p>If you watch <strong><code>SMSProv.log</code></strong> when you click these, you will see that they each call methods on the <strong><code>SMS_ClientOperation</code></strong> WMI class on the SMS Provider server.</p><p><div class=image><figure><a href=image-74.png target=_blank><img src=image-74.png alt="A Square Dozen Image"></a></figure></div></p><p>Each device with the ConfigMgr client installed has a WMI class called <strong><code>ROOT\ccm\ClientSDK</code></strong>. Generally, whenever you want to do things on the client, you would need to remotely connect to the device, attach to the ClientSDK class and trigger a WMI method on the client. Essentially, everything is happening client-side. This is no good when you want to take actions from something like a web API or web console. When you trigger these fast channel methods, all of the logic is in the WMI method on the server side, not the client side. I&rsquo;m sure I&rsquo;m doing a terrible job of describing what actually happens here&mldr;
If we look up the class in the WMI reference <a href=https://docs.microsoft.com/configmgr/develop/reference/protect/sms_clientoperation-server-wmi-class>https://docs.microsoft.com/configmgr/develop/reference/protect/sms_clientoperation-server-wmi-class</a> we can see that there are several methods available to take actions on clients from the server. Here&rsquo;s the PowerShell to trigger a reboot using the <strong><code>SMS_ClientOperation</code></strong> class using Type 17:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-18>18</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:teal>$ServerName</span> = <span style=color:#d14>&#34;&#34;</span>
</span></span><span style=display:flex><span><span style=color:teal>$SiteCode</span> = <span style=color:#d14>&#34;&#34;</span>
</span></span><span style=display:flex><span><span style=color:teal>$NameSpace</span> = <span style=color:#d14>&#34;root\SMS\Site_{0}&#34;</span> <span style=color:#000;font-weight:700>-f</span> <span style=color:teal>$SiteCode</span>
</span></span><span style=display:flex><span><span style=color:teal>$ClassName</span> = <span style=color:#d14>&#34;SMS_ClientOperation&#34;</span>
</span></span><span style=display:flex><span><span style=color:teal>$MethodName</span> = <span style=color:#d14>&#34;InitiateClientOperation&#34;</span>
</span></span><span style=display:flex><span>[<span style=color:teal>string</span>]<span style=color:teal>$TargetCollectionID</span> = <span style=color:#d14>&#34;SMS00001&#34;</span>
</span></span><span style=display:flex><span>[<span style=color:teal>uint32</span>]<span style=color:teal>$Type</span> = <span style=color:#099>17</span> <span style=color:#998;font-style:italic>#Reboot</span>
</span></span><span style=display:flex><span>[<span style=color:teal>uint32</span>]<span style=color:teal>$RandomizationWindow</span> = <span style=color:#099>1</span>
</span></span><span style=display:flex><span>[<span style=color:teal>uint32[]</span>]<span style=color:teal>$TargetResourceIDs</span> = <span style=color:#099>16777325</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#998;font-style:italic>#Using CIM</span>
</span></span><span style=display:flex><span><span style=color:teal>$Args</span> = @{
</span></span><span style=display:flex><span>    TargetCollectionID = <span style=color:teal>$TargetCollectionID</span>
</span></span><span style=display:flex><span>    <span style=color:#0086b3>Type </span>= <span style=color:teal>$Type</span>
</span></span><span style=display:flex><span>    RandomizationWindow = <span style=color:teal>$RandomizationWindow</span>
</span></span><span style=display:flex><span>    TargetResourceIDs = <span style=color:teal>$TargetResourceIDs</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#0086b3>Invoke-CimMethod</span> -Namespace <span style=color:teal>$NameSpace</span> -ClassName <span style=color:teal>$ClassName</span> -MethodName <span style=color:teal>$MethodName</span> -Arguments <span style=color:teal>$Args</span> | <span style=color:#0086b3>Select-Object</span> ReturnValue
</span></span></code></pre></td></tr></table></div></div><p>Now that we&rsquo;ve got a handle on BGB and the <strong><code>SMS_ClientOperation</code></strong> class, let&rsquo;s see how that translates over to the AdminService.</p><h2 id=triggering-client-operations-with-adminservice>Triggering Client Operations with AdminService</h2><p>The big win here is that the client Fast Channel will allow the AdminService to trigger client actions FROM ANYWHERE. Up until now, the AdminService was limited to server-side only methods and had none of the existing WMI methods. With ConfigMgr 1910 Current Branch, we will be able to start triggering client actions from any platform that can call a web API.</p><p>Using the same URL listed earlier <strong><code>https://&lt;SERVERNAME>/AdminService/wmi/$metadata</code></strong> to list the metadata for the WMI route, if we search for <strong><code>SMS_ClientOperation</code></strong>, we will find all of the WMI Methods from the docs listed as <strong><code>ActionImport</code></strong> lines in XML.</p><p><div class=image><figure><a href=image-80.png target=_blank><img src=image-80.png alt="A Square Dozen Image"></a><figcaption>From https://docs.microsoft.com/configmgr/develop/reference/protect/sms_clientoperation-server-wmi-class</figcaption></figure></div></p><p>Here&rsquo;s a listing of the actions available for the <strong><code>SMS_ClientOperation</code></strong> WMI class in the AdminService metadata.</p><p><div class=image><figure><a href=image-81.png target=_blank><img src=image-81.png alt="A Square Dozen Image"></a></figure></div></p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-10>10</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-XML data-lang=XML><span style=display:flex><span><span style=color:navy>&lt;ActionImport</span> <span style=color:teal>Name=</span><span style=color:#d14>&#34;SMS_ClientOperation.InitiateClientOperation&#34;</span> <span style=color:teal>Action=</span><span style=color:#d14>&#34;SCCMGraph.SMS_ClientOperation.InitiateClientOperation&#34;</span><span style=color:navy>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:navy>&lt;ActionImport</span> <span style=color:teal>Name=</span><span style=color:#d14>&#34;SMS_ClientOperation.InitiateClientOperationEx&#34;</span> <span style=color:teal>Action=</span><span style=color:#d14>&#34;SCCMGraph.SMS_ClientOperation.InitiateClientOperationEx&#34;</span><span style=color:navy>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:navy>&lt;ActionImport</span> <span style=color:teal>Name=</span><span style=color:#d14>&#34;SMS_ClientOperation.RestoreQuarantinedItem&#34;</span> <span style=color:teal>Action=</span><span style=color:#d14>&#34;SCCMGraph.SMS_ClientOperation.RestoreQuarantinedItem&#34;</span><span style=color:navy>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:navy>&lt;ActionImport</span> <span style=color:teal>Name=</span><span style=color:#d14>&#34;SMS_ClientOperation.AllowThreat&#34;</span> <span style=color:teal>Action=</span><span style=color:#d14>&#34;SCCMGraph.SMS_ClientOperation.AllowThreat&#34;</span><span style=color:navy>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:navy>&lt;ActionImport</span> <span style=color:teal>Name=</span><span style=color:#d14>&#34;SMS_ClientOperation.ExcludeScanPaths&#34;</span> <span style=color:teal>Action=</span><span style=color:#d14>&#34;SCCMGraph.SMS_ClientOperation.ExcludeScanPaths&#34;</span><span style=color:navy>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:navy>&lt;ActionImport</span> <span style=color:teal>Name=</span><span style=color:#d14>&#34;SMS_ClientOperation.CancelClientOperation&#34;</span> <span style=color:teal>Action=</span><span style=color:#d14>&#34;SCCMGraph.SMS_ClientOperation.CancelClientOperation&#34;</span><span style=color:navy>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:navy>&lt;ActionImport</span> <span style=color:teal>Name=</span><span style=color:#d14>&#34;SMS_ClientOperation.DeleteClientOperation&#34;</span> <span style=color:teal>Action=</span><span style=color:#d14>&#34;SCCMGraph.SMS_ClientOperation.DeleteClientOperation&#34;</span><span style=color:navy>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:navy>&lt;ActionImport</span> <span style=color:teal>Name=</span><span style=color:#d14>&#34;SMS_ClientOperation.IsClientOperationAllowed&#34;</span> <span style=color:teal>Action=</span><span style=color:#d14>&#34;SCCMGraph.SMS_ClientOperation.IsClientOperationAllowed&#34;</span><span style=color:navy>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:navy>&lt;ActionImport</span> <span style=color:teal>Name=</span><span style=color:#d14>&#34;SMS_ClientOperation.IsClientOperationUpdateAllowed&#34;</span> <span style=color:teal>Action=</span><span style=color:#d14>&#34;SCCMGraph.SMS_ClientOperation.IsClientOperationUpdateAllowed&#34;</span><span style=color:navy>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:navy>&lt;EntitySet</span> <span style=color:teal>Name=</span><span style=color:#d14>&#34;SMS_ClientOperation&#34;</span> <span style=color:teal>EntityType=</span><span style=color:#d14>&#34;SCCMGraph.SMS_ClientOperation&#34;</span><span style=color:navy>/&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>Now that we have the class and methods, we just need to trigger the WMI method using an OData Action. For OData, we will be using a HTTP POST method and sending a json formatted BODY as parameters to the method. The URL syntax for OData Actions used by AdminService is:</p><p><code>https://&lt;ServerName>/AdminService/wmi/&lt;WMIClassName>.&lt;WMIMethodName></code></p><p>For this example it would be:<br><code>https://&lt;ServerName>/AdminService/wmi/SMS_ClientOperation.InitiateClientOperation</code></p><p>Since this is a POST method, you have to upload a body. As far as I know, you can&rsquo;t do this natively in a browser and need to use a separate tool. I&rsquo;m using PowerShell, but you can also use <a href=https://www.telerik.com/fiddler>Telerik Fiddler</a> or various other tools to do the same thing.</p><p>Here&rsquo;s a sample bit of PowerShell that I put together to test out the Client Notification actions.</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-27>27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-28>28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-29>29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-30>30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-31>31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-32><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-32>32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-33><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-33>33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-34><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-34>34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-35><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-35>35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-36><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-36>36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-37><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-37>37</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-38><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-38>38</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-39><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-39>39</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-40><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-40>40</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-41><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-41>41</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-42><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-42>42</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-43><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-43>43</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-44><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-44>44</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-45><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-45>45</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-46><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-46>46</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-47><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-47>47</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-48><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-48>48</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-49><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-49>49</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-50><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-50>50</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-51><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-51>51</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-52><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-52>52</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#000;font-weight:700>Param</span> (
</span></span><span style=display:flex><span>    [<span style=color:#0086b3>Parameter</span>(<span style=color:teal>Mandatory</span>=$true,<span style=color:teal>HelpMessage</span>=<span style=color:#d14>&#34;Enter your server name where AdminService is running (SMS Provider Role&#34;</span>)]
</span></span><span style=display:flex><span>    [<span style=color:teal>string</span>]<span style=color:teal>$ServerName</span>,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    [<span style=color:#0086b3>Parameter</span>(<span style=color:teal>Mandatory</span>=$true,<span style=color:teal>HelpMessage</span>=<span style=color:#d14>&#34;Enter the ResourceID of the target device&#34;</span>)]
</span></span><span style=display:flex><span>    [<span style=color:teal>uint32[]</span>]<span style=color:teal>$TargetResourceIDs</span>,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    [<span style=color:#0086b3>Parameter</span>(<span style=color:teal>Mandatory</span>=$false,<span style=color:teal>HelpMessage</span>=<span style=color:#d14>&#34;Enter a Collection ID that the target device is in&#34;</span>)]
</span></span><span style=display:flex><span>    [<span style=color:teal>string</span>]<span style=color:teal>$TargetCollectionID</span> = <span style=color:#d14>&#34;SMS00001&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>   
</span></span><span style=display:flex><span><span style=color:teal>$Types</span> = [<span style=color:teal>Ordered</span>]@{
</span></span><span style=display:flex><span>    <span style=color:#d14>&#34;DownloadComputerPolicy&#34;</span> = <span style=color:#099>8</span>
</span></span><span style=display:flex><span>    <span style=color:#d14>&#34;DownloadUserPolicy&#34;</span> = <span style=color:#099>9</span>
</span></span><span style=display:flex><span>    <span style=color:#d14>&#34;CollectDiscoveryData&#34;</span> = <span style=color:#099>10</span>
</span></span><span style=display:flex><span>    <span style=color:#d14>&#34;CollectSoftwareInventory&#34;</span> = <span style=color:#099>11</span>
</span></span><span style=display:flex><span>    <span style=color:#d14>&#34;CollectHardwareInventory&#34;</span> = <span style=color:#099>12</span>
</span></span><span style=display:flex><span>    <span style=color:#d14>&#34;EvaluateApplicationDeployments&#34;</span> = <span style=color:#099>13</span>
</span></span><span style=display:flex><span>    <span style=color:#d14>&#34;EvaluateSoftwareUpdateDeployments&#34;</span> = <span style=color:#099>14</span>
</span></span><span style=display:flex><span>    <span style=color:#d14>&#34;SwitchToNextSoftwareUpdatePoint&#34;</span> = <span style=color:#099>15</span>
</span></span><span style=display:flex><span>    <span style=color:#d14>&#34;EvaluateDeviceHealthAttestation&#34;</span> = <span style=color:#099>16</span>
</span></span><span style=display:flex><span>    <span style=color:#d14>&#34;CheckConditionalAccessCompliance&#34;</span> = <span style=color:#099>125</span>
</span></span><span style=display:flex><span>    <span style=color:#d14>&#34;WakeUp&#34;</span> = <span style=color:#099>150</span>
</span></span><span style=display:flex><span>    <span style=color:#d14>&#34;Restart&#34;</span> = <span style=color:#099>17</span>
</span></span><span style=display:flex><span>    <span style=color:#d14>&#34;EnableVerboseLogging&#34;</span> = <span style=color:#099>20</span>
</span></span><span style=display:flex><span>    <span style=color:#d14>&#34;DisableVerboseLogging&#34;</span> = <span style=color:#099>21</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[<span style=color:teal>uint32</span>]<span style=color:teal>$RandomizationWindow</span> = <span style=color:#099>1</span>
</span></span><span style=display:flex><span>[<span style=color:teal>string</span>]<span style=color:teal>$MethodClass</span> = <span style=color:#d14>&#34;SMS_ClientOperation&#34;</span>
</span></span><span style=display:flex><span>[<span style=color:teal>string</span>]<span style=color:teal>$MethodName</span> = <span style=color:#d14>&#34;InitiateClientOperation&#34;</span>
</span></span><span style=display:flex><span>[<span style=color:teal>string</span>]<span style=color:teal>$ResultClass</span> = <span style=color:#d14>&#34;SMS_ClientOperationStatus&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:teal>$Types</span>.Keys | <span style=color:#0086b3>ForEach-Object</span> {<span style=color:#0086b3>Write-Host</span> <span style=color:teal>$Types</span>[<span style=color:teal>$_</span>] <span style=color:#a61717;background-color:#e3d2d2>:</span> <span style=color:teal>$_</span>}
</span></span><span style=display:flex><span>[<span style=color:teal>uint32</span>]<span style=color:teal>$Type</span> = <span style=color:#0086b3>Read-Host</span> -Prompt <span style=color:#d14>&#34;Which client action?&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:teal>$PostURL</span> = <span style=color:#d14>&#34;https://{0}/AdminService/wmi/{1}.{2}&#34;</span> <span style=color:#000;font-weight:700>-f</span> <span style=color:teal>$ServerName</span>,<span style=color:teal>$MethodClass</span>,<span style=color:teal>$MethodName</span>
</span></span><span style=display:flex><span><span style=color:teal>$Headers</span> = @{
</span></span><span style=display:flex><span>    <span style=color:#d14>&#34;Content-Type&#34;</span> = <span style=color:#d14>&#34;Application/json&#34;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:teal>$Body</span> = @{
</span></span><span style=display:flex><span>    TargetCollectionID = <span style=color:teal>$TargetCollectionID</span>
</span></span><span style=display:flex><span>    <span style=color:#0086b3>Type </span>= <span style=color:teal>$Type</span>
</span></span><span style=display:flex><span>    RandomizationWindow = <span style=color:teal>$RandomizationWindow</span>
</span></span><span style=display:flex><span>    TargetResourceIDs = <span style=color:teal>$TargetResourceIDs</span>
</span></span><span style=display:flex><span>} | <span style=color:#0086b3>ConvertTo-Json</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span><span style=color:#0086b3>Invoke-RestMethod</span> -Method Post -Uri <span style=color:#d14>&#34;</span>$(<span style=color:teal>$PostURL</span>)<span style=color:#d14>&#34;</span> -Body <span style=color:teal>$Body</span> -Headers <span style=color:teal>$Headers</span> -UseDefaultCredentials | <span style=color:#0086b3>Select-Object</span> ReturnValue
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#998;font-style:italic>#Get Results</span>
</span></span><span style=display:flex><span><span style=color:teal>$GetURL</span> = <span style=color:#d14>&#34;https://{0}/AdminService/wmi/{1}&#34;</span> <span style=color:#000;font-weight:700>-f</span> <span style=color:teal>$ServerName</span>,<span style=color:teal>$ResultClass</span>
</span></span><span style=display:flex><span>(<span style=color:#0086b3>Invoke-RestMethod</span> -Method Get -Uri <span style=color:#d14>&#34;</span>$(<span style=color:teal>$GetURL</span>)<span style=color:#d14>&#34;</span> -UseDefaultCredentials).Value | <span style=color:#0086b3>Format-Table</span>
</span></span></code></pre></td></tr></table></div></div><p>The script will prompt for your server name and the ResourceID of the device you want to target (you can actually provide multiple ResourceIDs). The last 3 lines will query <strong><code>SMS_ClientOperationStatus</code></strong> and you will see a new entry for the ResourceID(s) that you targeted. This is all done using the newly added WMI methods in the AdminService.</p><p><div class=image><figure><a href=image-76.png target=_blank><img src=image-76.png alt="A Square Dozen Image"></a></figure></div></p><p>To verify that the action is actually working, you can check the AdminService.Log and BGBServer.log on the SMS Provider server or the client log that corresponds to the action that you triggered.</p><p><div class=image><figure><a href=2019-11-26_23-31-22.jpg target=_blank><img src=2019-11-26_23-31-22.jpg alt=AdminService.log></a><figcaption>AdminService.log</figcaption></figure></div></p><p><div class=image><figure><a href=image-82.png target=_blank><img src=image-82.png alt="A Square Dozen Image"></a><figcaption>BgbServer.log</figcaption></figure></div></p><p><div class=image><figure><a href=image-83.png target=_blank><img src=image-83.png alt="A Square Dozen Image"></a><figcaption>SCNotify_ASD@Adam.log</figcaption></figure></div></p><p>The best part about WMI methods being available in AdminService now is that we can call them from anywhere. No need to use PowerShell remoting to connect to the server to call the WMI method. Any authorized user can call these methods. You can even use them in Task Sequences.</p><p>As if this wasn&rsquo;t enough, the next part is even better. You may have seen my <a href=/2019/06/18/configmgr-1906-technical-preview-testing-cmpivot-over-cmg-using-adminservice>previous post </a>where I showed how to trigger CMPivot through the Cloud Management Gateway - now you can do real-time client actions over the CMG. Sync client policies, Restart, or even <a href=https://docs.microsoft.com/configmgr/apps/deploy-use/install-app-for-device>Install Applications </a>in real-time.</p><h2 id=triggering-client-operations-over-the-internet>Triggering Client Operations Over the Internet</h2><p>Next I&rsquo;m going to step up the game and I&rsquo;m going to trigger client actions on a Co-Managed device that isn&rsquo;t on the company network from a non-company device on the internet. This will simulate being able to take actions on clients through the <strong>Microsoft Endpoint Manager Admin Center</strong>.</p><p>I&rsquo;ve taken the same machine that I was testing on and moved it to a non-business network with internet only. Then I run a script to use the internet-facing URL of the AdminService on a personal device and I&rsquo;m able to trigger a device restart on the internet-only device. It&rsquo;s not even registered in Intune.</p><p>You will need your external URL and need to generate an authentication token. I followed Sandy&rsquo;s guide here <a href=https://www.scconfigmgr.com/2019/07/16/use-configmgr-administration-service-adminservice-over-internet>https://www.scconfigmgr.com/2019/07/16/use-configmgr-administration-service-adminservice-over-internet</a>. I took her script and rebuilt it a bit then took the sample script from above and integrated it into a new script. Here&rsquo;s the result.</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-1>  1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-2>  2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-3>  3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-4>  4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-5>  5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-6>  6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-7>  7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-8>  8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-9>  9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-10> 10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-11> 11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-12> 12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-13> 13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-14> 14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-15> 15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-16> 16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-17> 17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-18> 18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-19> 19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-20> 20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-21> 21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-22> 22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-23> 23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-24> 24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-25> 25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-26> 26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-27> 27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-28> 28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-29> 29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-30> 30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-31> 31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-32><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-32> 32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-33><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-33> 33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-34><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-34> 34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-35><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-35> 35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-36><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-36> 36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-37><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-37> 37</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-38><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-38> 38</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-39><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-39> 39</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-40><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-40> 40</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-41><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-41> 41</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-42><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-42> 42</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-43><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-43> 43</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-44><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-44> 44</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-45><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-45> 45</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-46><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-46> 46</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-47><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-47> 47</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-48><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-48> 48</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-49><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-49> 49</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-50><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-50> 50</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-51><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-51> 51</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-52><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-52> 52</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-53><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-53> 53</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-54><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-54> 54</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-55><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-55> 55</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-56><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-56> 56</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-57><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-57> 57</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-58><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-58> 58</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-59><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-59> 59</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-60><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-60> 60</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-61><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-61> 61</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-62><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-62> 62</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-63><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-63> 63</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-64><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-64> 64</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-65><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-65> 65</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-66><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-66> 66</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-67><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-67> 67</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-68><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-68> 68</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-69><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-69> 69</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-70><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-70> 70</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-71><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-71> 71</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-72><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-72> 72</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-73><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-73> 73</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-74><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-74> 74</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-75><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-75> 75</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-76><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-76> 76</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-77><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-77> 77</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-78><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-78> 78</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-79><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-79> 79</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-80><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-80> 80</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-81><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-81> 81</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-82><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-82> 82</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-83><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-83> 83</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-84><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-84> 84</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-85><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-85> 85</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-86><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-86> 86</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-87><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-87> 87</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-88><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-88> 88</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-89><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-89> 89</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-90><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-90> 90</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-91><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-91> 91</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-92><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-92> 92</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-93><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-93> 93</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-94><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-94> 94</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-95><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-95> 95</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-96><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-96> 96</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-97><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-97> 97</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-98><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-98> 98</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-99><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-99> 99</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-100><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-100>100</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-101><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-101>101</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-102><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-102>102</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-103><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-103>103</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-104><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-104>104</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-105><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-105>105</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-106><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-106>106</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-107><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-107>107</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-108><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-108>108</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-109><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-109>109</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-110><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-110>110</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-111><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-111>111</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-112><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-112>112</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-113><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-113>113</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-114><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-114>114</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-115><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-115>115</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-116><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-116>116</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-117><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-117>117</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-118><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-118>118</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-119><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-119>119</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-120><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-120>120</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-121><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-121>121</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-122><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-122>122</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-123><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-123>123</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-124><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-124>124</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-125><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-125>125</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-126><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-126>126</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-127><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-127>127</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-128><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-128>128</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-129><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-129>129</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-130><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-130>130</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-131><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-131>131</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-132><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-132>132</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-133><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-133>133</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-134><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-134>134</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-135><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-135>135</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-136><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-136>136</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-137><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-137>137</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-138><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-138>138</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-139><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-139>139</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-140><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-140>140</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-141><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-141>141</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-142><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-142>142</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-143><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-143>143</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-144><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-144>144</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-145><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-145>145</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-146><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-146>146</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-147><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-147>147</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-148><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-148>148</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-149><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-149>149</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-150><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-150>150</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-151><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-151>151</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-152><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-152>152</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-153><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-153>153</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-154><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-154>154</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-155><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-155>155</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-156><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-156>156</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-157><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-157>157</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-158><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-158>158</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-159><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-159>159</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-160><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-160>160</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-161><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-161>161</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-162><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-162>162</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-163><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-163>163</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-164><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-164>164</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-165><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-165>165</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-166><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-166>166</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-167><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-167>167</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-168><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-168>168</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-169><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-169>169</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-170><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-170>170</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-171><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-171>171</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-172><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-172>172</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-173><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-173>173</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-174><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-174>174</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-175><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-175>175</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-176><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-176>176</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-177><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-177>177</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-178><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-178>178</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-179><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-179>179</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-180><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-180>180</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-181><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-181>181</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-182><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-182>182</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-183><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-183>183</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-184><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-184>184</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-185><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-185>185</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-186><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-186>186</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-187><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-187>187</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-188><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-188>188</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-189><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-189>189</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-190><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-190>190</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-191><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-191>191</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-192><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-192>192</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-193><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-193>193</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-194><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-194>194</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-195><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-195>195</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-196><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-196>196</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-197><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-197>197</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-198><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-198>198</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-199><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-199>199</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-200><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-200>200</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-201><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-201>201</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-202><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-202>202</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-203><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-203>203</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-204><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-204>204</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-205><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-205>205</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-206><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-206>206</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-207><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-207>207</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-208><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-208>208</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-209><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-209>209</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-210><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-210>210</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-211><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-211>211</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-212><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-212>212</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-213><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-213>213</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-214><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-214>214</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-215><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-215>215</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-216><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-216>216</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-217><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-217>217</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-218><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-218>218</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-219><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-219>219</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-220><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-220>220</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-221><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-221>221</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-222><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-222>222</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-223><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-223>223</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-224><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-224>224</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-225><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-225>225</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-226><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-226>226</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-227><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-227>227</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-228><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-228>228</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-229><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-229>229</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-230><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-230>230</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-231><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-231>231</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-232><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-232>232</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-233><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-233>233</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-234><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-234>234</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-235><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-235>235</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-236><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-236>236</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-237><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-237>237</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-238><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-238>238</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-239><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-239>239</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#000;font-weight:700>Param</span> (
</span></span><span style=display:flex><span>    [<span style=color:#0086b3>Parameter</span>(<span style=color:teal>Mandatory</span>=$True, <span style=color:teal>HelpMessage</span> = <span style=color:#d14>&#34;Home &gt; App registrations &gt; (Your Native App) - Overview. Copy the Application (client) ID&#34;</span>)]
</span></span><span style=display:flex><span>    [<span style=color:teal>string</span>]
</span></span><span style=display:flex><span>    <span style=color:teal>$ClientID</span>,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    [<span style=color:#0086b3>Parameter</span>(<span style=color:teal>Mandatory</span>=$True, <span style=color:teal>HelpMessage</span> = <span style=color:#d14>&#34;Home &gt; App registrations &gt; (Your Native App) - Overview. Copy the Directory (tenant) ID&#34;</span>)]
</span></span><span style=display:flex><span>    [<span style=color:teal>string</span>]
</span></span><span style=display:flex><span>    <span style=color:teal>$TenantID</span>,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    [<span style=color:#0086b3>Parameter</span>(<span style=color:teal>Mandatory</span>=$True, <span style=color:teal>HelpMessage</span> = <span style=color:#d14>&#34;Home &gt; App registrations &gt; (Your Cloud Management App) - Authentication. Copy the Redirect URI. It should start with ms-appx-web://&#34;</span>)]
</span></span><span style=display:flex><span>    [<span style=color:teal>string</span>]
</span></span><span style=display:flex><span>    <span style=color:teal>$RedirectURI</span>,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    [<span style=color:#0086b3>Parameter</span>(<span style=color:teal>Mandatory</span>=$True, <span style=color:teal>HelpMessage</span> = <span style=color:#d14>&#34;Home &gt; App registrations &gt; (Your Cloud Management App) - Expose an API. Copy the Application ID URI&#34;</span>)]
</span></span><span style=display:flex><span>    [<span style=color:teal>string</span>]
</span></span><span style=display:flex><span>    <span style=color:teal>$ResourceAppIdURI</span>,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    [<span style=color:#0086b3>Parameter</span>(<span style=color:teal>Mandatory</span>=$True, <span style=color:teal>HelpMessage</span> = <span style=color:#d14>&#34;Query your SCCM DB - SELECT ExternalEndpointName, ExternalUrl FROM vProxy_Routings WHERE ExternalEndpointName = &#39;AdminService&#39;&#34;</span>)]
</span></span><span style=display:flex><span>    [<span style=color:teal>string</span>]
</span></span><span style=display:flex><span>    <span style=color:teal>$InternetBaseURL</span>,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    [<span style=color:#0086b3>Parameter</span>(<span style=color:teal>Mandatory</span>=$True, <span style=color:teal>HelpMessage</span> = <span style=color:#d14>&#34;The URL to your AdminService server https://&lt;FQDN&gt;/AdminService&#34;</span>)]
</span></span><span style=display:flex><span>    [<span style=color:teal>string</span>]
</span></span><span style=display:flex><span>    <span style=color:teal>$InternalBaseURL</span>,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    [<span style=color:#0086b3>Parameter</span>(<span style=color:teal>Mandatory</span>=$True, <span style=color:teal>HelpMessage</span> = <span style=color:#d14>&#34;Use Token Auth or Current User Auth&#34;</span>)]
</span></span><span style=display:flex><span>    [<span style=color:teal>switch</span>]
</span></span><span style=display:flex><span>    <span style=color:teal>$UseTokenAuth</span> = $True,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    [<span style=color:#0086b3>Parameter</span>(<span style=color:teal>Mandatory</span>=$True)]
</span></span><span style=display:flex><span>    [<span style=color:teal>uint64[]</span>]<span style=color:teal>$TargetResourceIDs</span>,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    [<span style=color:#0086b3>Parameter</span>(<span style=color:teal>Mandatory</span>=$True)]
</span></span><span style=display:flex><span>    [<span style=color:teal>string</span>]<span style=color:teal>$TargetCollectionID</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:teal>$Main</span> = {
</span></span><span style=display:flex><span>    [<span style=color:teal>Switch</span>]<span style=color:teal>$TryTokenAuth</span> = $false
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>If</span>(!(<span style=color:teal>$UseTokenAuth</span>.IsPresent)) {
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>Try</span> {
</span></span><span style=display:flex><span>            <span style=color:teal>$Data</span> = <span style=color:#0086b3>Initiate-ClientAction</span> -URL <span style=color:teal>$InternetBaseURL</span> -TargetResourceIDs <span style=color:teal>$TargetResourceIDs</span> -TargetCollectionID <span style=color:teal>$TargetCollectionID</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>Catch</span> {
</span></span><span style=display:flex><span>            <span style=color:#0086b3>Write-Host</span> <span style=color:#d14>&#34;An error occurred using default credentials. Trying with Token Auth.&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:teal>$TryTokenAuth</span> = $True
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>If</span>(<span style=color:teal>$UseTokenAuth</span>.IsPresent <span style=color:#000;font-weight:700>-or</span> <span style=color:teal>$TryTokenAuth</span>) {
</span></span><span style=display:flex><span>        <span style=color:teal>$AuthToken</span> = <span style=color:#0086b3>Get-AADAuthToken</span> -ClientID <span style=color:teal>$ClientID</span> -TenantID <span style=color:teal>$TenantID</span> -ResourceAppIDURI <span style=color:teal>$ResourceAppIDURI</span> -RedirectUri <span style=color:teal>$RedirectUri</span> -PromptForNewCredentials Auto
</span></span><span style=display:flex><span>        <span style=color:#998;font-style:italic># Creating header for Authorization token</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>If</span>(<span style=color:teal>$AuthToken</span>) {
</span></span><span style=display:flex><span>            <span style=color:teal>$AuthHeader</span> = @{
</span></span><span style=display:flex><span>                <span style=color:#d14>&#39;Content-Type&#39;</span>  = <span style=color:#d14>&#39;application/json&#39;</span>
</span></span><span style=display:flex><span>                <span style=color:#d14>&#39;Authorization&#39;</span> = <span style=color:#d14>&#34;Bearer &#34;</span> + <span style=color:teal>$AuthToken</span>.AccessToken
</span></span><span style=display:flex><span>                <span style=color:#d14>&#39;ExpiresOn&#39;</span>	    = <span style=color:teal>$AuthToken</span>.ExpiresOn
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>Else</span> {
</span></span><span style=display:flex><span>            <span style=color:#0086b3>Write-Host</span> <span style=color:#d14>&#34;No Auth Token Found. Exiting.&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>Break</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:teal>$Data</span> = <span style=color:#0086b3>Initiate-ClientAction</span> -URL <span style=color:teal>$InternetBaseURL</span> -TargetResourceIDs <span style=color:teal>$TargetResourceIDs</span> -TargetCollectionID <span style=color:teal>$TargetCollectionID</span> -authHeader <span style=color:teal>$authHeader</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>Return</span> <span style=color:teal>$Data</span>.value
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>Function</span><span style=color:#bbb> </span><span style=color:#0086b3>Initiate-ClientAction</span> {
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>Param</span> (
</span></span><span style=display:flex><span>        [<span style=color:#0086b3>Parameter</span>(<span style=color:teal>Mandatory</span>=$true,<span style=color:teal>HelpMessage</span>=<span style=color:#d14>&#34;Enter your server name where AdminService is running (SMS Provider Role&#34;</span>)]
</span></span><span style=display:flex><span>        [<span style=color:teal>string</span>]<span style=color:teal>$URL</span>,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        [<span style=color:#0086b3>Parameter</span>(<span style=color:teal>Mandatory</span>=$true,<span style=color:teal>HelpMessage</span>=<span style=color:#d14>&#34;Enter the ResourceID of the target device&#34;</span>)]
</span></span><span style=display:flex><span>        [<span style=color:teal>uint32[]</span>]<span style=color:teal>$TargetResourceIDs</span>,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        [<span style=color:#0086b3>Parameter</span>(<span style=color:teal>Mandatory</span>=$false,<span style=color:teal>HelpMessage</span>=<span style=color:#d14>&#34;Enter a Collection ID that the target device is in&#34;</span>)]
</span></span><span style=display:flex><span>        [<span style=color:teal>string</span>]<span style=color:teal>$TargetCollectionID</span>,
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:teal>$authHeader</span>
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:teal>$Types</span> = [<span style=color:teal>Ordered</span>]@{
</span></span><span style=display:flex><span>        <span style=color:#d14>&#34;DownloadComputerPolicy&#34;</span> = <span style=color:#099>8</span>
</span></span><span style=display:flex><span>        <span style=color:#d14>&#34;DownloadUserPolicy&#34;</span> = <span style=color:#099>9</span>
</span></span><span style=display:flex><span>        <span style=color:#d14>&#34;CollectDiscoveryData&#34;</span> = <span style=color:#099>10</span>
</span></span><span style=display:flex><span>        <span style=color:#d14>&#34;CollectSoftwareInventory&#34;</span> = <span style=color:#099>11</span>
</span></span><span style=display:flex><span>        <span style=color:#d14>&#34;CollectHardwareInventory&#34;</span> = <span style=color:#099>12</span>
</span></span><span style=display:flex><span>        <span style=color:#d14>&#34;EvaluateApplicationDeployments&#34;</span> = <span style=color:#099>13</span>
</span></span><span style=display:flex><span>        <span style=color:#d14>&#34;EvaluateSoftwareUpdateDeployments&#34;</span> = <span style=color:#099>14</span>
</span></span><span style=display:flex><span>        <span style=color:#d14>&#34;SwitchToNextSoftwareUpdatePoint&#34;</span> = <span style=color:#099>15</span>
</span></span><span style=display:flex><span>        <span style=color:#d14>&#34;EvaluateDeviceHealthAttestation&#34;</span> = <span style=color:#099>16</span>
</span></span><span style=display:flex><span>        <span style=color:#d14>&#34;CheckConditionalAccessCompliance&#34;</span> = <span style=color:#099>125</span>
</span></span><span style=display:flex><span>        <span style=color:#d14>&#34;WakeUp&#34;</span> = <span style=color:#099>150</span>
</span></span><span style=display:flex><span>        <span style=color:#d14>&#34;Restart&#34;</span> = <span style=color:#099>17</span>
</span></span><span style=display:flex><span>        <span style=color:#d14>&#34;EnableVerboseLogging&#34;</span> = <span style=color:#099>20</span>
</span></span><span style=display:flex><span>        <span style=color:#d14>&#34;DisableVerboseLogging&#34;</span> = <span style=color:#099>21</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    [<span style=color:teal>uint32</span>]<span style=color:teal>$RandomizationWindow</span> = <span style=color:#099>1</span>
</span></span><span style=display:flex><span>    [<span style=color:teal>string</span>]<span style=color:teal>$MethodClass</span> = <span style=color:#d14>&#34;SMS_ClientOperation&#34;</span>
</span></span><span style=display:flex><span>    [<span style=color:teal>string</span>]<span style=color:teal>$MethodName</span> = <span style=color:#d14>&#34;InitiateClientOperation&#34;</span>
</span></span><span style=display:flex><span>    [<span style=color:teal>string</span>]<span style=color:teal>$ResultClass</span> = <span style=color:#d14>&#34;SMS_ClientOperationStatus&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:teal>$Types</span>.Keys | <span style=color:#0086b3>ForEach-Object</span> {<span style=color:#0086b3>Write-Host</span> <span style=color:teal>$Types</span>[<span style=color:teal>$_</span>] <span style=color:#a61717;background-color:#e3d2d2>:</span> <span style=color:teal>$_</span>}
</span></span><span style=display:flex><span>    [<span style=color:teal>uint32</span>]<span style=color:teal>$Type</span> = <span style=color:#0086b3>Read-Host</span> -Prompt <span style=color:#d14>&#34;Which client action?&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:teal>$PostURL</span> = <span style=color:#d14>&#34;{0}/wmi/{1}.{2}&#34;</span> <span style=color:#000;font-weight:700>-f</span> <span style=color:teal>$URL</span>,<span style=color:teal>$MethodClass</span>,<span style=color:teal>$MethodName</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:teal>$Headers</span> = @{
</span></span><span style=display:flex><span>        <span style=color:#d14>&#34;Content-Type&#34;</span> = <span style=color:#d14>&#34;Application/json&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:teal>$Body</span> = @{
</span></span><span style=display:flex><span>        TargetCollectionID = <span style=color:teal>$TargetCollectionID</span>
</span></span><span style=display:flex><span>        <span style=color:#0086b3>Type </span>= <span style=color:teal>$Type</span>
</span></span><span style=display:flex><span>        RandomizationWindow = <span style=color:teal>$RandomizationWindow</span>
</span></span><span style=display:flex><span>        TargetResourceIDs = <span style=color:teal>$TargetResourceIDs</span>
</span></span><span style=display:flex><span>    } | <span style=color:#0086b3>ConvertTo-Json</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>If</span>(<span style=color:teal>$authHeader</span>) {
</span></span><span style=display:flex><span>        <span style=color:#0086b3>Invoke-RestMethod</span> -Method Post -Uri <span style=color:#d14>&#34;</span>$(<span style=color:teal>$PostURL</span>)<span style=color:#d14>&#34;</span> -Body <span style=color:teal>$Body</span> -Headers <span style=color:teal>$authHeader</span> | <span style=color:#0086b3>Select-Object</span> ReturnValue
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>Else</span> {
</span></span><span style=display:flex><span>        <span style=color:#0086b3>Invoke-RestMethod</span> -Method Post -Uri <span style=color:#d14>&#34;</span>$(<span style=color:teal>$PostURL</span>)<span style=color:#d14>&#34;</span> -Body <span style=color:teal>$Body</span> -Headers <span style=color:teal>$Headers</span> -UseDefaultCredentials | <span style=color:#0086b3>Select-Object</span> ReturnValue
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#998;font-style:italic>#Get Results</span>
</span></span><span style=display:flex><span>    <span style=color:teal>$GetURL</span> = <span style=color:#d14>&#34;{0}/wmi/{1}&#34;</span> <span style=color:#000;font-weight:700>-f</span> <span style=color:teal>$URL</span>,<span style=color:teal>$ResultClass</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>If</span>(<span style=color:teal>$authHeader</span>) {
</span></span><span style=display:flex><span>        <span style=color:teal>$Result</span> = (<span style=color:#0086b3>Invoke-RestMethod</span> -Method Get -Uri <span style=color:#d14>&#34;</span>$(<span style=color:teal>$GetURL</span>)<span style=color:#d14>&#34;</span> -Headers <span style=color:teal>$authHeader</span>).Value | <span style=color:#0086b3>Format-Table</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>Else</span> {
</span></span><span style=display:flex><span>        (<span style=color:#0086b3>Invoke-RestMethod</span> -Method Get -Uri <span style=color:#d14>&#34;</span>$(<span style=color:teal>$GetURL</span>)<span style=color:#d14>&#34;</span> -Headers <span style=color:teal>$Headers</span> -UseDefaultCredentials).Value | <span style=color:#0086b3>Format-Table</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>Return</span> <span style=color:teal>$Result</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#998;font-style:italic>#Modified Script from Sandy&#39;s blog post</span>
</span></span><span style=display:flex><span><span style=color:#998;font-style:italic>#https://www.scconfigmgr.com/2019/07/16/use-configmgr-administration-service-adminservice-over-internet/</span>
</span></span><span style=display:flex><span><span style=color:#998;font-style:italic>#Follow the instructions in her blog post for building a custom App for the AdminService.</span>
</span></span><span style=display:flex><span><span style=color:#998;font-style:italic>#You TECHNICALLY can use the Native Client App that gets created when you build your CMG, but it&#39;s </span>
</span></span><span style=display:flex><span><span style=color:#998;font-style:italic>#Better to create a custom App instead of hijacking the built in one.</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>Function</span><span style=color:#bbb> </span><span style=color:#0086b3>Get-AADAuthToken</span> {
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>Param</span> (
</span></span><span style=display:flex><span>        [<span style=color:#0086b3>Parameter</span>(<span style=color:teal>Mandatory</span>=$True, <span style=color:teal>HelpMessage</span> = <span style=color:#d14>&#34;Home &gt; App registrations &gt; (Your Native App) - Overview. Copy the Application (client) ID&#34;</span>)]
</span></span><span style=display:flex><span>        [<span style=color:teal>string</span>]
</span></span><span style=display:flex><span>        <span style=color:teal>$ClientID</span>,
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>        [<span style=color:#0086b3>Parameter</span>(<span style=color:teal>Mandatory</span>=$True, <span style=color:teal>HelpMessage</span> = <span style=color:#d14>&#34;Home &gt; App registrations &gt; (Your Native App) - Overview. Copy the Directory (tenant) ID&#34;</span>)]
</span></span><span style=display:flex><span>        [<span style=color:teal>string</span>]
</span></span><span style=display:flex><span>        <span style=color:teal>$TenantID</span>,
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>        [<span style=color:#0086b3>Parameter</span>(<span style=color:teal>Mandatory</span>=$True, <span style=color:teal>HelpMessage</span> = <span style=color:#d14>&#34;Home &gt; App registrations &gt; (Your Cloud Management App) - Authentication. Copy the Redirect URI. It should start with ms-appx-web://&#34;</span>)]
</span></span><span style=display:flex><span>        [<span style=color:teal>string</span>]
</span></span><span style=display:flex><span>        <span style=color:teal>$RedirectURI</span>,
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>        [<span style=color:#0086b3>Parameter</span>(<span style=color:teal>Mandatory</span>=$True, <span style=color:teal>HelpMessage</span> = <span style=color:#d14>&#34;Home &gt; App registrations &gt; (Your Cloud Management App) - Expose an API. Copy the Application ID URI&#34;</span>)]
</span></span><span style=display:flex><span>        [<span style=color:teal>string</span>]
</span></span><span style=display:flex><span>        <span style=color:teal>$ResourceAppIdURI</span>,
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>        [<span style=color:#0086b3>Parameter</span>(<span style=color:teal>Mandatory</span>=$True, <span style=color:teal>HelpMessage</span> = <span style=color:#d14>&#34;Change the prompt behavior to force credentials each time. https://msdn.microsoft.com/library/azure/microsoft.identitymodel.clients.activedirectory.promptbehavior.aspx.&#34;</span>)]
</span></span><span style=display:flex><span>        [<span style=color:#0086b3>ValidateSet</span>(<span style=color:#d14>&#34;Auto&#34;</span>, <span style=color:#d14>&#34;Always&#34;</span>, <span style=color:#d14>&#34;Never&#34;</span>, <span style=color:#d14>&#34;RefreshSession&#34;</span>)]
</span></span><span style=display:flex><span>        [<span style=color:teal>string</span>]
</span></span><span style=display:flex><span>        <span style=color:teal>$PromptForNewCredentials</span> = <span style=color:#d14>&#34;Auto&#34;</span>
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>        <span style=color:#998;font-style:italic>#Get AAD Token for AdminService</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>If</span>(<span style=color:#0086b3>Test-Path</span> <span style=color:#d14>&#34;</span>$(<span style=color:teal>$PSScriptRoot</span>)<span style=color:#d14>\Auth.Json&#34;</span>) {
</span></span><span style=display:flex><span>            <span style=color:teal>$AuthToken</span> = <span style=color:#0086b3>Get-Content</span> -Path <span style=color:#d14>&#34;</span>$(<span style=color:teal>$PSScriptRoot</span>)<span style=color:#d14>\Auth.Json&#34;</span> | <span style=color:#0086b3>ConvertFrom-Json</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>If</span>((<span style=color:teal>$AuthToken</span> <span style=color:#000;font-weight:700>-and</span> (<span style=color:#0086b3>Get-Date</span>) <span style=color:#000;font-weight:700>-lt</span> <span style=color:teal>$AuthToken</span>.ExpiresOn)) {
</span></span><span style=display:flex><span>                <span style=color:#000;font-weight:700>Return</span> <span style=color:teal>$AuthToken</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>If</span>((<span style=color:teal>$AuthToken</span> <span style=color:#000;font-weight:700>-and</span> (<span style=color:#0086b3>Get-Date</span>) <span style=color:#000;font-weight:700>-ge</span> <span style=color:teal>$AuthToken</span>.ExpiresOn) <span style=color:#000;font-weight:700>-or</span> (!(<span style=color:#0086b3>Test-Path</span> <span style=color:#d14>&#34;</span>$(<span style=color:teal>$PSScriptRoot</span>)<span style=color:#d14>\Auth.Json&#34;</span>))) {
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:teal>$Authority</span> = <span style=color:#d14>&#34;https://login.microsoftonline.com/</span>$(<span style=color:teal>$TenantID</span>)<span style=color:#d14>/oauth2/v2.0/authorize&#34;</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>            <span style=color:teal>$AadModule</span> = <span style=color:#0086b3>Get-Module</span> -Name <span style=color:#d14>&#34;AzureAD&#34;</span> -ListAvailable
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>If</span> (<span style=color:teal>$AadModule</span> <span style=color:#000;font-weight:700>-eq</span> $null)
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#0086b3>Write-Host</span> <span style=color:#d14>&#34;AzureAD PowerShell module not found, looking for AzureADPreview&#34;</span>
</span></span><span style=display:flex><span>                <span style=color:teal>$AadModule</span> = <span style=color:#0086b3>Get-Module</span> -Name <span style=color:#d14>&#34;AzureADPreview&#34;</span> -ListAvailable
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>If</span> (<span style=color:teal>$AadModule</span> <span style=color:#000;font-weight:700>-eq</span> $null)
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#0086b3>Write-Error</span> <span style=color:#d14>&#34;AzureAD Powershell module not installed...&#34;</span>
</span></span><span style=display:flex><span>                <span style=color:#0086b3>Write-Error</span> <span style=color:#d14>&#34;Install by running &#39;Install-Module AzureAD&#39; or &#39;Install-Module AzureADPreview&#39; from an elevated PowerShell prompt&#34;</span>
</span></span><span style=display:flex><span>                Exit
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>If</span> (<span style=color:teal>$AadModule</span>.count <span style=color:#000;font-weight:700>-gt</span> <span style=color:#099>1</span>)	{
</span></span><span style=display:flex><span>                <span style=color:teal>$Latest_Version</span> = (<span style=color:teal>$AadModule</span> | <span style=color:#0086b3>Select-Object</span> version | <span style=color:#0086b3>Sort-Object</span>)[<span style=color:#099>-1</span>]
</span></span><span style=display:flex><span>                <span style=color:teal>$aadModule</span> = <span style=color:teal>$AadModule</span> | <span style=color:#0086b3>ForEach-Object</span> { <span style=color:teal>$_</span>.version <span style=color:#000;font-weight:700>-eq</span> <span style=color:teal>$Latest_Version</span>.version }
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                <span style=color:#000;font-weight:700>If</span> (<span style=color:teal>$AadModule</span>.count <span style=color:#000;font-weight:700>-gt</span> <span style=color:#099>1</span>)
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    <span style=color:teal>$aadModule</span> = <span style=color:teal>$AadModule</span> | <span style=color:#0086b3>Select-Object</span> -Unique
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>                <span style=color:teal>$adal</span> = <span style=color:#0086b3>Join-Path</span> <span style=color:teal>$AadModule</span>.ModuleBase <span style=color:#d14>&#34;Microsoft.IdentityModel.Clients.ActiveDirectory.dll&#34;</span>
</span></span><span style=display:flex><span>                <span style=color:teal>$adalforms</span> = <span style=color:#0086b3>Join-Path</span> <span style=color:teal>$AadModule</span>.ModuleBase <span style=color:#d14>&#34;Microsoft.IdentityModel.Clients.ActiveDirectory.Platform.dll&#34;</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>Else</span> {
</span></span><span style=display:flex><span>                <span style=color:teal>$adal</span> = <span style=color:#0086b3>Join-Path</span> <span style=color:teal>$AadModule</span>.ModuleBase <span style=color:#d14>&#34;Microsoft.IdentityModel.Clients.ActiveDirectory.dll&#34;</span>
</span></span><span style=display:flex><span>                <span style=color:teal>$adalforms</span> = <span style=color:#0086b3>Join-Path</span> <span style=color:teal>$AadModule</span>.ModuleBase <span style=color:#d14>&#34;Microsoft.IdentityModel.Clients.ActiveDirectory.Platform.dll&#34;</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>            [<span style=color:teal>System.Reflection.Assembly</span>]::LoadFrom(<span style=color:teal>$adal</span>) | <span style=color:#0086b3>Out-Null</span>
</span></span><span style=display:flex><span>            [<span style=color:teal>System.Reflection.Assembly</span>]::LoadFrom(<span style=color:teal>$adalforms</span>) | <span style=color:#0086b3>Out-Null</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>Try</span>
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:teal>$authContext</span> = <span style=color:#0086b3>New-Object</span> <span style=color:#d14>&#34;Microsoft.IdentityModel.Clients.ActiveDirectory.AuthenticationContext&#34;</span> -ArgumentList <span style=color:teal>$authority</span>
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                <span style=color:teal>$platformParameters</span> = <span style=color:#0086b3>New-Object</span> <span style=color:#d14>&#34;Microsoft.IdentityModel.Clients.ActiveDirectory.PlatformParameters&#34;</span> -ArgumentList <span style=color:teal>$PromptForNewCredentials</span>
</span></span><span style=display:flex><span>                <span style=color:teal>$authResult</span> = <span style=color:teal>$authContext</span>.AcquireTokenAsync(<span style=color:teal>$resourceAppIdURI</span>, <span style=color:teal>$clientId</span>, <span style=color:teal>$redirectUri</span>, <span style=color:teal>$platformParameters</span>).Result
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>                <span style=color:#998;font-style:italic># If the accesstoken is valid save a Json File</span>
</span></span><span style=display:flex><span>                <span style=color:#000;font-weight:700>If</span> (<span style=color:teal>$authResult</span>.AccessToken) {
</span></span><span style=display:flex><span>                    <span style=color:teal>$authResult</span> | <span style=color:#0086b3>ConvertTo-Json</span> | <span style=color:#0086b3>Out-File</span> -FilePath <span style=color:#d14>&#34;</span>$(<span style=color:teal>$PSScriptRoot</span>)<span style=color:#d14>\Auth.Json&#34;</span> -Force
</span></span><span style=display:flex><span>                    <span style=color:#000;font-weight:700>return</span> <span style=color:teal>$authResult</span>
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>                <span style=color:#000;font-weight:700>Else</span> {
</span></span><span style=display:flex><span>                    <span style=color:#0086b3>Write-Error</span> <span style=color:#d14>&#34;Authorization Access Token is null, please re-run authentication...&#34;</span>
</span></span><span style=display:flex><span>                    <span style=color:#000;font-weight:700>break</span>
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>Catch</span>
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#0086b3>Write-Error</span> <span style=color:teal>$_</span>.Exception.Message
</span></span><span style=display:flex><span>                <span style=color:#0086b3>Write-Error</span> <span style=color:teal>$_</span>.Exception.ItemName
</span></span><span style=display:flex><span>                <span style=color:#000;font-weight:700>Break</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&amp; <span style=color:teal>$Main</span>
</span></span></code></pre></td></tr></table></div></div><p>If you did it right, you should have just triggered a client action on a co-managed device. I haven&rsquo;t been able to test a non-co-managed device, but I expect that the functionality we saw demoed at Ignite will bring that functionality along once it is released.</p><h2 id=summary>Summary</h2><p>The purpose of this post was to show you that you can trigger WMI methods with the ConfigMgr AdminService in the 1910 CB release of ConfigMgr. Hopefully it has inspired new ideas for how you may use this moving forward. I&rsquo;ve already spoken with a few folks who are looking at making standalone admin web frontends or leveraging the Power Platform apps to interact directly with ConfigMgr using AdminService. The possibilities are truly limitless! One last note - the AdminService is still very much a work-in-progress. If you plan to mess with it, I wouldn&rsquo;t start building business processes around it just yet - I think it will get better and easier to interact with moving forward. But if you want to just start getting your hands dirty, get in and give it a test drive.</p></div><div class=post-share><div class="post-share-box share-comments">hello</div></div><div class=post-author></div><comments id=comments><script src=https://utteranc.es/client.js repo=AdamGrossTX/asquaredozen issue-term=title label="blog comment" theme=github-light crossorigin=anonymous async></script></comments></article></div></div></div><footer id=footer><div class=container><div id=footer-copyright><p class=copyright>&copy; 2024 Adam Gross - https://www.asquaredozen.com - A Square Dozen</a></p></div></div></footer></div></body></html>