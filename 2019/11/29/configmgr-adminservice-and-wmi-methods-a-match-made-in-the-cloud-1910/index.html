<!DOCTYPE html>
<html lang="en-us">
	    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="keyword"  content="ConfigMgr Microsoft MVP Gross Intune Windows">
        <link rel="shortcut icon" href="/img/favicon.ico">
        <title>ConfigMgr AdminService and WMI Methods – A match made in the cloud (1910)-A Square Dozen | A. Gross Blog</title>

        <meta name="description" content="A.Gross Blog | Adam Gross Enterprise Mobility MVP">
        

        
<script async src="https://www.googletagmanager.com/gtag/js?id=G-DYVXTRTXN4"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-DYVXTRTXN4', { 'anonymize_ip': false });
}
</script>

        <meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://blog.asquaredozen.com/105"/>

<meta name="twitter:title" content="ConfigMgr AdminService and WMI Methods – A match made in the cloud (1910)"/>
<meta name="twitter:description" content="This post applies to Microsoft Endpoint Configuration Manager 1910 Current Branch
 At Microsoft Ignite 2019 Brad Anderson demoed a few things in his sessions, later covered more in depth in other sessions, that highlighted some new features to allow you to leverage the cloud console to manage ConfigMgr-only devices. As I watched these sessions, I realized that they were using the ConfigMgr Administration Service to do integrate into the cloud."/>


        <link rel="canonical" href="/2019/11/29/configmgr-adminservice-and-wmi-methods-a-match-made-in-the-cloud-1910/">
        <link rel="stylesheet" href="/css/style.css">
        <link rel="stylesheet" href="/css/code.css">

        
        <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" rel="stylesheet" type="text/css">

        
        

        
    </head>
		<body class="home blog">
			<div id="asd-container">
				
				
<div id="top-bar">
    <div class="container">
        <div id="nav-wrapper">
                <ul class="menu" id="menu-top-menu">
                    <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                        <a href="/">Home</a>
                    </li>
                    
                    
                        
                            <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                <a href="#">
                                    
                                    <span>Feature Updates</span>
                                </a>
                                <ul class="sub-menu menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                    
                                        <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                            <a href="/2019/08/22/windows-10-feature-updates-leveraging-setupdiag-for-better-reporting/">Windows 10 Feature Updates – Leveraging SetupDiag for Better Reporting</a>
                                        </li>
                                    
                                        <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                            <a href="/2019/10/05/windows-10-feature-updates-the-challenge-of-servicing-in-the-enterprise/">Windows 10 Feature Updates – The Challenge of Servicing in the Enterprise</a>
                                        </li>
                                    
                                        <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                            <a href="/2019/08/25/windows-10-feature-updates-using-custom-action-scripts/">Windows 10 Feature Updates – Using Custom Action Scripts</a>
                                        </li>
                                    
                                        <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                            <a href="/2019/08/25/windows-10-feature-updates-using-setupconfig-ini-to-manage-feature-updates-in-the-enterprise/">Windows 10 Feature Updates – Using Setupconfig.ini to Manage Feature Updates in the Enterprise</a>
                                        </li>
                                    
                                </ul>
                            </li>
                        
                    
                        
                            <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                <a href="/2019/02/12/the-system-center-configuration-manager-adminservice-guide/">
                                    
                                    <span>ConfigMgr AdminService</span>
                                </a>
                            </li>
                        
                    
                        
                            <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                <a href="#">
                                    
                                    <span>802.1x for OSD</span>
                                </a>
                                <ul class="sub-menu menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                    
                                        <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                            <a href="/2018/07/29/configuring-802-1x-authentication-for-windows-deployment-part-1-building-an-802-1x-computer-authentication-script/">Part 1 – Building an 802.1x Computer Authentication Script</a>
                                        </li>
                                    
                                        <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                            <a href="/2018/07/29/configuring-802-1x-authentication-for-windows-deployment-part-2-building-an-802-1x-enabled-winpe-boot-image/">Part 2 – Building an 802.1x Enabled WinPE Boot Image</a>
                                        </li>
                                    
                                        <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                            <a href="/2018/07/29/configuring-802-1x-authentication-for-windows-deployment-part-3-integrating-802-1x-authentication-into-a-bare-metal-task-sequence/">Part 3 – Integrating 802.1x Authentication into a Bare Metal Task Sequence</a>
                                        </li>
                                    
                                        <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                            <a href="/2018/07/29/configuring-802-1x-authentication-for-windows-deployment-part-4-integrating-802-1x-authentication-into-an-in-place-upgrade-task-sequence/">Part 4 – Integrating 802.1x Authentication into an In-Place Upgrade Task Sequence</a>
                                        </li>
                                    
                                        <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                            <a href="/2018/09/29/configuring-802-1x-authentication-for-windows-deployment-part-5-dynamic-whitelisting-using-the-cisco-ise-external-restful-service/">Part 5 – Dynamic Whitelisting using the Cisco ISE External RESTful Service</a>
                                        </li>
                                    
                                        <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                            <a href="/2018/07/29/configuring-802-1x-authentication-for-windows-deployment-tips-and-tricks/">Tips and Tricks</a>
                                        </li>
                                    
                                </ul>
                            </li>
                        
                    
                        
                            <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                <a href="#">
                                    
                                    <span>Task Sequence Hacks</span>
                                </a>
                                <ul class="sub-menu menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                    
                                        <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                            <a href="/2018/11/29/building-a-better-task-sequence/">Building a Better Task Sequence</a>
                                        </li>
                                    
                                        <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                            <a href="/2019/04/30/building-a-smarter-task-sequence/">Building a Smarter Task Sequence</a>
                                        </li>
                                    
                                        <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                            <a href="/2018/12/14/building-an-even-better-task-sequence/">Building An Even Better Task Sequence</a>
                                        </li>
                                    
                                        <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                            <a href="/2018/07/16/clearing-local-group-policies-during-an-windows-7-to-10-in-place-upgrade-task-sequence/">Clearing Local Group Policies during an Windows 7 to 10 In-Place Upgrade Task Sequence</a>
                                        </li>
                                    
                                        <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                            <a href="/2018/10/03/debugging-sccm-configmgr-task-sequences-on-the-fly/">Debugging SCCM/ConfigMgr Task Sequences on the Fly</a>
                                        </li>
                                    
                                        <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                            <a href="/2018/07/11/dynamically-updating-unattend-xml-during-an-osd-task-sequence-using-mdt-variables-and-zti-scripts/">Dynamically Updating Unattend.XML during an OSD Task Sequence using MDT Variables and ZTI Scripts.</a>
                                        </li>
                                    
                                        <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                            <a href="/2018/06/14/triggering-configmgr-client-actions-from-a-task-sequence/">Triggering ConfigMgr Client Actions from a Task Sequence</a>
                                        </li>
                                    
                                        <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                            <a href="/2018/08/27/using-sccm-task-sequence-variables-as-scripts/">Using SCCM Task Sequence Variables as Scripts</a>
                                        </li>
                                    
                                </ul>
                            </li>
                        
                    
                        
                            <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                <a href="https://github.com/AdamGrossTX">
                                    
                                    <span>GitHub</span>
                                </a>
                            </li>
                        
                    
                        
                            <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                <a href="#">
                                    
                                    <span>MORE&gt;</span>
                                </a>
                                <ul class="sub-menu menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                    
                                        <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                            <a href="/about/">About</a>
                                        </li>
                                    
                                        <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                            <a href="/consulting/">Consulting</a>
                                        </li>
                                    
                                        <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                            <a href="/contact/">Contact</a>
                                        </li>
                                    
                                </ul>
                            </li>
                        
                    
                
                </ul>
        </div>
    </div>
</div>
				<header id="header" class="noslider">
	<div class="container">
		<div id="logo">
			<h1><a href="https://blog.asquaredozen.com"><img src="/img/A-Square-Dozen-Logo-BlogHeader-1.png" alt="A Square Dozen" /></a></h1>
		</div>
	</div>
</header>
				<div class="container">
					<div id="content">
						<div id="main">
							
		<article class="post type-post status-publish format-standard has-post-thumbnail hentry">
			<div class="post-header">
				<h1>ConfigMgr AdminService and WMI Methods – A match made in the cloud (1910)</h1>
				<span class="post-date">November 29, 2019</span>
			</div>
			<div class="post-entry">
				<hr>
<p>This post applies to <a href="https://docs.microsoft.com/configmgr/core/plan-design/changes/whats-new-in-version-1910">Microsoft Endpoint Configuration Manager 1910 Current Branch</a></p>
<hr>
<p>At Microsoft Ignite 2019 Brad Anderson demoed a few things in his sessions, later covered more in depth in other sessions, that highlighted some new features to allow you to leverage the cloud console to manage ConfigMgr-only devices. As I watched these sessions, I realized that they were using the ConfigMgr Administration Service to do integrate into the cloud.</p>
<hr>
<p>Watch these sessions for more background on what&rsquo;s coming
BRK008 - <a href="https://myignite.techcommunity.microsoft.com/sessions/81268?source=sessions">Modern management: How/why you do it now</a>
BRK2082 - <a href="https://myignite.techcommunity.microsoft.com/sessions/81685?source=sessions">What&rsquo;s new in Microsoft Endpoint Manager, including Microsoft Intune and Configuration Manager (Part 1 of 2)</a>
BRK3220 - <a href="https://myignite.techcommunity.microsoft.com/sessions/83532">What&rsquo;s new in Microsoft Endpoint Manager, including Microsoft Intune and Configuration Manager (Part 2 of 2)</a></p>
<hr>
<p>Paul Mayfield showed how to sync ConfigMgr client policies on ConfigMgr-only, non co-managed, non Intune registered device (<a href="https://myignite.techcommunity.microsoft.com/sessions/81685?source=sessions">BRK2082</a> 11:50 timestamp)</p>
<p><img src="/img/2019/11/image-77.png" alt="A Square Dozen Image"></p>
<p>Brad Anderson shows a real-time application install on a ConfigMgr-only, non co-managed, non Intune registered device (<a href="https://myignite.techcommunity.microsoft.com/sessions/81268?source=sessions">BRK008</a> 11:00 - timestamp)</p>
<p><img src="/img/2019/11/image-78.png" alt="A Square Dozen Image"></p>
<p>Both of these demos use the ConfigMgr AdminService on the backend. I know I&rsquo;ve been trying to sell the AdminService as a replacement for WMI, but it&rsquo;s so much more. The AdminService will leverage your Cloud Management Gateway as a web proxy and allow you to take actions on <strong>Any Device from Anywhere</strong> (within reason). With Co-Managed and Intune-only devices, you already had much of this functionality; now with the Microsoft Endpoint Admin Center, you can leverage a centralized cloud console to manage devices, regardless of how they are managed.</p>
<p>In this post, I&rsquo;d like to highlight some of the new features that have been enabled in in the AdminService in Microsoft Endpoint Configuration Manager 1910 Current Branch. *<em>If you were at <a href="https://mmsmoa.com/">MMSJazz</a>, you may have heard me talk about this in the 1911 Technical Preview.</em></p>
<h2 id="wmi-methods">WMI Methods!</h2>
<p>Up until now, the AdminService has been largely read-only - you could only read WMI classes, but none of the WMI methods were available until now. In 1910, the WMI methods are all here! You can see them by listing the WMI route metadata and looking for <strong><code>ActionImport</code></strong> in the XML output.
<strong><code>https://&lt;SERVERNAME&gt;/AdminService/wmi/$metadata</code></strong></p>
<p><img src="/img/2019/11/image-79.png" alt="A Square Dozen Image"></p>
<p>If you visit the <a href="https://docs.microsoft.com/configmgr/develop/reference/configuration-manager-reference">reference</a> for the WMI class in question, you will be able to find the methods and method syntax. From there, you should be able to work out how to execute any WMI method.</p>
<h2 id="sms_clientoperation"><strong>SMS_ClientOperation</strong></h2>
<p>The Inside the ConfigMgr console, the right-click menu has several options which leverage the BGB (Big Green Button) or Fast Channel to communicate with the client. These include:</p>
<ul>
<li>Run Script</li>
<li>Install Application</li>
<li>Client Notification
<ul>
<li>Download Computer Policy</li>
<li>Download User Policy</li>
<li>Collect Discovery Data</li>
<li>Collect Software Inventory</li>
<li>Collect Hardware Inventory</li>
<li>Evaluate Application Deployments</li>
<li>Evaluate Software Update Deployments</li>
<li>Switch To Next Software Update Point</li>
<li>Evaluate Device Health Attestation</li>
<li>Check Conditional Access Compliance</li>
<li>Wake Up</li>
<li>Restart</li>
</ul>
</li>
<li>Client Diagnostics
<ul>
<li>Enable Verbose Logging</li>
<li>Disable Verbose Logging</li>
</ul>
</li>
<li>Endpoint Protection
<ul>
<li>Full Scan</li>
<li>Quick Scan</li>
<li>Download Definition</li>
</ul>
</li>
</ul>
<p><img src="/img/2019/11/image-73.png" alt="A Square Dozen Image"></p>
<p>If you watch <strong><code>SMSProv.log</code></strong> when you click these, you will see that they each call methods on the <strong><code>SMS_ClientOperation</code></strong> WMI class on the SMS Provider server.</p>
<p><img src="/img/2019/11/image-74.png" alt="A Square Dozen Image"></p>
<p>Each device with the ConfigMgr client installed has a WMI class called <strong><code>ROOT\ccm\ClientSDK</code></strong>. Generally, whenever you want to do things on the client, you would need to remotely connect to the device, attach to the ClientSDK class and trigger a WMI method on the client. Essentially, everything is happening client-side. This is no good when you want to take actions from something like a web API or web console. When you trigger these fast channel methods, all of the logic is in the WMI method on the server side, not the client side. I&rsquo;m sure I&rsquo;m doing a terrible job of describing what actually happens here&hellip;
If we look up the class in the WMI reference <a href="https://docs.microsoft.com/configmgr/develop/reference/protect/sms_clientoperation-server-wmi-class">https://docs.microsoft.com/configmgr/develop/reference/protect/sms_clientoperation-server-wmi-class</a> we can see that there are several methods available to take actions on clients from the server. Here&rsquo;s the PowerShell to trigger a reboot using the <strong><code>SMS_ClientOperation</code></strong> class using Type 17:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1"> 1</a></span><span style="color:#008080">$ServerName</span> = <span style="color:#d14">&#34;&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="2"><a style="outline: none; text-decoration:none; color:inherit" href="#2"> 2</a></span><span style="color:#008080">$SiteCode</span> = <span style="color:#d14">&#34;&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="3"><a style="outline: none; text-decoration:none; color:inherit" href="#3"> 3</a></span><span style="color:#008080">$NameSpace</span> = <span style="color:#d14">&#34;root\SMS\Site_{0}&#34;</span> <span style="color:#000;font-weight:bold">-f</span> <span style="color:#008080">$SiteCode</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="4"><a style="outline: none; text-decoration:none; color:inherit" href="#4"> 4</a></span><span style="color:#008080">$ClassName</span> = <span style="color:#d14">&#34;SMS_ClientOperation&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="5"><a style="outline: none; text-decoration:none; color:inherit" href="#5"> 5</a></span><span style="color:#008080">$MethodName</span> = <span style="color:#d14">&#34;InitiateClientOperation&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="6"><a style="outline: none; text-decoration:none; color:inherit" href="#6"> 6</a></span><span style="color:#008080">[string]</span><span style="color:#008080">$TargetCollectionID</span> = <span style="color:#d14">&#34;SMS00001&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="7"><a style="outline: none; text-decoration:none; color:inherit" href="#7"> 7</a></span><span style="color:#008080">[uint32]</span><span style="color:#008080">$Type</span> = 17 <span style="color:#998;font-style:italic">#Reboot</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="8"><a style="outline: none; text-decoration:none; color:inherit" href="#8"> 8</a></span><span style="color:#008080">[uint32]</span><span style="color:#008080">$RandomizationWindow</span> = 1
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="9"><a style="outline: none; text-decoration:none; color:inherit" href="#9"> 9</a></span><span style="color:#008080">[uint32[]]</span><span style="color:#008080">$TargetResourceIDs</span> = 16777325
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="10"><a style="outline: none; text-decoration:none; color:inherit" href="#10">10</a></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="11"><a style="outline: none; text-decoration:none; color:inherit" href="#11">11</a></span><span style="color:#998;font-style:italic">#Using CIM</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="12"><a style="outline: none; text-decoration:none; color:inherit" href="#12">12</a></span><span style="color:#008080">$Args</span> = @{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="13"><a style="outline: none; text-decoration:none; color:inherit" href="#13">13</a></span>    TargetCollectionID = <span style="color:#008080">$TargetCollectionID</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="14"><a style="outline: none; text-decoration:none; color:inherit" href="#14">14</a></span>    <span style="color:#0086b3">Type </span>= <span style="color:#008080">$Type</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="15"><a style="outline: none; text-decoration:none; color:inherit" href="#15">15</a></span>    RandomizationWindow = <span style="color:#008080">$RandomizationWindow</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="16"><a style="outline: none; text-decoration:none; color:inherit" href="#16">16</a></span>    TargetResourceIDs = <span style="color:#008080">$TargetResourceIDs</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="17"><a style="outline: none; text-decoration:none; color:inherit" href="#17">17</a></span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="18"><a style="outline: none; text-decoration:none; color:inherit" href="#18">18</a></span><span style="color:#0086b3">Invoke-CimMethod</span> -Namespace <span style="color:#008080">$NameSpace</span> -ClassName <span style="color:#008080">$ClassName</span> -MethodName <span style="color:#008080">$MethodName</span> -Arguments <span style="color:#008080">$Args</span> | <span style="color:#0086b3">Select-Object</span> ReturnValue
</code></pre></div><p>Now that we&rsquo;ve got a handle on BGB and the <strong><code>SMS_ClientOperation</code></strong> class, let&rsquo;s see how that translates over to the AdminService.</p>
<h2 id="triggering-client-operations-with-adminservice">Triggering Client Operations with AdminService</h2>
<p>The big win here is that the client Fast Channel will allow the AdminService to trigger client actions FROM ANYWHERE. Up until now, the AdminService was limited to server-side only methods and had none of the existing WMI methods. With ConfigMgr 1910 Current Branch, we will be able to start triggering client actions from any platform that can call a web API.</p>
<p>Using the same URL listed earlier <strong><code>https://&lt;SERVERNAME&gt;/AdminService/wmi/$metadata</code></strong> to list the metadata for the WMI route, if we search for <strong><code>SMS_ClientOperation</code></strong>, we will find all of the WMI Methods from the docs listed as <strong><code>ActionImport</code></strong> lines in XML.</p>
<p>From <a href="https://docs.microsoft.com/configmgr/develop/reference/protect/sms_clientoperation-server-wmi-class">https://docs.microsoft.com/configmgr/develop/reference/protect/sms_clientoperation-server-wmi-class</a>
<img src="/img/2019/11/image-80.png" alt="A Square Dozen Image"></p>
<p>Here&rsquo;s a listing of the actions available for the <strong><code>SMS_ClientOperation</code></strong> WMI class in the AdminService metadata.</p>
<p><img src="/img/2019/11/image-81.png" alt="A Square Dozen Image"></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-XML" data-lang="XML"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1"> 1</a></span><span style="color:#000080">&lt;ActionImport</span> <span style="color:#008080">Name=</span><span style="color:#d14">&#34;SMS_ClientOperation.InitiateClientOperation&#34;</span> <span style="color:#008080">Action=</span><span style="color:#d14">&#34;SCCMGraph.SMS_ClientOperation.InitiateClientOperation&#34;</span><span style="color:#000080">/&gt;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="2"><a style="outline: none; text-decoration:none; color:inherit" href="#2"> 2</a></span><span style="color:#000080">&lt;ActionImport</span> <span style="color:#008080">Name=</span><span style="color:#d14">&#34;SMS_ClientOperation.InitiateClientOperationEx&#34;</span> <span style="color:#008080">Action=</span><span style="color:#d14">&#34;SCCMGraph.SMS_ClientOperation.InitiateClientOperationEx&#34;</span><span style="color:#000080">/&gt;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="3"><a style="outline: none; text-decoration:none; color:inherit" href="#3"> 3</a></span><span style="color:#000080">&lt;ActionImport</span> <span style="color:#008080">Name=</span><span style="color:#d14">&#34;SMS_ClientOperation.RestoreQuarantinedItem&#34;</span> <span style="color:#008080">Action=</span><span style="color:#d14">&#34;SCCMGraph.SMS_ClientOperation.RestoreQuarantinedItem&#34;</span><span style="color:#000080">/&gt;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="4"><a style="outline: none; text-decoration:none; color:inherit" href="#4"> 4</a></span><span style="color:#000080">&lt;ActionImport</span> <span style="color:#008080">Name=</span><span style="color:#d14">&#34;SMS_ClientOperation.AllowThreat&#34;</span> <span style="color:#008080">Action=</span><span style="color:#d14">&#34;SCCMGraph.SMS_ClientOperation.AllowThreat&#34;</span><span style="color:#000080">/&gt;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="5"><a style="outline: none; text-decoration:none; color:inherit" href="#5"> 5</a></span><span style="color:#000080">&lt;ActionImport</span> <span style="color:#008080">Name=</span><span style="color:#d14">&#34;SMS_ClientOperation.ExcludeScanPaths&#34;</span> <span style="color:#008080">Action=</span><span style="color:#d14">&#34;SCCMGraph.SMS_ClientOperation.ExcludeScanPaths&#34;</span><span style="color:#000080">/&gt;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="6"><a style="outline: none; text-decoration:none; color:inherit" href="#6"> 6</a></span><span style="color:#000080">&lt;ActionImport</span> <span style="color:#008080">Name=</span><span style="color:#d14">&#34;SMS_ClientOperation.CancelClientOperation&#34;</span> <span style="color:#008080">Action=</span><span style="color:#d14">&#34;SCCMGraph.SMS_ClientOperation.CancelClientOperation&#34;</span><span style="color:#000080">/&gt;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="7"><a style="outline: none; text-decoration:none; color:inherit" href="#7"> 7</a></span><span style="color:#000080">&lt;ActionImport</span> <span style="color:#008080">Name=</span><span style="color:#d14">&#34;SMS_ClientOperation.DeleteClientOperation&#34;</span> <span style="color:#008080">Action=</span><span style="color:#d14">&#34;SCCMGraph.SMS_ClientOperation.DeleteClientOperation&#34;</span><span style="color:#000080">/&gt;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="8"><a style="outline: none; text-decoration:none; color:inherit" href="#8"> 8</a></span><span style="color:#000080">&lt;ActionImport</span> <span style="color:#008080">Name=</span><span style="color:#d14">&#34;SMS_ClientOperation.IsClientOperationAllowed&#34;</span> <span style="color:#008080">Action=</span><span style="color:#d14">&#34;SCCMGraph.SMS_ClientOperation.IsClientOperationAllowed&#34;</span><span style="color:#000080">/&gt;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="9"><a style="outline: none; text-decoration:none; color:inherit" href="#9"> 9</a></span><span style="color:#000080">&lt;ActionImport</span> <span style="color:#008080">Name=</span><span style="color:#d14">&#34;SMS_ClientOperation.IsClientOperationUpdateAllowed&#34;</span> <span style="color:#008080">Action=</span><span style="color:#d14">&#34;SCCMGraph.SMS_ClientOperation.IsClientOperationUpdateAllowed&#34;</span><span style="color:#000080">/&gt;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="10"><a style="outline: none; text-decoration:none; color:inherit" href="#10">10</a></span><span style="color:#000080">&lt;EntitySet</span> <span style="color:#008080">Name=</span><span style="color:#d14">&#34;SMS_ClientOperation&#34;</span> <span style="color:#008080">EntityType=</span><span style="color:#d14">&#34;SCCMGraph.SMS_ClientOperation&#34;</span><span style="color:#000080">/&gt;</span>
</code></pre></div><p>Now that we have the class and methods, we just need to trigger the WMI method using an OData Action. For OData, we will be using a HTTP POST method and sending a json formatted BODY as parameters to the method. The URL syntax for OData Actions used by AdminService is:</p>
<p><code>https://&lt;ServerName&gt;/AdminService/wmi/&lt;WMIClassName&gt;.&lt;WMIMethodName&gt;</code></p>
<p>For this example it would be:<br>
<code>https://&lt;ServerName&gt;/AdminService/wmi/SMS_ClientOperation.InitiateClientOperation</code></p>
<p>Since this is a POST method, you have to upload a body. As far as I know, you can&rsquo;t do this natively in a browser and need to use a separate tool. I&rsquo;m using PowerShell, but you can also use <a href="https://www.telerik.com/fiddler">Telerik Fiddler</a> or various other tools to do the same thing.</p>
<p>Here&rsquo;s a sample bit of PowerShell that I put together to test out the Client Notification actions.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1"> 1</a></span><span style="color:#000;font-weight:bold">Param</span> (
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="2"><a style="outline: none; text-decoration:none; color:inherit" href="#2"> 2</a></span>    [<span style="color:#000;font-weight:bold">Parameter</span>(<span style="color:#000;font-weight:bold">Mandatory</span>=<span style="color:#008080">$true</span>,<span style="color:#000;font-weight:bold">HelpMessage</span>=<span style="color:#d14">&#34;Enter your server name where AdminService is running (SMS Provider Role&#34;</span>)]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="3"><a style="outline: none; text-decoration:none; color:inherit" href="#3"> 3</a></span>    <span style="color:#008080">[string]</span><span style="color:#008080">$ServerName</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="4"><a style="outline: none; text-decoration:none; color:inherit" href="#4"> 4</a></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="5"><a style="outline: none; text-decoration:none; color:inherit" href="#5"> 5</a></span>    [<span style="color:#000;font-weight:bold">Parameter</span>(<span style="color:#000;font-weight:bold">Mandatory</span>=<span style="color:#008080">$true</span>,<span style="color:#000;font-weight:bold">HelpMessage</span>=<span style="color:#d14">&#34;Enter the ResourceID of the target device&#34;</span>)]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="6"><a style="outline: none; text-decoration:none; color:inherit" href="#6"> 6</a></span>    <span style="color:#008080">[uint32[]]</span><span style="color:#008080">$TargetResourceIDs</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="7"><a style="outline: none; text-decoration:none; color:inherit" href="#7"> 7</a></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="8"><a style="outline: none; text-decoration:none; color:inherit" href="#8"> 8</a></span>    [<span style="color:#000;font-weight:bold">Parameter</span>(<span style="color:#000;font-weight:bold">Mandatory</span>=<span style="color:#008080">$false</span>,<span style="color:#000;font-weight:bold">HelpMessage</span>=<span style="color:#d14">&#34;Enter a Collection ID that the target device is in&#34;</span>)]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="9"><a style="outline: none; text-decoration:none; color:inherit" href="#9"> 9</a></span>    <span style="color:#008080">[string]</span><span style="color:#008080">$TargetCollectionID</span> = <span style="color:#d14">&#34;SMS00001&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="10"><a style="outline: none; text-decoration:none; color:inherit" href="#10">10</a></span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="11"><a style="outline: none; text-decoration:none; color:inherit" href="#11">11</a></span>   
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="12"><a style="outline: none; text-decoration:none; color:inherit" href="#12">12</a></span><span style="color:#008080">$Types</span> = <span style="color:#008080">[Ordered]</span>@{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="13"><a style="outline: none; text-decoration:none; color:inherit" href="#13">13</a></span>    <span style="color:#d14">&#34;DownloadComputerPolicy&#34;</span> = 8
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="14"><a style="outline: none; text-decoration:none; color:inherit" href="#14">14</a></span>    <span style="color:#d14">&#34;DownloadUserPolicy&#34;</span> = 9
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="15"><a style="outline: none; text-decoration:none; color:inherit" href="#15">15</a></span>    <span style="color:#d14">&#34;CollectDiscoveryData&#34;</span> = 10
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="16"><a style="outline: none; text-decoration:none; color:inherit" href="#16">16</a></span>    <span style="color:#d14">&#34;CollectSoftwareInventory&#34;</span> = 11
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="17"><a style="outline: none; text-decoration:none; color:inherit" href="#17">17</a></span>    <span style="color:#d14">&#34;CollectHardwareInventory&#34;</span> = 12
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="18"><a style="outline: none; text-decoration:none; color:inherit" href="#18">18</a></span>    <span style="color:#d14">&#34;EvaluateApplicationDeployments&#34;</span> = 13
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="19"><a style="outline: none; text-decoration:none; color:inherit" href="#19">19</a></span>    <span style="color:#d14">&#34;EvaluateSoftwareUpdateDeployments&#34;</span> = 14
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="20"><a style="outline: none; text-decoration:none; color:inherit" href="#20">20</a></span>    <span style="color:#d14">&#34;SwitchToNextSoftwareUpdatePoint&#34;</span> = 15
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="21"><a style="outline: none; text-decoration:none; color:inherit" href="#21">21</a></span>    <span style="color:#d14">&#34;EvaluateDeviceHealthAttestation&#34;</span> = 16
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="22"><a style="outline: none; text-decoration:none; color:inherit" href="#22">22</a></span>    <span style="color:#d14">&#34;CheckConditionalAccessCompliance&#34;</span> = 125
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="23"><a style="outline: none; text-decoration:none; color:inherit" href="#23">23</a></span>    <span style="color:#d14">&#34;WakeUp&#34;</span> = 150
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="24"><a style="outline: none; text-decoration:none; color:inherit" href="#24">24</a></span>    <span style="color:#d14">&#34;Restart&#34;</span> = 17
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="25"><a style="outline: none; text-decoration:none; color:inherit" href="#25">25</a></span>    <span style="color:#d14">&#34;EnableVerboseLogging&#34;</span> = 20
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="26"><a style="outline: none; text-decoration:none; color:inherit" href="#26">26</a></span>    <span style="color:#d14">&#34;DisableVerboseLogging&#34;</span> = 21
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="27"><a style="outline: none; text-decoration:none; color:inherit" href="#27">27</a></span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="28"><a style="outline: none; text-decoration:none; color:inherit" href="#28">28</a></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="29"><a style="outline: none; text-decoration:none; color:inherit" href="#29">29</a></span><span style="color:#008080">[uint32]</span><span style="color:#008080">$RandomizationWindow</span> = 1
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="30"><a style="outline: none; text-decoration:none; color:inherit" href="#30">30</a></span><span style="color:#008080">[string]</span><span style="color:#008080">$MethodClass</span> = <span style="color:#d14">&#34;SMS_ClientOperation&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="31"><a style="outline: none; text-decoration:none; color:inherit" href="#31">31</a></span><span style="color:#008080">[string]</span><span style="color:#008080">$MethodName</span> = <span style="color:#d14">&#34;InitiateClientOperation&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="32"><a style="outline: none; text-decoration:none; color:inherit" href="#32">32</a></span><span style="color:#008080">[string]</span><span style="color:#008080">$ResultClass</span> = <span style="color:#d14">&#34;SMS_ClientOperationStatus&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="33"><a style="outline: none; text-decoration:none; color:inherit" href="#33">33</a></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="34"><a style="outline: none; text-decoration:none; color:inherit" href="#34">34</a></span><span style="color:#008080">$Types</span>.Keys | <span style="color:#0086b3">ForEach-Object</span> {<span style="color:#0086b3">Write-Host</span> <span style="color:#008080">$Types</span>[<span style="color:#008080">$_</span>] <span style="color:#a61717;background-color:#e3d2d2">:</span> <span style="color:#008080">$_</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="35"><a style="outline: none; text-decoration:none; color:inherit" href="#35">35</a></span><span style="color:#008080">[uint32]</span><span style="color:#008080">$Type</span> = <span style="color:#0086b3">Read-Host</span> -Prompt <span style="color:#d14">&#34;Which client action?&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="36"><a style="outline: none; text-decoration:none; color:inherit" href="#36">36</a></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="37"><a style="outline: none; text-decoration:none; color:inherit" href="#37">37</a></span><span style="color:#008080">$PostURL</span> = <span style="color:#d14">&#34;https://{0}/AdminService/wmi/{1}.{2}&#34;</span> <span style="color:#000;font-weight:bold">-f</span> <span style="color:#008080">$ServerName</span>,<span style="color:#008080">$MethodClass</span>,<span style="color:#008080">$MethodName</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="38"><a style="outline: none; text-decoration:none; color:inherit" href="#38">38</a></span><span style="color:#008080">$Headers</span> = @{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="39"><a style="outline: none; text-decoration:none; color:inherit" href="#39">39</a></span>    <span style="color:#d14">&#34;Content-Type&#34;</span> = <span style="color:#d14">&#34;Application/json&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="40"><a style="outline: none; text-decoration:none; color:inherit" href="#40">40</a></span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="41"><a style="outline: none; text-decoration:none; color:inherit" href="#41">41</a></span><span style="color:#008080">$Body</span> = @{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="42"><a style="outline: none; text-decoration:none; color:inherit" href="#42">42</a></span>    TargetCollectionID = <span style="color:#008080">$TargetCollectionID</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="43"><a style="outline: none; text-decoration:none; color:inherit" href="#43">43</a></span>    <span style="color:#0086b3">Type </span>= <span style="color:#008080">$Type</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="44"><a style="outline: none; text-decoration:none; color:inherit" href="#44">44</a></span>    RandomizationWindow = <span style="color:#008080">$RandomizationWindow</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="45"><a style="outline: none; text-decoration:none; color:inherit" href="#45">45</a></span>    TargetResourceIDs = <span style="color:#008080">$TargetResourceIDs</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="46"><a style="outline: none; text-decoration:none; color:inherit" href="#46">46</a></span>} | <span style="color:#0086b3">ConvertTo-Json</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="47"><a style="outline: none; text-decoration:none; color:inherit" href="#47">47</a></span>    
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="48"><a style="outline: none; text-decoration:none; color:inherit" href="#48">48</a></span><span style="color:#0086b3">Invoke-RestMethod</span> -Method Post -Uri <span style="color:#d14">&#34;</span>$(<span style="color:#008080">$PostURL</span>)<span style="color:#d14">&#34;</span> -Body <span style="color:#008080">$Body</span> -Headers <span style="color:#008080">$Headers</span> -UseDefaultCredentials | <span style="color:#0086b3">Select-Object</span> ReturnValue
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="49"><a style="outline: none; text-decoration:none; color:inherit" href="#49">49</a></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="50"><a style="outline: none; text-decoration:none; color:inherit" href="#50">50</a></span><span style="color:#998;font-style:italic">#Get Results</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="51"><a style="outline: none; text-decoration:none; color:inherit" href="#51">51</a></span><span style="color:#008080">$GetURL</span> = <span style="color:#d14">&#34;https://{0}/AdminService/wmi/{1}&#34;</span> <span style="color:#000;font-weight:bold">-f</span> <span style="color:#008080">$ServerName</span>,<span style="color:#008080">$ResultClass</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="52"><a style="outline: none; text-decoration:none; color:inherit" href="#52">52</a></span>(<span style="color:#0086b3">Invoke-RestMethod</span> -Method Get -Uri <span style="color:#d14">&#34;</span>$(<span style="color:#008080">$GetURL</span>)<span style="color:#d14">&#34;</span> -UseDefaultCredentials).Value | <span style="color:#0086b3">Format-Table</span>
</code></pre></div><p>The script will prompt for your server name and the ResourceID of the device you want to target (you can actually provide multiple ResourceIDs). The last 3 lines will query <strong><code>SMS_ClientOperationStatus</code></strong> and you will see a new entry for the ResourceID(s) that you targeted. This is all done using the newly added WMI methods in the AdminService.</p>
<p><img src="/img/2019/11/image-76.png" alt="A Square Dozen Image"></p>
<p>To verify that the action is actually working, you can check the AdminService.Log and BGBServer.log on the SMS Provider server or the client log that corresponds to the action that you triggered.</p>
<p>AdminService.log
<img src="/img/2019/11/2019-11-26_23-31-22.jpg" alt="A Square Dozen Image"></p>
<p>BgbServer.log
<img src="/img/2019/11/image-82.png" alt="A Square Dozen Image"></p>
<p><a href="mailto:SCNotify_ASD@Adam.log">SCNotify_ASD@Adam.log</a>
<img src="/img/2019/11/image-83.png" alt="A Square Dozen Image"></p>
<p>The best part about WMI methods being available in AdminService now is that we can call them from anywhere. No need to use PowerShell remoting to connect to the server to call the WMI method. Any authorized user can call these methods. You can even use them in Task Sequences.</p>
<p>As if this wasn&rsquo;t enough, the next part is even better. You may have seen my <a href="/2019/06/18/configmgr-1906-technical-preview-testing-cmpivot-over-cmg-using-adminservice">previous post </a>where I showed how to trigger CMPivot through the Cloud Management Gateway - now you can do real-time client actions over the CMG. Sync client policies, Restart, or even <a href="https://docs.microsoft.com/configmgr/apps/deploy-use/install-app-for-device">Install Applications </a>in real-time.</p>
<h2 id="triggering-client-operations-over-the-internet">Triggering Client Operations Over the Internet</h2>
<p>Next I&rsquo;m going to step up the game and I&rsquo;m going to trigger client actions on a Co-Managed device that isn&rsquo;t on the company network from a non-company device on the internet. This will simulate being able to take actions on clients through the <strong>Microsoft Endpoint Manager Admin Center</strong>.</p>
<p>I&rsquo;ve taken the same machine that I was testing on and moved it to a non-business network with internet only. Then I run a script to use the internet-facing URL of the AdminService on a personal device and I&rsquo;m able to trigger a device restart on the internet-only device. It&rsquo;s not even registered in Intune.</p>
<p>You will need your external URL and need to generate an authentication token. I followed Sandy&rsquo;s guide here <a href="https://www.scconfigmgr.com/2019/07/16/use-configmgr-administration-service-adminservice-over-internet">https://www.scconfigmgr.com/2019/07/16/use-configmgr-administration-service-adminservice-over-internet</a>. I took her script and rebuilt it a bit then took the sample script from above and integrated it into a new script. Here&rsquo;s the result.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1">  1</a></span><span style="color:#000;font-weight:bold">Param</span> (
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="2"><a style="outline: none; text-decoration:none; color:inherit" href="#2">  2</a></span>    [<span style="color:#000;font-weight:bold">Parameter</span>(<span style="color:#000;font-weight:bold">Mandatory</span>=<span style="color:#008080">$True</span>, <span style="color:#000;font-weight:bold">HelpMessage</span> = <span style="color:#d14">&#34;Home &gt; App registrations &gt; (Your Native App) - Overview. Copy the Application (client) ID&#34;</span>)]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="3"><a style="outline: none; text-decoration:none; color:inherit" href="#3">  3</a></span>    <span style="color:#008080">[string]</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="4"><a style="outline: none; text-decoration:none; color:inherit" href="#4">  4</a></span>    <span style="color:#008080">$ClientID</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="5"><a style="outline: none; text-decoration:none; color:inherit" href="#5">  5</a></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="6"><a style="outline: none; text-decoration:none; color:inherit" href="#6">  6</a></span>    [<span style="color:#000;font-weight:bold">Parameter</span>(<span style="color:#000;font-weight:bold">Mandatory</span>=<span style="color:#008080">$True</span>, <span style="color:#000;font-weight:bold">HelpMessage</span> = <span style="color:#d14">&#34;Home &gt; App registrations &gt; (Your Native App) - Overview. Copy the Directory (tenant) ID&#34;</span>)]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="7"><a style="outline: none; text-decoration:none; color:inherit" href="#7">  7</a></span>    <span style="color:#008080">[string]</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="8"><a style="outline: none; text-decoration:none; color:inherit" href="#8">  8</a></span>    <span style="color:#008080">$TenantID</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="9"><a style="outline: none; text-decoration:none; color:inherit" href="#9">  9</a></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="10"><a style="outline: none; text-decoration:none; color:inherit" href="#10"> 10</a></span>    [<span style="color:#000;font-weight:bold">Parameter</span>(<span style="color:#000;font-weight:bold">Mandatory</span>=<span style="color:#008080">$True</span>, <span style="color:#000;font-weight:bold">HelpMessage</span> = <span style="color:#d14">&#34;Home &gt; App registrations &gt; (Your Cloud Management App) - Authentication. Copy the Redirect URI. It should start with ms-appx-web://&#34;</span>)]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="11"><a style="outline: none; text-decoration:none; color:inherit" href="#11"> 11</a></span>    <span style="color:#008080">[string]</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="12"><a style="outline: none; text-decoration:none; color:inherit" href="#12"> 12</a></span>    <span style="color:#008080">$RedirectURI</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="13"><a style="outline: none; text-decoration:none; color:inherit" href="#13"> 13</a></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="14"><a style="outline: none; text-decoration:none; color:inherit" href="#14"> 14</a></span>    [<span style="color:#000;font-weight:bold">Parameter</span>(<span style="color:#000;font-weight:bold">Mandatory</span>=<span style="color:#008080">$True</span>, <span style="color:#000;font-weight:bold">HelpMessage</span> = <span style="color:#d14">&#34;Home &gt; App registrations &gt; (Your Cloud Management App) - Expose an API. Copy the Application ID URI&#34;</span>)]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="15"><a style="outline: none; text-decoration:none; color:inherit" href="#15"> 15</a></span>    <span style="color:#008080">[string]</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="16"><a style="outline: none; text-decoration:none; color:inherit" href="#16"> 16</a></span>    <span style="color:#008080">$ResourceAppIdURI</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="17"><a style="outline: none; text-decoration:none; color:inherit" href="#17"> 17</a></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="18"><a style="outline: none; text-decoration:none; color:inherit" href="#18"> 18</a></span>    [<span style="color:#000;font-weight:bold">Parameter</span>(<span style="color:#000;font-weight:bold">Mandatory</span>=<span style="color:#008080">$True</span>, <span style="color:#000;font-weight:bold">HelpMessage</span> = <span style="color:#d14">&#34;Query your SCCM DB - SELECT ExternalEndpointName, ExternalUrl FROM vProxy_Routings WHERE ExternalEndpointName = &#39;AdminService&#39;&#34;</span>)]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="19"><a style="outline: none; text-decoration:none; color:inherit" href="#19"> 19</a></span>    <span style="color:#008080">[string]</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="20"><a style="outline: none; text-decoration:none; color:inherit" href="#20"> 20</a></span>    <span style="color:#008080">$InternetBaseURL</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="21"><a style="outline: none; text-decoration:none; color:inherit" href="#21"> 21</a></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="22"><a style="outline: none; text-decoration:none; color:inherit" href="#22"> 22</a></span>    [<span style="color:#000;font-weight:bold">Parameter</span>(<span style="color:#000;font-weight:bold">Mandatory</span>=<span style="color:#008080">$True</span>, <span style="color:#000;font-weight:bold">HelpMessage</span> = <span style="color:#d14">&#34;The URL to your AdminService server https://&lt;FQDN&gt;/AdminService&#34;</span>)]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="23"><a style="outline: none; text-decoration:none; color:inherit" href="#23"> 23</a></span>    <span style="color:#008080">[string]</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="24"><a style="outline: none; text-decoration:none; color:inherit" href="#24"> 24</a></span>    <span style="color:#008080">$InternalBaseURL</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="25"><a style="outline: none; text-decoration:none; color:inherit" href="#25"> 25</a></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="26"><a style="outline: none; text-decoration:none; color:inherit" href="#26"> 26</a></span>    [<span style="color:#000;font-weight:bold">Parameter</span>(<span style="color:#000;font-weight:bold">Mandatory</span>=<span style="color:#008080">$True</span>, <span style="color:#000;font-weight:bold">HelpMessage</span> = <span style="color:#d14">&#34;Use Token Auth or Current User Auth&#34;</span>)]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="27"><a style="outline: none; text-decoration:none; color:inherit" href="#27"> 27</a></span>    <span style="color:#008080">[switch]</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="28"><a style="outline: none; text-decoration:none; color:inherit" href="#28"> 28</a></span>    <span style="color:#008080">$UseTokenAuth</span> = <span style="color:#008080">$True</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="29"><a style="outline: none; text-decoration:none; color:inherit" href="#29"> 29</a></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="30"><a style="outline: none; text-decoration:none; color:inherit" href="#30"> 30</a></span>    [<span style="color:#000;font-weight:bold">Parameter</span>(<span style="color:#000;font-weight:bold">Mandatory</span>=<span style="color:#008080">$True</span>)]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="31"><a style="outline: none; text-decoration:none; color:inherit" href="#31"> 31</a></span>    <span style="color:#008080">[uint64[]]</span><span style="color:#008080">$TargetResourceIDs</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="32"><a style="outline: none; text-decoration:none; color:inherit" href="#32"> 32</a></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="33"><a style="outline: none; text-decoration:none; color:inherit" href="#33"> 33</a></span>    [<span style="color:#000;font-weight:bold">Parameter</span>(<span style="color:#000;font-weight:bold">Mandatory</span>=<span style="color:#008080">$True</span>)]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="34"><a style="outline: none; text-decoration:none; color:inherit" href="#34"> 34</a></span>    <span style="color:#008080">[string]</span><span style="color:#008080">$TargetCollectionID</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="35"><a style="outline: none; text-decoration:none; color:inherit" href="#35"> 35</a></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="36"><a style="outline: none; text-decoration:none; color:inherit" href="#36"> 36</a></span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="37"><a style="outline: none; text-decoration:none; color:inherit" href="#37"> 37</a></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="38"><a style="outline: none; text-decoration:none; color:inherit" href="#38"> 38</a></span><span style="color:#008080">$Main</span> = {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="39"><a style="outline: none; text-decoration:none; color:inherit" href="#39"> 39</a></span>    <span style="color:#008080">[Switch]</span><span style="color:#008080">$TryTokenAuth</span> = <span style="color:#008080">$false</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="40"><a style="outline: none; text-decoration:none; color:inherit" href="#40"> 40</a></span>    <span style="color:#000;font-weight:bold">If</span>(!(<span style="color:#008080">$UseTokenAuth</span>.IsPresent)) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="41"><a style="outline: none; text-decoration:none; color:inherit" href="#41"> 41</a></span>        <span style="color:#000;font-weight:bold">Try</span> {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="42"><a style="outline: none; text-decoration:none; color:inherit" href="#42"> 42</a></span>            <span style="color:#008080">$Data</span> = <span style="color:#0086b3">Initiate-ClientAction</span> -URL <span style="color:#008080">$InternetBaseURL</span> -TargetResourceIDs <span style="color:#008080">$TargetResourceIDs</span> -TargetCollectionID <span style="color:#008080">$TargetCollectionID</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="43"><a style="outline: none; text-decoration:none; color:inherit" href="#43"> 43</a></span>        }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="44"><a style="outline: none; text-decoration:none; color:inherit" href="#44"> 44</a></span>        <span style="color:#000;font-weight:bold">Catch</span> {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="45"><a style="outline: none; text-decoration:none; color:inherit" href="#45"> 45</a></span>            <span style="color:#0086b3">Write-Host</span> <span style="color:#d14">&#34;An error occurred using default credentials. Trying with Token Auth.&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="46"><a style="outline: none; text-decoration:none; color:inherit" href="#46"> 46</a></span>            <span style="color:#008080">$TryTokenAuth</span> = <span style="color:#008080">$True</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="47"><a style="outline: none; text-decoration:none; color:inherit" href="#47"> 47</a></span>        }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="48"><a style="outline: none; text-decoration:none; color:inherit" href="#48"> 48</a></span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="49"><a style="outline: none; text-decoration:none; color:inherit" href="#49"> 49</a></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="50"><a style="outline: none; text-decoration:none; color:inherit" href="#50"> 50</a></span>    <span style="color:#000;font-weight:bold">If</span>(<span style="color:#008080">$UseTokenAuth</span>.IsPresent <span style="color:#000;font-weight:bold">-or</span> <span style="color:#008080">$TryTokenAuth</span>) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="51"><a style="outline: none; text-decoration:none; color:inherit" href="#51"> 51</a></span>        <span style="color:#008080">$AuthToken</span> = <span style="color:#0086b3">Get-AADAuthToken</span> -ClientID <span style="color:#008080">$ClientID</span> -TenantID <span style="color:#008080">$TenantID</span> -ResourceAppIDURI <span style="color:#008080">$ResourceAppIDURI</span> -RedirectUri <span style="color:#008080">$RedirectUri</span> -PromptForNewCredentials Auto
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="52"><a style="outline: none; text-decoration:none; color:inherit" href="#52"> 52</a></span>        <span style="color:#998;font-style:italic"># Creating header for Authorization token</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="53"><a style="outline: none; text-decoration:none; color:inherit" href="#53"> 53</a></span>        <span style="color:#000;font-weight:bold">If</span>(<span style="color:#008080">$AuthToken</span>) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="54"><a style="outline: none; text-decoration:none; color:inherit" href="#54"> 54</a></span>            <span style="color:#008080">$AuthHeader</span> = @{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="55"><a style="outline: none; text-decoration:none; color:inherit" href="#55"> 55</a></span>                <span style="color:#d14">&#39;Content-Type&#39;</span>  = <span style="color:#d14">&#39;application/json&#39;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="56"><a style="outline: none; text-decoration:none; color:inherit" href="#56"> 56</a></span>                <span style="color:#d14">&#39;Authorization&#39;</span> = <span style="color:#d14">&#34;Bearer &#34;</span> + <span style="color:#008080">$AuthToken</span>.AccessToken
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="57"><a style="outline: none; text-decoration:none; color:inherit" href="#57"> 57</a></span>                <span style="color:#d14">&#39;ExpiresOn&#39;</span>	    = <span style="color:#008080">$AuthToken</span>.ExpiresOn
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="58"><a style="outline: none; text-decoration:none; color:inherit" href="#58"> 58</a></span>            }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="59"><a style="outline: none; text-decoration:none; color:inherit" href="#59"> 59</a></span>        }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="60"><a style="outline: none; text-decoration:none; color:inherit" href="#60"> 60</a></span>        <span style="color:#000;font-weight:bold">Else</span> {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="61"><a style="outline: none; text-decoration:none; color:inherit" href="#61"> 61</a></span>            <span style="color:#0086b3">Write-Host</span> <span style="color:#d14">&#34;No Auth Token Found. Exiting.&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="62"><a style="outline: none; text-decoration:none; color:inherit" href="#62"> 62</a></span>            <span style="color:#000;font-weight:bold">Break</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="63"><a style="outline: none; text-decoration:none; color:inherit" href="#63"> 63</a></span>        }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="64"><a style="outline: none; text-decoration:none; color:inherit" href="#64"> 64</a></span>        <span style="color:#008080">$Data</span> = <span style="color:#0086b3">Initiate-ClientAction</span> -URL <span style="color:#008080">$InternetBaseURL</span> -TargetResourceIDs <span style="color:#008080">$TargetResourceIDs</span> -TargetCollectionID <span style="color:#008080">$TargetCollectionID</span> -authHeader <span style="color:#008080">$authHeader</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="65"><a style="outline: none; text-decoration:none; color:inherit" href="#65"> 65</a></span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="66"><a style="outline: none; text-decoration:none; color:inherit" href="#66"> 66</a></span>    
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="67"><a style="outline: none; text-decoration:none; color:inherit" href="#67"> 67</a></span>    <span style="color:#000;font-weight:bold">Return</span> <span style="color:#008080">$Data</span>.value
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="68"><a style="outline: none; text-decoration:none; color:inherit" href="#68"> 68</a></span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="69"><a style="outline: none; text-decoration:none; color:inherit" href="#69"> 69</a></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="70"><a style="outline: none; text-decoration:none; color:inherit" href="#70"> 70</a></span><span style="color:#000;font-weight:bold">Function</span> <span style="color:#0086b3">Initiate-ClientAction</span> {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="71"><a style="outline: none; text-decoration:none; color:inherit" href="#71"> 71</a></span>    <span style="color:#000;font-weight:bold">Param</span> (
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="72"><a style="outline: none; text-decoration:none; color:inherit" href="#72"> 72</a></span>        [<span style="color:#000;font-weight:bold">Parameter</span>(<span style="color:#000;font-weight:bold">Mandatory</span>=<span style="color:#008080">$true</span>,<span style="color:#000;font-weight:bold">HelpMessage</span>=<span style="color:#d14">&#34;Enter your server name where AdminService is running (SMS Provider Role&#34;</span>)]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="73"><a style="outline: none; text-decoration:none; color:inherit" href="#73"> 73</a></span>        <span style="color:#008080">[string]</span><span style="color:#008080">$URL</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="74"><a style="outline: none; text-decoration:none; color:inherit" href="#74"> 74</a></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="75"><a style="outline: none; text-decoration:none; color:inherit" href="#75"> 75</a></span>        [<span style="color:#000;font-weight:bold">Parameter</span>(<span style="color:#000;font-weight:bold">Mandatory</span>=<span style="color:#008080">$true</span>,<span style="color:#000;font-weight:bold">HelpMessage</span>=<span style="color:#d14">&#34;Enter the ResourceID of the target device&#34;</span>)]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="76"><a style="outline: none; text-decoration:none; color:inherit" href="#76"> 76</a></span>        <span style="color:#008080">[uint32[]]</span><span style="color:#008080">$TargetResourceIDs</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="77"><a style="outline: none; text-decoration:none; color:inherit" href="#77"> 77</a></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="78"><a style="outline: none; text-decoration:none; color:inherit" href="#78"> 78</a></span>        [<span style="color:#000;font-weight:bold">Parameter</span>(<span style="color:#000;font-weight:bold">Mandatory</span>=<span style="color:#008080">$false</span>,<span style="color:#000;font-weight:bold">HelpMessage</span>=<span style="color:#d14">&#34;Enter a Collection ID that the target device is in&#34;</span>)]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="79"><a style="outline: none; text-decoration:none; color:inherit" href="#79"> 79</a></span>        <span style="color:#008080">[string]</span><span style="color:#008080">$TargetCollectionID</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="80"><a style="outline: none; text-decoration:none; color:inherit" href="#80"> 80</a></span>        
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="81"><a style="outline: none; text-decoration:none; color:inherit" href="#81"> 81</a></span>        <span style="color:#008080">$authHeader</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="82"><a style="outline: none; text-decoration:none; color:inherit" href="#82"> 82</a></span>    )
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="83"><a style="outline: none; text-decoration:none; color:inherit" href="#83"> 83</a></span>    
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="84"><a style="outline: none; text-decoration:none; color:inherit" href="#84"> 84</a></span>    <span style="color:#008080">$Types</span> = <span style="color:#008080">[Ordered]</span>@{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="85"><a style="outline: none; text-decoration:none; color:inherit" href="#85"> 85</a></span>        <span style="color:#d14">&#34;DownloadComputerPolicy&#34;</span> = 8
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="86"><a style="outline: none; text-decoration:none; color:inherit" href="#86"> 86</a></span>        <span style="color:#d14">&#34;DownloadUserPolicy&#34;</span> = 9
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="87"><a style="outline: none; text-decoration:none; color:inherit" href="#87"> 87</a></span>        <span style="color:#d14">&#34;CollectDiscoveryData&#34;</span> = 10
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="88"><a style="outline: none; text-decoration:none; color:inherit" href="#88"> 88</a></span>        <span style="color:#d14">&#34;CollectSoftwareInventory&#34;</span> = 11
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="89"><a style="outline: none; text-decoration:none; color:inherit" href="#89"> 89</a></span>        <span style="color:#d14">&#34;CollectHardwareInventory&#34;</span> = 12
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="90"><a style="outline: none; text-decoration:none; color:inherit" href="#90"> 90</a></span>        <span style="color:#d14">&#34;EvaluateApplicationDeployments&#34;</span> = 13
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="91"><a style="outline: none; text-decoration:none; color:inherit" href="#91"> 91</a></span>        <span style="color:#d14">&#34;EvaluateSoftwareUpdateDeployments&#34;</span> = 14
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="92"><a style="outline: none; text-decoration:none; color:inherit" href="#92"> 92</a></span>        <span style="color:#d14">&#34;SwitchToNextSoftwareUpdatePoint&#34;</span> = 15
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="93"><a style="outline: none; text-decoration:none; color:inherit" href="#93"> 93</a></span>        <span style="color:#d14">&#34;EvaluateDeviceHealthAttestation&#34;</span> = 16
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="94"><a style="outline: none; text-decoration:none; color:inherit" href="#94"> 94</a></span>        <span style="color:#d14">&#34;CheckConditionalAccessCompliance&#34;</span> = 125
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="95"><a style="outline: none; text-decoration:none; color:inherit" href="#95"> 95</a></span>        <span style="color:#d14">&#34;WakeUp&#34;</span> = 150
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="96"><a style="outline: none; text-decoration:none; color:inherit" href="#96"> 96</a></span>        <span style="color:#d14">&#34;Restart&#34;</span> = 17
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="97"><a style="outline: none; text-decoration:none; color:inherit" href="#97"> 97</a></span>        <span style="color:#d14">&#34;EnableVerboseLogging&#34;</span> = 20
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="98"><a style="outline: none; text-decoration:none; color:inherit" href="#98"> 98</a></span>        <span style="color:#d14">&#34;DisableVerboseLogging&#34;</span> = 21
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="99"><a style="outline: none; text-decoration:none; color:inherit" href="#99"> 99</a></span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="100"><a style="outline: none; text-decoration:none; color:inherit" href="#100">100</a></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="101"><a style="outline: none; text-decoration:none; color:inherit" href="#101">101</a></span>    <span style="color:#008080">[uint32]</span><span style="color:#008080">$RandomizationWindow</span> = 1
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="102"><a style="outline: none; text-decoration:none; color:inherit" href="#102">102</a></span>    <span style="color:#008080">[string]</span><span style="color:#008080">$MethodClass</span> = <span style="color:#d14">&#34;SMS_ClientOperation&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="103"><a style="outline: none; text-decoration:none; color:inherit" href="#103">103</a></span>    <span style="color:#008080">[string]</span><span style="color:#008080">$MethodName</span> = <span style="color:#d14">&#34;InitiateClientOperation&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="104"><a style="outline: none; text-decoration:none; color:inherit" href="#104">104</a></span>    <span style="color:#008080">[string]</span><span style="color:#008080">$ResultClass</span> = <span style="color:#d14">&#34;SMS_ClientOperationStatus&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="105"><a style="outline: none; text-decoration:none; color:inherit" href="#105">105</a></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="106"><a style="outline: none; text-decoration:none; color:inherit" href="#106">106</a></span>    <span style="color:#008080">$Types</span>.Keys | <span style="color:#0086b3">ForEach-Object</span> {<span style="color:#0086b3">Write-Host</span> <span style="color:#008080">$Types</span>[<span style="color:#008080">$_</span>] <span style="color:#a61717;background-color:#e3d2d2">:</span> <span style="color:#008080">$_</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="107"><a style="outline: none; text-decoration:none; color:inherit" href="#107">107</a></span>    <span style="color:#008080">[uint32]</span><span style="color:#008080">$Type</span> = <span style="color:#0086b3">Read-Host</span> -Prompt <span style="color:#d14">&#34;Which client action?&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="108"><a style="outline: none; text-decoration:none; color:inherit" href="#108">108</a></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="109"><a style="outline: none; text-decoration:none; color:inherit" href="#109">109</a></span>    <span style="color:#008080">$PostURL</span> = <span style="color:#d14">&#34;{0}/wmi/{1}.{2}&#34;</span> <span style="color:#000;font-weight:bold">-f</span> <span style="color:#008080">$URL</span>,<span style="color:#008080">$MethodClass</span>,<span style="color:#008080">$MethodName</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="110"><a style="outline: none; text-decoration:none; color:inherit" href="#110">110</a></span>    
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="111"><a style="outline: none; text-decoration:none; color:inherit" href="#111">111</a></span>    <span style="color:#008080">$Headers</span> = @{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="112"><a style="outline: none; text-decoration:none; color:inherit" href="#112">112</a></span>        <span style="color:#d14">&#34;Content-Type&#34;</span> = <span style="color:#d14">&#34;Application/json&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="113"><a style="outline: none; text-decoration:none; color:inherit" href="#113">113</a></span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="114"><a style="outline: none; text-decoration:none; color:inherit" href="#114">114</a></span>    <span style="color:#008080">$Body</span> = @{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="115"><a style="outline: none; text-decoration:none; color:inherit" href="#115">115</a></span>        TargetCollectionID = <span style="color:#008080">$TargetCollectionID</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="116"><a style="outline: none; text-decoration:none; color:inherit" href="#116">116</a></span>        <span style="color:#0086b3">Type </span>= <span style="color:#008080">$Type</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="117"><a style="outline: none; text-decoration:none; color:inherit" href="#117">117</a></span>        RandomizationWindow = <span style="color:#008080">$RandomizationWindow</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="118"><a style="outline: none; text-decoration:none; color:inherit" href="#118">118</a></span>        TargetResourceIDs = <span style="color:#008080">$TargetResourceIDs</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="119"><a style="outline: none; text-decoration:none; color:inherit" href="#119">119</a></span>    } | <span style="color:#0086b3">ConvertTo-Json</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="120"><a style="outline: none; text-decoration:none; color:inherit" href="#120">120</a></span>    
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="121"><a style="outline: none; text-decoration:none; color:inherit" href="#121">121</a></span>    <span style="color:#000;font-weight:bold">If</span>(<span style="color:#008080">$authHeader</span>) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="122"><a style="outline: none; text-decoration:none; color:inherit" href="#122">122</a></span>        <span style="color:#0086b3">Invoke-RestMethod</span> -Method Post -Uri <span style="color:#d14">&#34;</span>$(<span style="color:#008080">$PostURL</span>)<span style="color:#d14">&#34;</span> -Body <span style="color:#008080">$Body</span> -Headers <span style="color:#008080">$authHeader</span> | <span style="color:#0086b3">Select-Object</span> ReturnValue
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="123"><a style="outline: none; text-decoration:none; color:inherit" href="#123">123</a></span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="124"><a style="outline: none; text-decoration:none; color:inherit" href="#124">124</a></span>    <span style="color:#000;font-weight:bold">Else</span> {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="125"><a style="outline: none; text-decoration:none; color:inherit" href="#125">125</a></span>        <span style="color:#0086b3">Invoke-RestMethod</span> -Method Post -Uri <span style="color:#d14">&#34;</span>$(<span style="color:#008080">$PostURL</span>)<span style="color:#d14">&#34;</span> -Body <span style="color:#008080">$Body</span> -Headers <span style="color:#008080">$Headers</span> -UseDefaultCredentials | <span style="color:#0086b3">Select-Object</span> ReturnValue
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="126"><a style="outline: none; text-decoration:none; color:inherit" href="#126">126</a></span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="127"><a style="outline: none; text-decoration:none; color:inherit" href="#127">127</a></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="128"><a style="outline: none; text-decoration:none; color:inherit" href="#128">128</a></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="129"><a style="outline: none; text-decoration:none; color:inherit" href="#129">129</a></span>    <span style="color:#998;font-style:italic">#Get Results</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="130"><a style="outline: none; text-decoration:none; color:inherit" href="#130">130</a></span>    <span style="color:#008080">$GetURL</span> = <span style="color:#d14">&#34;{0}/wmi/{1}&#34;</span> <span style="color:#000;font-weight:bold">-f</span> <span style="color:#008080">$URL</span>,<span style="color:#008080">$ResultClass</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="131"><a style="outline: none; text-decoration:none; color:inherit" href="#131">131</a></span>    
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="132"><a style="outline: none; text-decoration:none; color:inherit" href="#132">132</a></span>    <span style="color:#000;font-weight:bold">If</span>(<span style="color:#008080">$authHeader</span>) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="133"><a style="outline: none; text-decoration:none; color:inherit" href="#133">133</a></span>        <span style="color:#008080">$Result</span> = (<span style="color:#0086b3">Invoke-RestMethod</span> -Method Get -Uri <span style="color:#d14">&#34;</span>$(<span style="color:#008080">$GetURL</span>)<span style="color:#d14">&#34;</span> -Headers <span style="color:#008080">$authHeader</span>).Value | <span style="color:#0086b3">Format-Table</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="134"><a style="outline: none; text-decoration:none; color:inherit" href="#134">134</a></span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="135"><a style="outline: none; text-decoration:none; color:inherit" href="#135">135</a></span>    <span style="color:#000;font-weight:bold">Else</span> {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="136"><a style="outline: none; text-decoration:none; color:inherit" href="#136">136</a></span>        (<span style="color:#0086b3">Invoke-RestMethod</span> -Method Get -Uri <span style="color:#d14">&#34;</span>$(<span style="color:#008080">$GetURL</span>)<span style="color:#d14">&#34;</span> -Headers <span style="color:#008080">$Headers</span> -UseDefaultCredentials).Value | <span style="color:#0086b3">Format-Table</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="137"><a style="outline: none; text-decoration:none; color:inherit" href="#137">137</a></span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="138"><a style="outline: none; text-decoration:none; color:inherit" href="#138">138</a></span>    <span style="color:#000;font-weight:bold">Return</span> <span style="color:#008080">$Result</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="139"><a style="outline: none; text-decoration:none; color:inherit" href="#139">139</a></span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="140"><a style="outline: none; text-decoration:none; color:inherit" href="#140">140</a></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="141"><a style="outline: none; text-decoration:none; color:inherit" href="#141">141</a></span><span style="color:#998;font-style:italic">#Modified Script from Sandy&#39;s blog post</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="142"><a style="outline: none; text-decoration:none; color:inherit" href="#142">142</a></span><span style="color:#998;font-style:italic">#https://www.scconfigmgr.com/2019/07/16/use-configmgr-administration-service-adminservice-over-internet/</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="143"><a style="outline: none; text-decoration:none; color:inherit" href="#143">143</a></span><span style="color:#998;font-style:italic">#Follow the instructions in her blog post for building a custom App for the AdminService.</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="144"><a style="outline: none; text-decoration:none; color:inherit" href="#144">144</a></span><span style="color:#998;font-style:italic">#You TECHNICALLY can use the Native Client App that gets created when you build your CMG, but it&#39;s </span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="145"><a style="outline: none; text-decoration:none; color:inherit" href="#145">145</a></span><span style="color:#998;font-style:italic">#Better to create a custom App instead of hijacking the built in one.</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="146"><a style="outline: none; text-decoration:none; color:inherit" href="#146">146</a></span><span style="color:#000;font-weight:bold">Function</span> <span style="color:#0086b3">Get-AADAuthToken</span> {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="147"><a style="outline: none; text-decoration:none; color:inherit" href="#147">147</a></span>    <span style="color:#000;font-weight:bold">Param</span> (
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="148"><a style="outline: none; text-decoration:none; color:inherit" href="#148">148</a></span>        [<span style="color:#000;font-weight:bold">Parameter</span>(<span style="color:#000;font-weight:bold">Mandatory</span>=<span style="color:#008080">$True</span>, <span style="color:#000;font-weight:bold">HelpMessage</span> = <span style="color:#d14">&#34;Home &gt; App registrations &gt; (Your Native App) - Overview. Copy the Application (client) ID&#34;</span>)]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="149"><a style="outline: none; text-decoration:none; color:inherit" href="#149">149</a></span>        <span style="color:#008080">[string]</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="150"><a style="outline: none; text-decoration:none; color:inherit" href="#150">150</a></span>        <span style="color:#008080">$ClientID</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="151"><a style="outline: none; text-decoration:none; color:inherit" href="#151">151</a></span>    
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="152"><a style="outline: none; text-decoration:none; color:inherit" href="#152">152</a></span>        [<span style="color:#000;font-weight:bold">Parameter</span>(<span style="color:#000;font-weight:bold">Mandatory</span>=<span style="color:#008080">$True</span>, <span style="color:#000;font-weight:bold">HelpMessage</span> = <span style="color:#d14">&#34;Home &gt; App registrations &gt; (Your Native App) - Overview. Copy the Directory (tenant) ID&#34;</span>)]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="153"><a style="outline: none; text-decoration:none; color:inherit" href="#153">153</a></span>        <span style="color:#008080">[string]</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="154"><a style="outline: none; text-decoration:none; color:inherit" href="#154">154</a></span>        <span style="color:#008080">$TenantID</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="155"><a style="outline: none; text-decoration:none; color:inherit" href="#155">155</a></span>    
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="156"><a style="outline: none; text-decoration:none; color:inherit" href="#156">156</a></span>        [<span style="color:#000;font-weight:bold">Parameter</span>(<span style="color:#000;font-weight:bold">Mandatory</span>=<span style="color:#008080">$True</span>, <span style="color:#000;font-weight:bold">HelpMessage</span> = <span style="color:#d14">&#34;Home &gt; App registrations &gt; (Your Cloud Management App) - Authentication. Copy the Redirect URI. It should start with ms-appx-web://&#34;</span>)]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="157"><a style="outline: none; text-decoration:none; color:inherit" href="#157">157</a></span>        <span style="color:#008080">[string]</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="158"><a style="outline: none; text-decoration:none; color:inherit" href="#158">158</a></span>        <span style="color:#008080">$RedirectURI</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="159"><a style="outline: none; text-decoration:none; color:inherit" href="#159">159</a></span>    
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="160"><a style="outline: none; text-decoration:none; color:inherit" href="#160">160</a></span>        [<span style="color:#000;font-weight:bold">Parameter</span>(<span style="color:#000;font-weight:bold">Mandatory</span>=<span style="color:#008080">$True</span>, <span style="color:#000;font-weight:bold">HelpMessage</span> = <span style="color:#d14">&#34;Home &gt; App registrations &gt; (Your Cloud Management App) - Expose an API. Copy the Application ID URI&#34;</span>)]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="161"><a style="outline: none; text-decoration:none; color:inherit" href="#161">161</a></span>        <span style="color:#008080">[string]</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="162"><a style="outline: none; text-decoration:none; color:inherit" href="#162">162</a></span>        <span style="color:#008080">$ResourceAppIdURI</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="163"><a style="outline: none; text-decoration:none; color:inherit" href="#163">163</a></span>    
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="164"><a style="outline: none; text-decoration:none; color:inherit" href="#164">164</a></span>        [<span style="color:#000;font-weight:bold">Parameter</span>(<span style="color:#000;font-weight:bold">Mandatory</span>=<span style="color:#008080">$True</span>, <span style="color:#000;font-weight:bold">HelpMessage</span> = <span style="color:#d14">&#34;Change the prompt behavior to force credentials each time. https://msdn.microsoft.com/library/azure/microsoft.identitymodel.clients.activedirectory.promptbehavior.aspx.&#34;</span>)]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="165"><a style="outline: none; text-decoration:none; color:inherit" href="#165">165</a></span>        [<span style="color:#000;font-weight:bold">ValidateSet</span>(<span style="color:#d14">&#34;Auto&#34;</span>, <span style="color:#d14">&#34;Always&#34;</span>, <span style="color:#d14">&#34;Never&#34;</span>, <span style="color:#d14">&#34;RefreshSession&#34;</span>)]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="166"><a style="outline: none; text-decoration:none; color:inherit" href="#166">166</a></span>        <span style="color:#008080">[string]</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="167"><a style="outline: none; text-decoration:none; color:inherit" href="#167">167</a></span>        <span style="color:#008080">$PromptForNewCredentials</span> = <span style="color:#d14">&#34;Auto&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="168"><a style="outline: none; text-decoration:none; color:inherit" href="#168">168</a></span>    )
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="169"><a style="outline: none; text-decoration:none; color:inherit" href="#169">169</a></span>    
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="170"><a style="outline: none; text-decoration:none; color:inherit" href="#170">170</a></span>        <span style="color:#998;font-style:italic">#Get AAD Token for AdminService</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="171"><a style="outline: none; text-decoration:none; color:inherit" href="#171">171</a></span>        <span style="color:#000;font-weight:bold">If</span>(<span style="color:#0086b3">Test-Path</span> <span style="color:#d14">&#34;</span>$(<span style="color:#008080">$PSScriptRoot</span>)<span style="color:#d14">\Auth.Json&#34;</span>) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="172"><a style="outline: none; text-decoration:none; color:inherit" href="#172">172</a></span>            <span style="color:#008080">$AuthToken</span> = <span style="color:#0086b3">Get-Content</span> -Path <span style="color:#d14">&#34;</span>$(<span style="color:#008080">$PSScriptRoot</span>)<span style="color:#d14">\Auth.Json&#34;</span> | <span style="color:#0086b3">ConvertFrom-Json</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="173"><a style="outline: none; text-decoration:none; color:inherit" href="#173">173</a></span>            <span style="color:#000;font-weight:bold">If</span>((<span style="color:#008080">$AuthToken</span> <span style="color:#000;font-weight:bold">-and</span> (<span style="color:#0086b3">Get-Date</span>) <span style="color:#000;font-weight:bold">-lt</span> <span style="color:#008080">$AuthToken</span>.ExpiresOn)) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="174"><a style="outline: none; text-decoration:none; color:inherit" href="#174">174</a></span>                <span style="color:#000;font-weight:bold">Return</span> <span style="color:#008080">$AuthToken</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="175"><a style="outline: none; text-decoration:none; color:inherit" href="#175">175</a></span>            }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="176"><a style="outline: none; text-decoration:none; color:inherit" href="#176">176</a></span>        }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="177"><a style="outline: none; text-decoration:none; color:inherit" href="#177">177</a></span>        <span style="color:#000;font-weight:bold">If</span>((<span style="color:#008080">$AuthToken</span> <span style="color:#000;font-weight:bold">-and</span> (<span style="color:#0086b3">Get-Date</span>) <span style="color:#000;font-weight:bold">-ge</span> <span style="color:#008080">$AuthToken</span>.ExpiresOn) <span style="color:#000;font-weight:bold">-or</span> (!(<span style="color:#0086b3">Test-Path</span> <span style="color:#d14">&#34;</span>$(<span style="color:#008080">$PSScriptRoot</span>)<span style="color:#d14">\Auth.Json&#34;</span>))) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="178"><a style="outline: none; text-decoration:none; color:inherit" href="#178">178</a></span>            
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="179"><a style="outline: none; text-decoration:none; color:inherit" href="#179">179</a></span>            <span style="color:#008080">$Authority</span> = <span style="color:#d14">&#34;https://login.microsoftonline.com/</span>$(<span style="color:#008080">$TenantID</span>)<span style="color:#d14">/oauth2/v2.0/authorize&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="180"><a style="outline: none; text-decoration:none; color:inherit" href="#180">180</a></span>    
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="181"><a style="outline: none; text-decoration:none; color:inherit" href="#181">181</a></span>            <span style="color:#008080">$AadModule</span> = <span style="color:#0086b3">Get-Module</span> -Name <span style="color:#d14">&#34;AzureAD&#34;</span> -ListAvailable
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="182"><a style="outline: none; text-decoration:none; color:inherit" href="#182">182</a></span>            <span style="color:#000;font-weight:bold">If</span> (<span style="color:#008080">$AadModule</span> <span style="color:#000;font-weight:bold">-eq</span> <span style="color:#008080">$null</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="183"><a style="outline: none; text-decoration:none; color:inherit" href="#183">183</a></span>            {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="184"><a style="outline: none; text-decoration:none; color:inherit" href="#184">184</a></span>                <span style="color:#0086b3">Write-Host</span> <span style="color:#d14">&#34;AzureAD PowerShell module not found, looking for AzureADPreview&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="185"><a style="outline: none; text-decoration:none; color:inherit" href="#185">185</a></span>                <span style="color:#008080">$AadModule</span> = <span style="color:#0086b3">Get-Module</span> -Name <span style="color:#d14">&#34;AzureADPreview&#34;</span> -ListAvailable
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="186"><a style="outline: none; text-decoration:none; color:inherit" href="#186">186</a></span>            }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="187"><a style="outline: none; text-decoration:none; color:inherit" href="#187">187</a></span>            <span style="color:#000;font-weight:bold">If</span> (<span style="color:#008080">$AadModule</span> <span style="color:#000;font-weight:bold">-eq</span> <span style="color:#008080">$null</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="188"><a style="outline: none; text-decoration:none; color:inherit" href="#188">188</a></span>            {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="189"><a style="outline: none; text-decoration:none; color:inherit" href="#189">189</a></span>                <span style="color:#0086b3">Write-Error</span> <span style="color:#d14">&#34;AzureAD Powershell module not installed...&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="190"><a style="outline: none; text-decoration:none; color:inherit" href="#190">190</a></span>                <span style="color:#0086b3">Write-Error</span> <span style="color:#d14">&#34;Install by running &#39;Install-Module AzureAD&#39; or &#39;Install-Module AzureADPreview&#39; from an elevated PowerShell prompt&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="191"><a style="outline: none; text-decoration:none; color:inherit" href="#191">191</a></span>                Exit
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="192"><a style="outline: none; text-decoration:none; color:inherit" href="#192">192</a></span>            }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="193"><a style="outline: none; text-decoration:none; color:inherit" href="#193">193</a></span>    
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="194"><a style="outline: none; text-decoration:none; color:inherit" href="#194">194</a></span>            <span style="color:#000;font-weight:bold">If</span> (<span style="color:#008080">$AadModule</span>.count <span style="color:#000;font-weight:bold">-gt</span> 1)	{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="195"><a style="outline: none; text-decoration:none; color:inherit" href="#195">195</a></span>                <span style="color:#008080">$Latest_Version</span> = (<span style="color:#008080">$AadModule</span> | <span style="color:#0086b3">Select-Object</span> version | <span style="color:#0086b3">Sort-Object</span>)[-1]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="196"><a style="outline: none; text-decoration:none; color:inherit" href="#196">196</a></span>                <span style="color:#008080">$aadModule</span> = <span style="color:#008080">$AadModule</span> | <span style="color:#0086b3">ForEach-Object</span> { <span style="color:#008080">$_</span>.version <span style="color:#000;font-weight:bold">-eq</span> <span style="color:#008080">$Latest_Version</span>.version }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="197"><a style="outline: none; text-decoration:none; color:inherit" href="#197">197</a></span>                
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="198"><a style="outline: none; text-decoration:none; color:inherit" href="#198">198</a></span>                <span style="color:#000;font-weight:bold">If</span> (<span style="color:#008080">$AadModule</span>.count <span style="color:#000;font-weight:bold">-gt</span> 1)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="199"><a style="outline: none; text-decoration:none; color:inherit" href="#199">199</a></span>                {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="200"><a style="outline: none; text-decoration:none; color:inherit" href="#200">200</a></span>                    <span style="color:#008080">$aadModule</span> = <span style="color:#008080">$AadModule</span> | <span style="color:#0086b3">Select-Object</span> -Unique
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="201"><a style="outline: none; text-decoration:none; color:inherit" href="#201">201</a></span>                }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="202"><a style="outline: none; text-decoration:none; color:inherit" href="#202">202</a></span>                <span style="color:#008080">$adal</span> = <span style="color:#0086b3">Join-Path</span> <span style="color:#008080">$AadModule</span>.ModuleBase <span style="color:#d14">&#34;Microsoft.IdentityModel.Clients.ActiveDirectory.dll&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="203"><a style="outline: none; text-decoration:none; color:inherit" href="#203">203</a></span>                <span style="color:#008080">$adalforms</span> = <span style="color:#0086b3">Join-Path</span> <span style="color:#008080">$AadModule</span>.ModuleBase <span style="color:#d14">&#34;Microsoft.IdentityModel.Clients.ActiveDirectory.Platform.dll&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="204"><a style="outline: none; text-decoration:none; color:inherit" href="#204">204</a></span>            }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="205"><a style="outline: none; text-decoration:none; color:inherit" href="#205">205</a></span>            <span style="color:#000;font-weight:bold">Else</span> {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="206"><a style="outline: none; text-decoration:none; color:inherit" href="#206">206</a></span>                <span style="color:#008080">$adal</span> = <span style="color:#0086b3">Join-Path</span> <span style="color:#008080">$AadModule</span>.ModuleBase <span style="color:#d14">&#34;Microsoft.IdentityModel.Clients.ActiveDirectory.dll&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="207"><a style="outline: none; text-decoration:none; color:inherit" href="#207">207</a></span>                <span style="color:#008080">$adalforms</span> = <span style="color:#0086b3">Join-Path</span> <span style="color:#008080">$AadModule</span>.ModuleBase <span style="color:#d14">&#34;Microsoft.IdentityModel.Clients.ActiveDirectory.Platform.dll&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="208"><a style="outline: none; text-decoration:none; color:inherit" href="#208">208</a></span>            }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="209"><a style="outline: none; text-decoration:none; color:inherit" href="#209">209</a></span>    
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="210"><a style="outline: none; text-decoration:none; color:inherit" href="#210">210</a></span>            <span style="color:#008080">[System.Reflection.Assembly]</span>::LoadFrom(<span style="color:#008080">$adal</span>) | <span style="color:#0086b3">Out-Null</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="211"><a style="outline: none; text-decoration:none; color:inherit" href="#211">211</a></span>            <span style="color:#008080">[System.Reflection.Assembly]</span>::LoadFrom(<span style="color:#008080">$adalforms</span>) | <span style="color:#0086b3">Out-Null</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="212"><a style="outline: none; text-decoration:none; color:inherit" href="#212">212</a></span>    
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="213"><a style="outline: none; text-decoration:none; color:inherit" href="#213">213</a></span>            <span style="color:#000;font-weight:bold">Try</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="214"><a style="outline: none; text-decoration:none; color:inherit" href="#214">214</a></span>            {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="215"><a style="outline: none; text-decoration:none; color:inherit" href="#215">215</a></span>                <span style="color:#008080">$authContext</span> = <span style="color:#0086b3">New-Object</span> <span style="color:#d14">&#34;Microsoft.IdentityModel.Clients.ActiveDirectory.AuthenticationContext&#34;</span> -ArgumentList <span style="color:#008080">$authority</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="216"><a style="outline: none; text-decoration:none; color:inherit" href="#216">216</a></span>                
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="217"><a style="outline: none; text-decoration:none; color:inherit" href="#217">217</a></span>                <span style="color:#008080">$platformParameters</span> = <span style="color:#0086b3">New-Object</span> <span style="color:#d14">&#34;Microsoft.IdentityModel.Clients.ActiveDirectory.PlatformParameters&#34;</span> -ArgumentList <span style="color:#008080">$PromptForNewCredentials</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="218"><a style="outline: none; text-decoration:none; color:inherit" href="#218">218</a></span>                <span style="color:#008080">$authResult</span> = <span style="color:#008080">$authContext</span>.AcquireTokenAsync(<span style="color:#008080">$resourceAppIdURI</span>, <span style="color:#008080">$clientId</span>, <span style="color:#008080">$redirectUri</span>, <span style="color:#008080">$platformParameters</span>).Result
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="219"><a style="outline: none; text-decoration:none; color:inherit" href="#219">219</a></span>    
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="220"><a style="outline: none; text-decoration:none; color:inherit" href="#220">220</a></span>                <span style="color:#998;font-style:italic"># If the accesstoken is valid save a Json File</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="221"><a style="outline: none; text-decoration:none; color:inherit" href="#221">221</a></span>                <span style="color:#000;font-weight:bold">If</span> (<span style="color:#008080">$authResult</span>.AccessToken) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="222"><a style="outline: none; text-decoration:none; color:inherit" href="#222">222</a></span>                    <span style="color:#008080">$authResult</span> | <span style="color:#0086b3">ConvertTo-Json</span> | <span style="color:#0086b3">Out-File</span> -FilePath <span style="color:#d14">&#34;</span>$(<span style="color:#008080">$PSScriptRoot</span>)<span style="color:#d14">\Auth.Json&#34;</span> -Force
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="223"><a style="outline: none; text-decoration:none; color:inherit" href="#223">223</a></span>                    <span style="color:#000;font-weight:bold">return</span> <span style="color:#008080">$authResult</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="224"><a style="outline: none; text-decoration:none; color:inherit" href="#224">224</a></span>                }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="225"><a style="outline: none; text-decoration:none; color:inherit" href="#225">225</a></span>                <span style="color:#000;font-weight:bold">Else</span> {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="226"><a style="outline: none; text-decoration:none; color:inherit" href="#226">226</a></span>                    <span style="color:#0086b3">Write-Error</span> <span style="color:#d14">&#34;Authorization Access Token is null, please re-run authentication...&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="227"><a style="outline: none; text-decoration:none; color:inherit" href="#227">227</a></span>                    <span style="color:#000;font-weight:bold">break</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="228"><a style="outline: none; text-decoration:none; color:inherit" href="#228">228</a></span>                }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="229"><a style="outline: none; text-decoration:none; color:inherit" href="#229">229</a></span>            }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="230"><a style="outline: none; text-decoration:none; color:inherit" href="#230">230</a></span>            <span style="color:#000;font-weight:bold">Catch</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="231"><a style="outline: none; text-decoration:none; color:inherit" href="#231">231</a></span>            {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="232"><a style="outline: none; text-decoration:none; color:inherit" href="#232">232</a></span>                <span style="color:#0086b3">Write-Error</span> <span style="color:#008080">$_</span>.Exception.Message
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="233"><a style="outline: none; text-decoration:none; color:inherit" href="#233">233</a></span>                <span style="color:#0086b3">Write-Error</span> <span style="color:#008080">$_</span>.Exception.ItemName
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="234"><a style="outline: none; text-decoration:none; color:inherit" href="#234">234</a></span>                <span style="color:#000;font-weight:bold">Break</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="235"><a style="outline: none; text-decoration:none; color:inherit" href="#235">235</a></span>            }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="236"><a style="outline: none; text-decoration:none; color:inherit" href="#236">236</a></span>        }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="237"><a style="outline: none; text-decoration:none; color:inherit" href="#237">237</a></span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="238"><a style="outline: none; text-decoration:none; color:inherit" href="#238">238</a></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="239"><a style="outline: none; text-decoration:none; color:inherit" href="#239">239</a></span>&amp; <span style="color:#008080">$Main</span>
</code></pre></div><p>If you did it right, you should have just triggered a client action on a co-managed device. I haven&rsquo;t been able to test a non-co-managed device, but I expect that the functionality we saw demoed at Ignite will bring that functionality along once it is released.</p>
<h2 id="summary">Summary</h2>
<p>The purpose of this post was to show you that you can trigger WMI methods with the ConfigMgr AdminService in the 1910 CB release of ConfigMgr. Hopefully it has inspired new ideas for how you may use this moving forward. I&rsquo;ve already spoken with a few folks who are looking at making standalone admin web frontends or leveraging the Power Platform apps to interact directly with ConfigMgr using AdminService. The possibilities are truly limitless! One last note - the AdminService is still very much a work-in-progress. If you plan to mess with it, I wouldn&rsquo;t start building business processes around it just yet - I think it will get better and easier to interact with moving forward. But if you want to just start getting your hands dirty, get in and give it a test drive.</p>

			</div>
			
			<div class="post-share">
				<div class="post-share-box share-comments">
				</div>
			</div>
			<div class="post-author">
			</div>
			<div class="post-comments" id="comments">
			</div>
			
			
		</article>

						</div>
						<aside id="sidebar">
	<div class="widget widget_search">
		<form role="search" method="get" action="https://www.google.com/search" id="searchform">
			<input type="search" placeholder="Search and hit enter..." value="" name="q" id="q" title="Search and hit enter...">
			<input type="hidden" name="sitesearch" value="asquaredozen.com">
			<button type="submit" value="Search"/>
		</form>
		</div>
	<div>
	<div class="widget widget_MVP">
		<a href="https://mvp.microsoft.com/en-us/PublicProfile/5003519?fullName=Adam%20Gross" target="_blank">
		<img src="/img/MVP_Logo_Horizontal_Secondary_Black_RGB_300ppi.png">
		</a>
	</div>	
	<div class="widget widget_recent_entries">
		<h4 class="widget-title">Recent Posts</h4>
		<ul>
			
			<li><a href="/2021/02/04/using-configmgr-run-scripts-and-microsoft-quick-assist-to-repair-a-broken-domain-trust-relationship/" target="_blank">Using ConfigMgr Run Scripts and Microsoft Quick Assist to Repair a Broken Domain Trust Relationship</a></li>
			
			<li><a href="/2021/01/12/how-to-find-settings-preventing-application-deletion-in-configmgr/" target="_blank">How to find Settings Preventing Application Deletion in ConfigMgr</a></li>
			
			<li><a href="/2020/12/02/autopilot-profile-causes-device-rename-after-configmgr-osd-task-sequence-and-breaks-ad-domain-trust/" target="_blank">Autopilot Profile causes Device Rename after ConfigMgr OSD Task Sequence and Breaks AD Domain Trust</a></li>
			
			<li><a href="/2020/09/30/new-post-on-sysmansquad-com-configmgr-and-the-case-of-the-mysterious-3da228be-34da-49f4-a081-66465b077429-folder/" target="_blank">New Post on SysManSquad.com – ConfigMgr and The Case of the Mysterious {3DA228BE-34DA-49f4-A081-66465B077429} Folder</a></li>
			
			<li><a href="/2020/09/13/windows-10-feature-updates-testing-the-migneo-disable-parameter/" target="_blank">Windows 10 Feature Updates – Testing the /MigNEO Disable Parameter</a></li>
			
		</ul>
	</div>
	<div class="widget widget_SCD">
		<h4 class="widget-title">Consulting</h4>
		<a href="https://systemcenterdudes.com/sccm-consulting-services/?ref=5&campaign=Consulting" target="_blank">
		<img src="/img/SCDLogo.png">
		</a>
	</div>
	<div class="widget widget_SCD">
		<h4 class="widget-title">Intune.Training</h4>
		<a href="http://intune.training" target="_blank">
		<img src="/img/ITLogo.png">
		</a>
	</div>	
</aside>

					</div>
				</div>
				<footer id="footer">
	<div class="container">
		<div id="footer-copyright">
			<p class="copyright">&copy; 2021 Adam Gross - https://blog.asquaredozen.com - A Square Dozen</a></p>
		</div>
	</div>
</footer>

			</div>
		</body>
</html>
