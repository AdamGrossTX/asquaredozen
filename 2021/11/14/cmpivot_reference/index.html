<!doctype html><html lang=en-us><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=keyword content="ConfigMgr Microsoft MVP Gross Intune Windows"><meta name=viewport content="width=device-width"><meta name=description content="A.Gross Blog | Adam Gross Enterprise Mobility MVP"><link rel="shortcut icon" href=/img/favicon.ico><title>CMPivot Reference-A Square Dozen | A. Gross Blog</title>
<link rel=canonical href=/2021/11/14/cmpivot_reference/><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=https://www.asquaredozen.com/css/custom.css><script src=https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js></script><script src=https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js></script><script src=https://www.asquaredozen.com/js/jquery.slicknav.js></script><script src=https://www.asquaredozen.com/js/asd_SlickNav_Mobile.js></script><script src=https://www.asquaredozen.com/js/custom.js></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-DYVXTRTXN4"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-DYVXTRTXN4",{anonymize_ip:!1})}</script><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.asquaredozen.com/2021/11/14/cmpivot_reference/2021-11-14_1-23-30.png"><meta name=twitter:title content="CMPivot Reference"><meta name=twitter:description content="The following examples were compiled from the CMPivot Home screen examples and the PowerShell equivalent commands were extracted from the CMPivot PowerShell script that is copied down locally to C:\Windows\CCM\ScriptStore. The goal is the provide a way to understand what each command is actually doing when you run it.
Interpreting this Reference Query Type
WMI - The command run locally on the client is querying WMI. Any entity not listed here but available in CMPivot uses the same WMI Class that ConfigMgr Client Hardware Inventory uses."><meta property="og:title" content="CMPivot Reference"><meta property="og:description" content="The following examples were compiled from the CMPivot Home screen examples and the PowerShell equivalent commands were extracted from the CMPivot PowerShell script that is copied down locally to C:\Windows\CCM\ScriptStore. The goal is the provide a way to understand what each command is actually doing when you run it.
Interpreting this Reference Query Type
WMI - The command run locally on the client is querying WMI. Any entity not listed here but available in CMPivot uses the same WMI Class that ConfigMgr Client Hardware Inventory uses."><meta property="og:type" content="article"><meta property="og:url" content="https://www.asquaredozen.com/2021/11/14/cmpivot_reference/"><meta property="og:image" content="https://www.asquaredozen.com/2021/11/14/cmpivot_reference/2021-11-14_1-23-30.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-11-14T00:00:00+00:00"><meta property="article:modified_time" content="2021-11-14T00:00:00+00:00"><meta property="og:site_name" content="A Square Dozen | A. Gross Blog"></head><body class="home blog"><div id=asd-container><div id=top-bar><div class=container><div id=nav-wrapper><ul class=menu id=menu-top-menu><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/>Home</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=#><span>Feature Updates</span></a><ul class="sub-menu menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2020/07/26/demystifying-windows-10-feature-update-blocks/>Demystifying Windows 10 Feature Update Blocks</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2019/08/22/windows-10-feature-updates-leveraging-setupdiag-for-better-reporting/>Windows 10 Feature Updates – Leveraging SetupDiag for Better Reporting</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2019/10/05/windows-10-feature-updates-the-challenge-of-servicing-in-the-enterprise/>Windows 10 Feature Updates – The Challenge of Servicing in the Enterprise</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2019/08/25/windows-10-feature-updates-using-custom-action-scripts/>Windows 10 Feature Updates – Using Custom Action Scripts</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2019/08/25/windows-10-feature-updates-using-setupconfig-ini-to-manage-feature-updates-in-the-enterprise/>Windows 10 Feature Updates – Using Setupconfig.ini to Manage Feature Updates in the Enterprise</a></li></ul></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2019/02/12/the-system-center-configuration-manager-adminservice-guide/><span>ConfigMgr AdminService</span></a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=#><span>802.1x for OSD</span></a><ul class="sub-menu menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/07/29/configuring-802-1x-authentication-for-windows-deployment-part-1-building-an-802-1x-computer-authentication-script/>Part 1 – Building an 802.1x Computer Authentication Script</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/07/29/configuring-802-1x-authentication-for-windows-deployment-part-2-building-an-802-1x-enabled-winpe-boot-image/>Part 2 – Building an 802.1x Enabled WinPE Boot Image</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/07/29/configuring-802-1x-authentication-for-windows-deployment-part-3-integrating-802-1x-authentication-into-a-bare-metal-task-sequence/>Part 3 – Integrating 802.1x Authentication into a Bare Metal Task Sequence</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/07/29/configuring-802-1x-authentication-for-windows-deployment-part-4-integrating-802-1x-authentication-into-an-in-place-upgrade-task-sequence/>Part 4 – Integrating 802.1x Authentication into an In-Place Upgrade Task Sequence</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/09/29/configuring-802-1x-authentication-for-windows-deployment-part-5-dynamic-whitelisting-using-the-cisco-ise-external-restful-service/>Part 5 – Dynamic Whitelisting using the Cisco ISE External RESTful Service</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/07/29/configuring-802-1x-authentication-for-windows-deployment-tips-and-tricks/>Tips and Tricks</a></li></ul></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=#><span>Task Sequence Hacks</span></a><ul class="sub-menu menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/11/29/building-a-better-task-sequence/>Building a Better Task Sequence</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2019/04/30/building-a-smarter-task-sequence/>Building a Smarter Task Sequence</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/12/14/building-an-even-better-task-sequence/>Building An Even Better Task Sequence</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/07/16/clearing-local-group-policies-during-an-windows-7-to-10-in-place-upgrade-task-sequence/>Clearing Local Group Policies during an Windows 7 to 10 In-Place Upgrade Task Sequence</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/10/03/debugging-sccm-configmgr-task-sequences-on-the-fly/>Debugging SCCM/ConfigMgr Task Sequences on the Fly</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/07/11/dynamically-updating-unattend-xml-during-an-osd-task-sequence-using-mdt-variables-and-zti-scripts/>Dynamically Updating Unattend.XML during an OSD Task Sequence using MDT Variables and ZTI Scripts.</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/06/14/triggering-configmgr-client-actions-from-a-task-sequence/>Triggering ConfigMgr Client Actions from a Task Sequence</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/08/27/using-sccm-task-sequence-variables-as-scripts/>Using SCCM Task Sequence Variables as Scripts</a></li></ul></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=https://github.com/AdamGrossTX><span>GitHub</span></a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=#><span>MORE></span></a><ul class="sub-menu menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/about/>About</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/consulting/>Consulting</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/contact/>Contact</a></li></ul></li></ul></div><div id=top-search><a href=# class=search><i class="fa fa-search"></i></a><div class=show-search><form role=search method=get action=https://www.google.com/search id=searchform><input type=search placeholder="Search and hit enter..." name=q id=q title="Search and hit enter...">
<input type=hidden name=sitesearch value=https://www.asquaredozen.com>
<button type=submit value=Search></form></div></div><div class=menu id=menu-mobile></div></div></div><header id=header class=noslider><div class=container><div id=logo><h1><a href=https://www.asquaredozen.com><img src=/img/A-Square-Dozen-Logo-BlogHeader-1.png alt="A Square Dozen"></a></h1></div></div></header><div class=container><div id=content><div id=main class=fullwidth><article class="post type-post status-publish format-standard has-post-thumbnail hentry"><div class=post-header><h1>CMPivot Reference</h1><span class=post-date>November 14, 2021</span></div><div class=post-entry><p>The following examples were compiled from the <a href=https://docs.microsoft.com/en-us/mem/configmgr/core/servers/manage/cmpivot>CMPivot</a> Home screen examples and the PowerShell equivalent commands were extracted from the CMPivot PowerShell script that is copied down locally to <code>C:\Windows\CCM\ScriptStore</code>. The goal is the provide a way to understand what each command is actually doing when you run it.</p><h4 id=interpreting-this-reference>Interpreting this Reference</h4><ul><li><p><strong>Query Type</strong></p><ul><li>WMI - The command run locally on the client is querying WMI. Any entity not listed here but available in CMPivot uses the same WMI Class that ConfigMgr Client Hardware Inventory uses.</li><li>Powershell - These are special custom commands unique to CMPivot. The included PowerShell Equivalent example is taken directly from the local CMPivot script.</li></ul></li><li><p><strong>WMI (Namespace, Class)</strong></p><ul><li>The WMI Namespace and Class of the Entity where applicable. If not listed, then the entity uses custom PowerShell to query the data.</li></ul></li><li><p><strong>Local Query Name</strong></p><ul><li>This is the name that the local CMPivot script uses to query this entity.</li></ul></li><li><p><strong>Syntax</strong></p><ul><li>A Kusto Syntax of how to query the entity showing any parameter options.</li></ul></li><li><p><strong>Example</strong></p><ul><li>Shows how to query the Entity with examples of the parameter format where required.</li></ul></li><li><p><strong>PowerShell Equivalent</strong></p><ul><li>PowerShell example that can be used to validate that the data being queried is coming from a source you expect.</li></ul></li></ul><h2 id=aadstatus>AadStatus</h2><ul><li><p><strong>Query Type</strong>: Powershell</p></li><li><p><strong>Local Query Name</strong>: AadStatus</p></li><li><p><strong>Syntax</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>AadStatus
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>Example</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>AadStatus
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>PowerShell Equivalent</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-27>27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-28>28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-29>29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-30>30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-31>31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-32><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-32>32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-33><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-33>33</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:teal>$dsregcmd</span> = <span style=color:#d14>&#34;</span><span style=color:teal>$Env:Windir</span><span style=color:#d14>\system32\dsregcmd.exe&#34;</span>
</span></span><span style=display:flex><span><span style=color:teal>$rawoutput</span> = &amp; <span style=color:teal>$dsregcmd</span> /status
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:teal>$hash</span> = @{}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>foreach</span>( <span style=color:teal>$line</span> <span style=color:#000;font-weight:700>in</span> <span style=color:teal>$rawoutput</span> )
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:teal>$sep</span> = <span style=color:teal>$line</span>.IndexOf(<span style=color:#d14>&#34;:&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>if</span>( <span style=color:teal>$sep</span> <span style=color:#000;font-weight:700>-ne</span> <span style=color:#099>-1</span> )
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:teal>$propName</span> = <span style=color:teal>$line</span>.SubString(<span style=color:#099>0</span>, <span style=color:teal>$sep</span>).Trim()
</span></span><span style=display:flex><span>        <span style=color:teal>$propValue</span> = <span style=color:teal>$line</span>.SubString(<span style=color:teal>$sep</span>+<span style=color:#099>1</span>).Trim()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>if</span>( <span style=color:teal>$propValue</span> <span style=color:#000;font-weight:700>-eq</span> <span style=color:#d14>&#39;YES&#39;</span> )
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:teal>$propValue</span> = $true
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>elseif</span>( <span style=color:teal>$propValue</span> <span style=color:#000;font-weight:700>-eq</span> <span style=color:#d14>&#39;NO&#39;</span> )
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:teal>$propValue</span> = $false
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:teal>$hash</span>.Add(<span style=color:teal>$propName</span>,<span style=color:teal>$propValue</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>if</span>( <span style=color:teal>$hash</span>.Count <span style=color:#000;font-weight:700>-eq</span> <span style=color:#099>0</span> ) 
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>throw</span> <span style=color:#d14>&#39;dsregcmd returned invalid response&#39;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:teal>$hash</span>
</span></span></code></pre></td></tr></table></div></div></li></ul><h2 id=administrators>Administrators</h2><ul><li><p><strong>Query Type</strong>: Powershell</p></li><li><p><strong>Local Query Name</strong>: Administrators</p></li><li><p><strong>Syntax</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>Administrators
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>Example</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>Administrators
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>PowerShell Equivalent</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#0086b3>Get-LocalGroupMember</span> -SID S-<span style=color:#099>1</span>-<span style=color:#099>5</span>-<span style=color:#099>32</span>-<span style=color:#099>544</span>
</span></span></code></pre></td></tr></table></div></div></li></ul><h2 id=appcrash>AppCrash</h2><ul><li><p><strong>Query Type</strong>: Powershell</p></li><li><p><strong>Local Query Name</strong>: AppCrash</p></li><li><p><strong>Syntax</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>AppCrash
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>Example</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>AppCrash | summarize dcount( Device ) by FileName,Version
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>PowerShell Equivalent</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-15>15</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#000;font-weight:700>try</span> {
</span></span><span style=display:flex><span>    <span style=color:teal>$crashes</span> = <span style=color:#0086b3>Get-EventLog</span> -LogName Application -After (<span style=color:#0086b3>Get-Date</span>).AddDays(<span style=color:#099>-7</span>) -InstanceId <span style=color:#099>1000</span> -Source <span style=color:#d14>&#39;Application Error&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:teal>$results</span> = <span style=color:#000;font-weight:700>foreach</span> (<span style=color:teal>$crash</span> <span style=color:#000;font-weight:700>in</span> <span style=color:teal>$crashes</span>)  
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:teal>$hash</span> = @{
</span></span><span style=display:flex><span>                FileName = <span style=color:teal>$crash</span>.ReplacementStrings[<span style=color:#099>0</span>]
</span></span><span style=display:flex><span>                Version = <span style=color:teal>$crash</span>.ReplacementStrings[<span style=color:#099>1</span>]
</span></span><span style=display:flex><span>                ReportId = <span style=color:teal>$crash</span>.ReplacementStrings[<span style=color:#099>12</span>]
</span></span><span style=display:flex><span>                DateTime = <span style=color:teal>$crash</span>.TimeGenerated
</span></span><span style=display:flex><span>        } 
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:teal>$results</span>       
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>catch</span>{}
</span></span></code></pre></td></tr></table></div></div></li></ul><h2 id=autostartsoftware>AutoStartSoftware</h2><ul><li><p><strong>Query Type</strong>: Wmi</p></li><li><p><strong>WMI (Namespace, Class)</strong>: (ROOT/cimv2/sms, SMS_AutoStartSoftware)</p></li><li><p><strong>Syntax</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>AutoStartSoftware
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>Example</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>AutoStartSoftware | summarize dcount( Device ) by Product
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>PowerShell Equivalent</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#0086b3>Get-WMIObject</span> -Namespace ROOT/cimv2/sms -Class SMS_AutoStartSoftware
</span></span></code></pre></td></tr></table></div></div></li></ul><h2 id=bios>Bios</h2><ul><li><p><strong>Query Type</strong>: Wmi</p></li><li><p><strong>WMI (Namespace, Class)</strong>: Win32_Bios</p></li><li><p><strong>Syntax</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>Bios
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>Example</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>Bios | summarize dcount( Device ) by Manufacturer
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>PowerShell Equivalent</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#0086b3>Get-WMIObject</span> -Namespace ROOT/cimv2 -Class Win32_Bios
</span></span></code></pre></td></tr></table></div></div></li></ul><h2 id=ccmlog>CcmLog</h2><ul><li><p><strong>Query Type</strong>: Powershell</p></li><li><p><strong>Local Query Name</strong>: CCMlog</p></li><li><p><strong>Syntax</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>CcmLog(&lt;logFileName&gt;,[&lt;timespan&gt;])
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>Example</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>CcmLog(&#39;Scripts&#39;, 1d)
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>PowerShell Equivalent</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-27>27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-28>28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-29>29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-30>30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-31>31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-32><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-32>32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-33><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-33>33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-34><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-34>34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-35><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-35>35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-36><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-36>36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-37><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-37>37</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-38><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-38>38</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-39><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-39>39</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-40><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-40>40</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-41><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-41>41</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-42><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-42>42</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-43><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-43>43</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-44><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-44>44</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-45><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-45>45</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-46><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-46>46</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-47><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-47>47</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-48><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-48>48</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-49><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-49>49</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:teal>$logFileName</span> = <span style=color:#d14>&#39;Scripts&#39;</span>
</span></span><span style=display:flex><span><span style=color:teal>$secondsAgo</span> = <span style=color:#099>86400</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:teal>$key</span> = [<span style=color:teal>Microsoft.Win32.RegistryKey</span>]::OpenBaseKey([<span style=color:teal>Microsoft.Win32.RegistryHive</span>]::LocalMachine, [<span style=color:teal>Microsoft.Win32.RegistryView</span>]::Registry64)
</span></span><span style=display:flex><span><span style=color:teal>$subKey</span> =  <span style=color:teal>$key</span>.OpenSubKey(<span style=color:#d14>&#34;SOFTWARE\Microsoft\CCM\Logging\@Global&#34;</span>)
</span></span><span style=display:flex><span><span style=color:teal>$ccmlogdir</span> = <span style=color:teal>$subKey</span>.GetValue(<span style=color:#d14>&#34;LogDirectory&#34;</span>)
</span></span><span style=display:flex><span><span style=color:teal>$key</span>.Close()
</span></span><span style=display:flex><span><span style=color:teal>$logPath</span> = (<span style=color:#0086b3>join-path</span> <span style=color:teal>$ccmlogdir</span> (<span style=color:teal>$logFileName</span>+<span style=color:#d14>&#34;.log&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#998;font-style:italic>#verify format of file name</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>if</span>(( <span style=color:teal>$logFileName</span> <span style=color:#000;font-weight:700>-match</span> <span style=color:#d14>&#39;[\w\d-_@]+&#39;</span> ) <span style=color:#000;font-weight:700>-and</span> ([<span style=color:teal>System.IO.File</span>]::Exists(<span style=color:teal>$logPath</span>)))
</span></span><span style=display:flex><span>{        
</span></span><span style=display:flex><span>    <span style=color:teal>$lines</span> = (<span style=color:#0086b3>get-content</span> -path <span style=color:teal>$logpath</span> -ErrorAction Stop)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    [<span style=color:teal>regex</span>]<span style=color:teal>$ccmLog</span> = <span style=color:#d14>&#39;&lt;!\[LOG\[(?&lt;logtext&gt;.*)\]LOG\]!&gt;&lt;\s*time\s*\=\s*&#34;(?&lt;time&gt;\d\d:\d\d:\d\d)[^&#34;]+&#34;\s+date\s*\=\s*&#34;(?&lt;date&gt;[^&#34;]+)&#34;\s+component\s*\=\s*&#34;(?&lt;component&gt;[^&#34;]*)&#34;\s+context\s*\=\s*&#34;(?&lt;context&gt;[^&#34;]*)&#34;\s+type\s*\=\s*&#34;(?&lt;type&gt;[^&#34;]+)&#34;\s+thread\s*\=\s*&#34;(?&lt;thread&gt;[^&#34;]+)&#34;\s+file\s*\=\s*&#34;(?&lt;file&gt;[^&#34;]+)&#34;\s*&gt;&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:teal>$results</span> = <span style=color:#000;font-weight:700>for</span>( <span style=color:teal>$index</span> = <span style=color:teal>$lines</span>.Length-<span style=color:#099>1</span>; <span style=color:teal>$index</span> <span style=color:#000;font-weight:700>-ge</span> <span style=color:#099>0</span>; <span style=color:teal>$index</span>-- )
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:teal>$line</span> = <span style=color:teal>$lines</span>[<span style=color:teal>$index</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:teal>$m</span> = <span style=color:teal>$ccmLog</span>.Match(<span style=color:teal>$line</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>if</span>( <span style=color:teal>$m</span>.Success <span style=color:#000;font-weight:700>-eq</span> $true )
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:teal>$hash</span> = @{
</span></span><span style=display:flex><span>                LogText = <span style=color:teal>$m</span>.Groups[<span style=color:#d14>&#34;logtext&#34;</span>].Value
</span></span><span style=display:flex><span>                DateTime = ([<span style=color:teal>DateTime</span>](<span style=color:teal>$m</span>.Groups[<span style=color:#d14>&#34;date&#34;</span>].Value +<span style=color:#d14>&#39; &#39;</span>+ <span style=color:teal>$m</span>.Groups[<span style=color:#d14>&#34;time&#34;</span>].Value)).ToUniversalTime()
</span></span><span style=display:flex><span>                Component = <span style=color:teal>$m</span>.Groups[<span style=color:#d14>&#34;component&#34;</span>].Value
</span></span><span style=display:flex><span>                Context = <span style=color:teal>$m</span>.Groups[<span style=color:#d14>&#34;context&#34;</span>].Value
</span></span><span style=display:flex><span>                <span style=color:#0086b3>Type </span>= <span style=color:teal>$m</span>.Groups[<span style=color:#d14>&#34;type&#34;</span>].Value
</span></span><span style=display:flex><span>                Thread = <span style=color:teal>$m</span>.Groups[<span style=color:#d14>&#34;thread&#34;</span>].Value
</span></span><span style=display:flex><span>                File = <span style=color:teal>$m</span>.Groups[<span style=color:#d14>&#34;file&#34;</span>].Value
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#998;font-style:italic># Filter out logs based on timespan</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>if</span> ( [<span style=color:teal>System.DateTime</span>]::Compare(<span style=color:teal>$hash</span>.DateTime, (<span style=color:#0086b3>Get-Date</span>).AddSeconds(<span style=color:#099>-1</span>*<span style=color:teal>$secondsAgo</span>).ToUniversalTime()) <span style=color:#000;font-weight:700>-lt</span> <span style=color:#099>0</span> )
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#000;font-weight:700>break</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>else</span>
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:teal>$hash</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }   
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#998;font-style:italic># Reverse the results list to ascending datetime</span>
</span></span><span style=display:flex><span>    <span style=color:teal>$results</span>.Reverse()
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div></li></ul><h2 id=connection>Connection</h2><ul><li><p><strong>Query Type</strong>: Powershell</p></li><li><p><strong>Local Query Name</strong>: Connections</p></li><li><p><strong>Syntax</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>Connection
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>Example</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>Connection
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>PowerShell Equivalent</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-5>5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-6>6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-7>7</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:teal>$netstat</span> = <span style=color:#d14>&#34;</span><span style=color:teal>$Env:Windir</span><span style=color:#d14>\system32\netstat.exe&#34;</span>
</span></span><span style=display:flex><span><span style=color:teal>$rawoutput</span> = &amp; <span style=color:teal>$netstat</span> <span style=color:#000;font-weight:700>-f</span>
</span></span><span style=display:flex><span><span style=color:teal>$netstatdata</span> = <span style=color:teal>$rawoutput</span>[<span style=color:#099>3</span>..<span style=color:teal>$rawoutput</span>.count] | <span style=color:#0086b3>ConvertFrom-String</span> | <span style=color:#0086b3>select </span>p2,p3,p4,p5 | <span style=color:#0086b3>where </span>p5 <span style=color:#000;font-weight:700>-eq</span> <span style=color:#d14>&#39;established&#39;</span> | <span style=color:#0086b3>select </span>P4  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>foreach</span>( <span style=color:teal>$data</span> <span style=color:#000;font-weight:700>in</span> <span style=color:teal>$netstatdata</span>) {
</span></span><span style=display:flex><span>    <span style=color:teal>$data</span>.P4.Substring(<span style=color:#099>0</span>,<span style=color:teal>$data</span>.P4.LastIndexOf(<span style=color:#d14>&#34;:&#34;</span>))
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div></li></ul><h2 id=device>Device</h2><ul><li><p><strong>Query Type</strong>: Wmi</p></li><li><p><strong>WMI (Namespace, Class)</strong>: (ROOT/cimv2, Win32_ComputerSystem)</p></li><li><p><strong>Syntax</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>Device
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>Example</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-22-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-22-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>Device
</span></span></code></pre></td></tr></table></div></div></li></ul><h2 id=disk>Disk</h2><ul><li><p><strong>Query Type</strong>: Wmi</p></li><li><p><strong>WMI (Namespace, Class)</strong>: (ROOT/cimv2, Win32_LogicalDisk)</p></li><li><p><strong>Syntax</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-23-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-23-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>Disk
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>Example</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-24-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-24-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>Disk | summarize dcount( Device ) by Description
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>PowerShell Equivalent</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#0086b3>Get-WMIObject</span> -Namespace ROOT/cimv2 -Class Win32_LogicalDisk
</span></span></code></pre></td></tr></table></div></div></li></ul><h2 id=epstatus>EPStatus</h2><ul><li><p><strong>WMI (Namespace, Class)</strong>: EPStatus</p></li><li><p><strong>Query Type</strong>: Powershell</p></li><li><p><strong>Local Query Name</strong>: EPStatus</p></li><li><p><strong>Syntax</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-26-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-26-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>EPStatus
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>Example</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-27-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-27-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>EPStatus
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>PowerShell Equivalent</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#0086b3>Get-MpComputerStatus</span>
</span></span></code></pre></td></tr></table></div></div></li></ul><h2 id=eventlog>EventLog</h2><ul><li><p><strong>Query Type</strong>: Powershell</p></li><li><p><strong>Local Query Name</strong>: EventLog</p></li><li><p><strong>Syntax</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-29-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-29-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>EventLog(&lt;logFileName&gt;, [timespan])
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>Example</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>EventLog(&#39;Security&#39;,1d)
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>PowerShell Equivalent</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-16>16</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:teal>$logName</span> = <span style=color:#d14>&#39;Security&#39;</span>
</span></span><span style=display:flex><span><span style=color:teal>$secondsAgo</span> = <span style=color:#099>86400</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:teal>$events</span> = <span style=color:#0086b3>Get-EventLog</span> -LogName <span style=color:teal>$logName</span> -After (<span style=color:#0086b3>Get-Date</span>).AddSeconds(<span style=color:#099>-1</span>*<span style=color:teal>$secondsAgo</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:teal>$results</span> = <span style=color:#000;font-weight:700>foreach</span> (<span style=color:teal>$event</span> <span style=color:#000;font-weight:700>in</span> <span style=color:teal>$events</span>)  
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    @{
</span></span><span style=display:flex><span>        DateTime = <span style=color:teal>$event</span>.TimeGenerated
</span></span><span style=display:flex><span>        EntryType = <span style=color:teal>$event</span>.EntryType
</span></span><span style=display:flex><span>        Source = <span style=color:teal>$event</span>.Source
</span></span><span style=display:flex><span>        EventID = <span style=color:teal>$Event</span>.EventID
</span></span><span style=display:flex><span>        Message = <span style=color:teal>$Event</span>.Message
</span></span><span style=display:flex><span>    } 
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:teal>$results</span>
</span></span></code></pre></td></tr></table></div></div></li></ul><h2 id=file>File</h2><ul><li><p><strong>Query Type</strong>: Powershell</p></li><li><p><strong>Local Query Name</strong>: File</p></li><li><p><strong>Syntax</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-32-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-32-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>File(&lt;filename&gt;)
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>Example</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>File(&#39;%windir%\\notepad.exe&#39;)
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>PowerShell Equivalent</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-34-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-34-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-34-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-34-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-34-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-34-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-34-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-34-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-34-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-34-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-34-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-34-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-34-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-34-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-34-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-34-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-34-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-34-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-34-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-34-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-34-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-34-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-34-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-34-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-34-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-34-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-34-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-34-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-34-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-34-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-34-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-34-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-34-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-34-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-34-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-34-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-34-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-34-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-34-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-34-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-34-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-34-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-34-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-34-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-34-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-34-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-34-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-34-24>24</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:teal>$fileSpec</span> = [<span style=color:teal>System.Environment</span>]::ExpandEnvironmentVariables( <span style=color:#d14>&#39;%windir%\notepad.exe&#39;</span> )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:teal>$results</span> = <span style=color:#000;font-weight:700>foreach</span>( <span style=color:teal>$file</span> <span style=color:#000;font-weight:700>in</span> (<span style=color:#0086b3>Get-Item</span> -Force -ErrorAction SilentlyContinue -Path <span style=color:teal>$filespec</span>))
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:teal>$fileSHA256</span> = <span style=color:#d14>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:teal>$fileMD5</span> = <span style=color:#d14>&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>try</span> {
</span></span><span style=display:flex><span>        <span style=color:teal>$fileSHA256</span> = (<span style=color:#0086b3>get-filehash</span> -ErrorAction SilentlyContinue -Path <span style=color:teal>$file</span>).Hash 
</span></span><span style=display:flex><span>        <span style=color:teal>$fileMD5</span> = (<span style=color:#0086b3>get-filehash</span> -ErrorAction SilentlyContinue -Path <span style=color:teal>$file</span> -Algorithm MD5).Hash
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>catch</span> {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    @{
</span></span><span style=display:flex><span>        FileName = <span style=color:teal>$file</span>.FullName
</span></span><span style=display:flex><span>        Mode = <span style=color:teal>$file</span>.Mode
</span></span><span style=display:flex><span>        LastWriteTime = <span style=color:teal>$file</span>.LastWriteTime
</span></span><span style=display:flex><span>        Size = <span style=color:teal>$file</span>.Length
</span></span><span style=display:flex><span>        Version = <span style=color:teal>$file</span>.VersionInfo.ProductVersion
</span></span><span style=display:flex><span>        SHA256Hash = <span style=color:teal>$fileSHA256</span>
</span></span><span style=display:flex><span>        MD5Hash = <span style=color:teal>$fileMD5</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:teal>$results</span>
</span></span></code></pre></td></tr></table></div></div></li></ul><h2 id=filecontent>FileContent</h2><ul><li><p><strong>Query Type</strong>: Powershell</p></li><li><p><strong>Local Query Name</strong>: FileContent</p></li><li><p><strong>Syntax</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-35-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-35-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>FileContent(&lt;filename&gt;)
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>Example</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>FileContent(&#39;%windir%\\smscfg.ini&#39;)
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>PowerShell Equivalent</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-16>16</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:teal>$filepath</span> = [<span style=color:teal>System.Environment</span>]::ExpandEnvironmentVariables( <span style=color:#d14>&#39;%windir%\smscfg.ini&#39;</span> )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>if</span>( [<span style=color:teal>System.IO.File</span>]::Exists(<span style=color:teal>$filepath</span>) )
</span></span><span style=display:flex><span>{        
</span></span><span style=display:flex><span>    <span style=color:teal>$lines</span> = (<span style=color:#0086b3>get-content</span> -path <span style=color:teal>$filepath</span> -ErrorAction Stop)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:teal>$results</span> = <span style=color:#000;font-weight:700>for</span> (<span style=color:teal>$index</span> = <span style=color:#099>0</span>; <span style=color:teal>$index</span> <span style=color:#000;font-weight:700>-lt</span> <span style=color:teal>$lines</span>.Length; <span style=color:teal>$index</span>++)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:teal>$line</span> = <span style=color:teal>$lines</span>[<span style=color:teal>$index</span>]
</span></span><span style=display:flex><span>        @{
</span></span><span style=display:flex><span>            Line = <span style=color:teal>$index</span>+<span style=color:#099>1</span>
</span></span><span style=display:flex><span>            Content = <span style=color:teal>$line</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:teal>$results</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div></li></ul><h2 id=fileshare>FileShare</h2><ul><li><p><strong>Query Type</strong>: Wmi</p></li><li><p><strong>WMI (Namespace, Class)</strong>: (ROOT/cimv2, Win32_Share)</p></li><li><p><strong>Syntax</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-38-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-38-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>FileShare
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>Example</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>FileShare | summarize dcount( Device ) by Name
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>PowerShell Equivalent</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-40-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-40-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#0086b3>Get-WMIObject</span> -Namespace ROOT/cimv2 -Class Win32_Share
</span></span></code></pre></td></tr></table></div></div></li></ul><h2 id=installedsoftware>InstalledSoftware</h2><ul><li><p><strong>Query Type</strong>: Wmi</p></li><li><p><strong>WMI (Namespace, Class)</strong>: (ROOT/cimv2/sms, SMS_InstalledSoftware)</p></li><li><p><strong>Syntax</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-41-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-41-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>InstalledSoftware
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>Example</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-42-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-42-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>InstalledSoftware | summarize dcount( Device ) by ProductName
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>PowerShell Equivalent</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-43-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-43-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#0086b3>Get-WMIObject</span> -Namespace ROOT/cimv2/sms -Class SMS_InstalledSoftware
</span></span></code></pre></td></tr></table></div></div></li></ul><h2 id=ipconfig>IPConfig</h2><ul><li><p><strong>Query Type</strong>: Powershell</p></li><li><p><strong>Local Query Name</strong>: IPConfig</p></li><li><p><strong>Syntax</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-44-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-44-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>IPConfig
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>Example</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-45-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-45-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>IPConfig
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>PowerShell Equivalent</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-46-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-46-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-46-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-46-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-46-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-46-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-46-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-46-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-46-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-46-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-46-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-46-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-46-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-46-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-46-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-46-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-46-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-46-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-46-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-46-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-46-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-46-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-46-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-46-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-46-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-46-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-46-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-46-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-46-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-46-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-46-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-46-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-46-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-46-17>17</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:teal>$ipconfigs</span> = (<span style=color:#0086b3>Get-NetIPConfiguration</span> -ErrorAction Stop)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:teal>$results</span> = <span style=color:#000;font-weight:700>foreach</span>( <span style=color:teal>$ipconfig</span> <span style=color:#000;font-weight:700>in</span> <span style=color:teal>$ipconfigs</span> )
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    @{
</span></span><span style=display:flex><span>        InterfaceAlias = <span style=color:teal>$ipconfig</span>.InterfaceAlias
</span></span><span style=display:flex><span>        Name = <span style=color:teal>$ipconfig</span>.NetProfile.Name
</span></span><span style=display:flex><span>        InterfaceDescription = <span style=color:teal>$ipconfig</span>.InterfaceDescription
</span></span><span style=display:flex><span>        Status = <span style=color:teal>$ipconfig</span>.NetAdapter.Status
</span></span><span style=display:flex><span>        IPV4Address = <span style=color:teal>$ipconfig</span>.IPv4Address.IPAddress
</span></span><span style=display:flex><span>        IPV6Address = <span style=color:teal>$ipconfig</span>.IPv6Address.IPAddress
</span></span><span style=display:flex><span>        IPV4DefaultGateway = <span style=color:teal>$ipconfig</span>.IPv4DefaultGateway.NextHop
</span></span><span style=display:flex><span>        IPV6DefaultGateway = <span style=color:teal>$ipconfig</span>.IPv6DefaultGateway.NextHop
</span></span><span style=display:flex><span>        DNSServerList = (<span style=color:teal>$ipconfig</span>.DNSServer.ServerAddresses -join <span style=color:#d14>&#34;; &#34;</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:teal>$results</span>
</span></span></code></pre></td></tr></table></div></div></li></ul><h2 id=os>OS</h2><ul><li><p><strong>Query Type</strong>: Wmi</p></li><li><p><strong>WMI (Namespace, Class)</strong>: Win32_OperatingSystem</p></li><li><p><strong>Syntax</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-47-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-47-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>OS
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>Example</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-48-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-48-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>OS
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>PowerShell Equivalent</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-49-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-49-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#0086b3>Get-WMIObject</span> -Namespace ROOT/cimv2 -Class Win32_OperatingSystem
</span></span></code></pre></td></tr></table></div></div></li></ul><h2 id=process>Process</h2><ul><li><p><strong>Query Type</strong>: Wmi</p></li><li><p><strong>WMI (Namespace, Class)</strong>: (ROOT/cimv2, Win32_Process)</p></li><li><p><strong>Syntax</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-50-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-50-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>Process
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>Example</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-51-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-51-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>Process | summarize dcount( Device ) by Name
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>PowerShell Equivalent</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-52-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-52-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#0086b3>Get-WMIObject</span> -Namespace ROOT/cimv2 -Class Win32_Process
</span></span></code></pre></td></tr></table></div></div></li></ul><h2 id=processmodule>ProcessModule</h2><ul><li><p><strong>Query Type</strong>: Powershell</p></li><li><p><strong>Local Query Name</strong>: ProcessModule</p></li><li><p><strong>Syntax</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-53-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-53-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>ProcessModule(&lt;processname&gt;)
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>Example</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-54-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-54-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>ProcessModule(&#39;explorer&#39;)&#34;
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>PowerShell Equivalent</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-55-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-55-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-55-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-55-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-55-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-55-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-55-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-55-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-55-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-55-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-55-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-55-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-55-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-55-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-55-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-55-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-55-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-55-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-55-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-55-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-55-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-55-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-55-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-55-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-55-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-55-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-55-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-55-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-55-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-55-15>15</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:teal>$processName</span> = <span style=color:#d14>&#39;explorer&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:teal>$modules</span> = <span style=color:#0086b3>Get-Process</span> -name <span style=color:teal>$processName</span> -module -ErrorAction SilentlyContinue
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:teal>$results</span> = <span style=color:#000;font-weight:700>foreach</span> (<span style=color:teal>$module</span> <span style=color:#000;font-weight:700>in</span> <span style=color:teal>$modules</span>)  
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    @{
</span></span><span style=display:flex><span>        ModuleName = <span style=color:teal>$module</span>.ModuleName
</span></span><span style=display:flex><span>        FileName = <span style=color:teal>$module</span>.FileName
</span></span><span style=display:flex><span>        FileVersion = <span style=color:teal>$module</span>.FileVersion
</span></span><span style=display:flex><span>        Size = <span style=color:teal>$module</span>.Size
</span></span><span style=display:flex><span>        MD5Hash = (<span style=color:#0086b3>get-filehash</span> -ErrorAction SilentlyContinue -Path <span style=color:teal>$module</span>.FileName -Algorithm MD5).Hash
</span></span><span style=display:flex><span>    } 
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:teal>$results</span>
</span></span></code></pre></td></tr></table></div></div></li></ul><h2 id=registry>Registry</h2><ul><li><p><strong>Query Type</strong>: Powershell</p></li><li><p><strong>Local Query Name</strong>: registry</p></li><li><p><strong>Syntax</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-56-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-56-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>Registry(&lt;registrypath&gt;)
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>Example</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-57-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-57-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>Registry(&#39;hklm:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion&#39;)
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>PowerShell Equivalent</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-58-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-58-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-58-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-58-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-58-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-58-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-58-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-58-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-58-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-58-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-58-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-58-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-58-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-58-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-58-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-58-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-58-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-58-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-58-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-58-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-58-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-58-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-58-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-58-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-58-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-58-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-58-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-58-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-58-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-58-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-58-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-58-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-58-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-58-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-58-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-58-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-58-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-58-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-58-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-58-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-58-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-58-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-58-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-58-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-58-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-58-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-58-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-58-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-58-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-58-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-58-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-58-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-58-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-58-27>27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-58-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-58-28>28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-58-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-58-29>29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-58-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-58-30>30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-58-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-58-31>31</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:teal>$regSpec</span> = <span style=color:#d14>&#39;hklm:\SOFTWARE\Microsoft\Windows\CurrentVersion&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:teal>$result</span> = <span style=color:#0086b3>New-Object</span> System.Collections.Generic.List[<span style=color:teal>Object</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>foreach</span>( <span style=color:teal>$regKey</span> <span style=color:#000;font-weight:700>in</span> (<span style=color:#0086b3>Get-Item</span> -ErrorAction SilentlyContinue -Path <span style=color:teal>$regSpec</span>) )
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>foreach</span>( <span style=color:teal>$regValue</span> <span style=color:#000;font-weight:700>in</span> <span style=color:teal>$regKey</span>.Property )
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:teal>$val</span> = <span style=color:teal>$regKey</span>.GetValue(<span style=color:teal>$regValue</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>if</span>( <span style=color:teal>$val</span> <span style=color:#000;font-weight:700>-ne</span> $null)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>if</span>( <span style=color:teal>$val</span>.GetType() <span style=color:#000;font-weight:700>-eq</span> [<span style=color:teal>Byte[]</span>] )
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:teal>$val</span> = [<span style=color:teal>System.BitConverter</span>]::ToString(<span style=color:teal>$val</span>)
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>elseif</span>( <span style=color:teal>$val</span>.GetType() <span style=color:#000;font-weight:700>-eq</span> [<span style=color:teal>String[]</span>] )
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:teal>$val</span> = [<span style=color:teal>System.String</span>]::Join(<span style=color:#d14>&#34;, &#34;</span>, <span style=color:teal>$val</span>)
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:teal>$hash</span> = @{
</span></span><span style=display:flex><span>                Property = <span style=color:teal>$regValue</span>
</span></span><span style=display:flex><span>                Value = <span style=color:teal>$val</span>.ToString()
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:teal>$result</span>.Add(<span style=color:teal>$hash</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:teal>$result</span>
</span></span></code></pre></td></tr></table></div></div></li></ul><h2 id=registrykey>RegistryKey</h2><ul><li><p><strong>Query Type</strong>: Powershell</p></li><li><p><strong>Local Query Name</strong>: registrykey</p></li><li><p><strong>Syntax</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-59-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-59-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>RegistryKey(&lt;registrypath&gt;)
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>Example</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-60-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-60-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>RegistryKey(&#39;hklm:\\SOFTWARE\\Microsoft\\*&#39;)
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>PowerShell Equivalent</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-61-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-61-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-61-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-61-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-61-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-61-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-61-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-61-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-61-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-61-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-61-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-61-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-61-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-61-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-61-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-61-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-61-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-61-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-61-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-61-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-61-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-61-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-61-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-61-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-61-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-61-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-61-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-61-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-61-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-61-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-61-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-61-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-61-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-61-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-61-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-61-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-61-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-61-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-61-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-61-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-61-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-61-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-61-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-61-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-61-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-61-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-61-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-61-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-61-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-61-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-61-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-61-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-61-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-61-27>27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-61-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-61-28>28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-61-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-61-29>29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-61-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-61-30>30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-61-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-61-31>31</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:teal>$regSpec</span> = <span style=color:#d14>&#39;hklm:\SOFTWARE\Microsoft\*&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:teal>$result</span> = <span style=color:#0086b3>New-Object</span> System.Collections.Generic.List[<span style=color:teal>Object</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>foreach</span>( <span style=color:teal>$regKey</span> <span style=color:#000;font-weight:700>in</span> (<span style=color:#0086b3>Get-Item</span> -ErrorAction SilentlyContinue -Path <span style=color:teal>$regSpec</span>) )
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>foreach</span>( <span style=color:teal>$regValue</span> <span style=color:#000;font-weight:700>in</span> <span style=color:teal>$regKey</span>.Property )
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:teal>$val</span> = <span style=color:teal>$regKey</span>.GetValue(<span style=color:teal>$regValue</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>if</span>( <span style=color:teal>$val</span> <span style=color:#000;font-weight:700>-ne</span> $null)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>if</span>( <span style=color:teal>$val</span>.GetType() <span style=color:#000;font-weight:700>-eq</span> [<span style=color:teal>Byte[]</span>] )
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:teal>$val</span> = [<span style=color:teal>System.BitConverter</span>]::ToString(<span style=color:teal>$val</span>)
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>elseif</span>( <span style=color:teal>$val</span>.GetType() <span style=color:#000;font-weight:700>-eq</span> [<span style=color:teal>String[]</span>] )
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:teal>$val</span> = [<span style=color:teal>System.String</span>]::Join(<span style=color:#d14>&#34;, &#34;</span>, <span style=color:teal>$val</span>)
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:teal>$hash</span> = @{
</span></span><span style=display:flex><span>                Property = <span style=color:teal>$regValue</span>
</span></span><span style=display:flex><span>                Value = <span style=color:teal>$val</span>.ToString()
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:teal>$result</span>.Add(<span style=color:teal>$hash</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:teal>$result</span>
</span></span></code></pre></td></tr></table></div></div></li></ul><h2 id=service>Service</h2><ul><li><p><strong>Query Type</strong>: Wmi</p></li><li><p><strong>WMI (Namespace, Class)</strong>: (ROOT/cimv2, Win32_Service)</p></li><li><p><strong>Syntax</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-62-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-62-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>Service
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>Example</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-63-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-63-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>Service | summarize dcount( Device ) by Name
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>PowerShell Equivalent</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-64-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-64-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#0086b3>Get-WMIObject</span> -Namespace ROOT/cimv2 -Class Win32_Service
</span></span></code></pre></td></tr></table></div></div></li></ul><h2 id=smbconfig>SMBConfig</h2><ul><li><p><strong>Query Type</strong>: Powershell</p></li><li><p><strong>Local Query Name</strong>: SMBConfig</p></li><li><p><strong>Syntax</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-65-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-65-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>SMBConfig
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>Example</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-66-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-66-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>SMBConfig
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>PowerShell Equivalent</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-67-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-67-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#0086b3>Get-SmbServerConfiguration</span>
</span></span></code></pre></td></tr></table></div></div></li></ul><h2 id=softwareupdate>SoftwareUpdate</h2><ul><li><p><strong>Query Type</strong>: Powershell</p></li><li><p><strong>Local Query Name</strong>: Updates</p></li><li><p><strong>Syntax</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-68-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-68-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>SoftwareUpdate
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>Example</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-69-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-69-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>SoftwareUpdate
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>PowerShell Equivalent</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-27>27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-28>28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-29>29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-30>30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-31>31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-32><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-32>32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-33><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-33>33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-34><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-34>34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-35><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-35>35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-36><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-36>36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-37><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-37>37</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-38><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-38>38</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-39><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-39>39</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-40><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-40>40</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-41><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-41>41</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-42><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-42>42</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-43><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-43>43</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-44><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-44>44</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-45><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-45>45</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-46><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-46>46</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-47><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-47>47</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-48><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-48>48</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-49><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-49>49</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-50><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-50>50</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-51><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-51>51</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-52><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-52>52</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-53><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-53>53</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-54><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-54>54</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-70-55><a style=outline:none;text-decoration:none;color:inherit href=#hl-70-55>55</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:teal>$Session</span> =  [<span style=color:teal>activator</span>]::CreateInstance([<span style=color:teal>type</span>]::GetTypeFromProgID(<span style=color:#d14>&#34;Microsoft.Update.Session&#34;</span>,$null))
</span></span><span style=display:flex><span><span style=color:teal>$Searcher</span> = <span style=color:teal>$Session</span>.CreateUpdateSearcher()
</span></span><span style=display:flex><span><span style=color:teal>$Searcher</span>.ServerSelection = <span style=color:#099>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:teal>$MissingUpdates</span> = <span style=color:teal>$Searcher</span>.Search(<span style=color:#d14>&#34;DeploymentAction=* and IsInstalled=0 and Type=&#39;Software&#39;&#34;</span>)  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>if</span> (<span style=color:teal>$MissingUpdates</span>.Updates.Count <span style=color:#000;font-weight:700>-gt</span> <span style=color:#099>0</span>) 
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:teal>$results</span> = <span style=color:#000;font-weight:700>foreach</span>( <span style=color:teal>$Update</span> <span style=color:#000;font-weight:700>in</span> <span style=color:teal>$MissingUpdates</span>.Updates )
</span></span><span style=display:flex><span>    {   
</span></span><span style=display:flex><span>        <span style=color:teal>$KBArticleIDs</span> = <span style=color:#d14>&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>foreach</span>( <span style=color:teal>$KB</span> <span style=color:#000;font-weight:700>in</span> <span style=color:teal>$Update</span>.KBArticleIDs)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>if</span>( <span style=color:teal>$KBAticleIDs</span>.Length <span style=color:#000;font-weight:700>-gt</span> <span style=color:#099>0</span> )
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:teal>$KBArticleIDs</span> = <span style=color:teal>$KBArticleIDs</span> + <span style=color:#d14>&#34;,&#34;</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:teal>$KBArticleIDs</span> = <span style=color:teal>$KBArticleIDs</span> + <span style=color:#d14>&#34;KB</span><span style=color:teal>$KB</span><span style=color:#d14>&#34;</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:teal>$SecurityBulletinIDs</span> = <span style=color:#d14>&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>foreach</span>( <span style=color:teal>$BulletinID</span> <span style=color:#000;font-weight:700>in</span> <span style=color:teal>$Update</span>.SecurityBulletinIDs)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>if</span>( <span style=color:teal>$SecurityBulletinIDs</span>.Length <span style=color:#000;font-weight:700>-gt</span> <span style=color:#099>0</span> )
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:teal>$SecurityBulletinIDs</span> = <span style=color:teal>$SecurityBulletinIDs</span> + <span style=color:#d14>&#34;,&#34;</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:teal>$SecurityBulletinIDs</span> = <span style=color:teal>$SecurityBulletinIDs</span> + <span style=color:teal>$BulletinID</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:teal>$Categories</span> = <span style=color:#d14>&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>foreach</span>( <span style=color:teal>$Category</span> <span style=color:#000;font-weight:700>in</span> <span style=color:teal>$Update</span>.Categories)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>if</span>( <span style=color:teal>$Categories</span>.Length <span style=color:#000;font-weight:700>-gt</span> <span style=color:#099>0</span> )
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:teal>$Categories</span> = <span style=color:teal>$Categories</span> + <span style=color:#d14>&#34;,&#34;</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:teal>$Categories</span> = <span style=color:teal>$Categories</span> + <span style=color:teal>$Category</span>.Name
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        @{                 
</span></span><span style=display:flex><span>            Title = <span style=color:teal>$Update</span>.Title
</span></span><span style=display:flex><span>            RebootRequired = <span style=color:teal>$Update</span>.RebootRequired
</span></span><span style=display:flex><span>            LastDeploymentChangeTime = <span style=color:teal>$Update</span>.LastDeploymentChangeTime
</span></span><span style=display:flex><span>            UpdateID = <span style=color:teal>$Update</span>.Identity.UpdateID
</span></span><span style=display:flex><span>            KBArticleIDs = <span style=color:teal>$KBArticleIDs</span>
</span></span><span style=display:flex><span>            SecurityBulletinIDs = <span style=color:teal>$SecurityBulletinIDs</span>                                
</span></span><span style=display:flex><span>            Categories = <span style=color:teal>$Categories</span>                
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:teal>$results</span>
</span></span><span style=display:flex><span>} 
</span></span></code></pre></td></tr></table></div></div></li></ul><h2 id=user>User</h2><ul><li><p><strong>Query Type</strong>: Powershell</p></li><li><p><strong>Local Query Name</strong>: Users</p></li><li><p><strong>Syntax</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-71-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-71-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>User
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>Example</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-72-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-72-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>User | summarize dcount( Device ) by UserName
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>PowerShell Equivalent</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-73-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-73-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-73-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-73-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-73-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-73-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-73-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-73-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-73-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-73-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-73-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-73-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-73-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-73-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-73-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-73-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-73-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-73-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-73-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-73-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-73-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-73-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-73-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-73-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-73-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-73-13>13</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:teal>$users</span> = <span style=color:#0086b3>New-Object</span> System.Collections.Generic.List[<span style=color:teal>String</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>foreach</span>( <span style=color:teal>$user</span> <span style=color:#000;font-weight:700>in</span> (<span style=color:#0086b3>get-WmiObject</span> -class Win32_LoggedOnUser -ErrorAction Stop | <span style=color:#0086b3>Select </span>Antecedent))
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:teal>$parts</span> = <span style=color:teal>$user</span>.Antecedent.Split(<span style=color:#d14>&#34;&#34;&#34;&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>if</span>(( <span style=color:teal>$parts</span>[<span style=color:#099>1</span>] <span style=color:#000;font-weight:700>-ne</span> <span style=color:#d14>&#34;Window Manager&#34;</span> ) <span style=color:#000;font-weight:700>-and</span> ((<span style=color:teal>$parts</span>[<span style=color:#099>1</span>] <span style=color:#000;font-weight:700>-ne</span> <span style=color:teal>$env:COMPUTERNAME</span>) <span style=color:#000;font-weight:700>-or</span> ((<span style=color:teal>$parts</span>[<span style=color:#099>3</span>] <span style=color:#000;font-weight:700>-notlike</span> <span style=color:#d14>&#34;UMFD-*&#34;</span>)) <span style=color:#000;font-weight:700>-and</span> (<span style=color:teal>$parts</span>[<span style=color:#099>3</span>] <span style=color:#000;font-weight:700>-notlike</span> <span style=color:#d14>&#34;DWM-*&#34;</span>)))
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:teal>$users</span>.Add(<span style=color:teal>$parts</span>[<span style=color:#099>1</span>] + <span style=color:#d14>&#34;\&#34;</span> + <span style=color:teal>$parts</span>[<span style=color:#099>3</span>])            
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:teal>$users</span> | <span style=color:#0086b3>sort-object</span> -Unique
</span></span></code></pre></td></tr></table></div></div></li></ul><h2 id=winevent>WinEvent</h2><ul><li><p><strong>Query Type</strong>: Powershell</p></li><li><p><strong>Local Query Name</strong>: winevent</p></li><li><p><strong>Syntax</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-74-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-74-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>WinEvent(&lt;logfilename&gt;, [&lt;timespan&gt;])
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>Example</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-75-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-75-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>WinEvent(&#39;Application&#39;, 1d)
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>PowerShell Equivalent</strong>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-76-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-76-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-76-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-76-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-76-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-76-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-76-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-76-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-76-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-76-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-76-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-76-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-76-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-76-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-76-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-76-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-76-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-76-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-76-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-76-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-76-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-76-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-76-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-76-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-76-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-76-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-76-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-76-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-76-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-76-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-76-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-76-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-76-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-76-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-76-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-76-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-76-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-76-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-76-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-76-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-76-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-76-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-76-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-76-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-76-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-76-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-76-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-76-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-76-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-76-25>25</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:teal>$logFileName</span> =  <span style=color:#d14>&#39;Application&#39;</span>
</span></span><span style=display:flex><span><span style=color:teal>$secondsAgo</span> = <span style=color:#099>86400</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:teal>$ComputerName</span> = [<span style=color:teal>System.Environment</span>]::MachineName 
</span></span><span style=display:flex><span><span style=color:teal>$EventStartDate</span> = (<span style=color:#0086b3>Get-Date</span>).AddSeconds(<span style=color:#099>-1</span>*<span style=color:teal>$secondsAgo</span>)
</span></span><span style=display:flex><span><span style=color:teal>$EventEndTime</span> = (<span style=color:#0086b3>Get-Date</span>)
</span></span><span style=display:flex><span><span style=color:teal>$filterTable</span> = @{logname = <span style=color:teal>$logFileName</span>; StartTime=<span style=color:teal>$EventStartDate</span>; EndTime=<span style=color:teal>$EventEndTime</span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#998;font-style:italic># Filter out the winEvent logs that we need</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>try</span> {
</span></span><span style=display:flex><span>    <span style=color:teal>$winEvents</span> = <span style=color:#0086b3>Get-WinEvent</span> -ComputerName <span style=color:teal>$ComputerName</span> -FilterHashTable <span style=color:teal>$filterTable</span>  -ErrorAction Stop
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>catch</span> {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:teal>$results</span> = <span style=color:#000;font-weight:700>foreach</span> (<span style=color:teal>$winEvent</span> <span style=color:#000;font-weight:700>in</span> <span style=color:teal>$winEvents</span>)  
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    @{
</span></span><span style=display:flex><span>        DateTime = <span style=color:teal>$winEvent</span>.TimeCreated
</span></span><span style=display:flex><span>        LevelDisplayName = <span style=color:teal>$winEvent</span>.LevelDisplayName
</span></span><span style=display:flex><span>        ProviderName = <span style=color:teal>$winEvent</span>.ProviderName
</span></span><span style=display:flex><span>        ID = <span style=color:teal>$winEvent</span>.ID
</span></span><span style=display:flex><span>        Message = <span style=color:teal>$winEvent</span>.Message
</span></span><span style=display:flex><span>    } 
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:teal>$results</span>
</span></span></code></pre></td></tr></table></div></div></li></ul></div><comments id=comments><script src=https://utteranc.es/client.js repo=AdamGrossTX/asquaredozen issue-term=title label="blog comment" theme=github-light crossorigin=anonymous async></script></comments></article></div></div></div><footer id=footer><div class=container><div id=footer-copyright><p class=copyright>&copy; 2024 Adam Gross - https://www.asquaredozen.com - A Square Dozen</a></p></div></div></footer></div></body></html>