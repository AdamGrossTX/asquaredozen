<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Windows on A Square Dozen</title><link>https://www.asquaredozen.com/categories/windows/</link><description>Recent content in Windows on A Square Dozen</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Sun, 12 Dec 2021 00:00:00 +0000</lastBuildDate><atom:link href="https://www.asquaredozen.com/categories/windows/index.xml" rel="self" type="application/rss+xml"/><item><title>Remove Teams for Home from Windows 11</title><link>https://www.asquaredozen.com/2021/12/12/remove-teams-for-home-from-windows-11/</link><pubDate>Sun, 12 Dec 2021 00:00:00 +0000</pubDate><guid>https://www.asquaredozen.com/2021/12/12/remove-teams-for-home-from-windows-11/</guid><description>Have you ever looked at something and just wondered &amp;ldquo;What were they thinking&amp;rdquo;? This is the thought I have every time I log into a newly built Windows 11 Enterprise device and see the Teams for home and Chat apps loaded.
Anyone else feel like the dude in the glasses is mocking you as you fail to log in with your work account over and over?? So glad we can Chat and collaborate in one app!</description></item><item><title>Using the ConfigMgr AdminService to Retrieve BitLocker Recovery Keys and Triggering Key Rotation</title><link>https://www.asquaredozen.com/2021/11/17/using-the-configmgr-adminservice-to-retrieve-bitlocker-recovery-keys-and-triggering-key-rotation/</link><pubDate>Wed, 17 Nov 2021 00:00:00 +0000</pubDate><guid>https://www.asquaredozen.com/2021/11/17/using-the-configmgr-adminservice-to-retrieve-bitlocker-recovery-keys-and-triggering-key-rotation/</guid><description>The Key to Success is Knowledge Recently Garth Jones accused me of knowing something that I knew nothing about and I was very offended by that. So much so, that when Bryan Dam came to me demanding to know the keys to BitLocker keys in ConfigMgr, I decided I should figure it out. So I did. Here&amp;rsquo;s what I know now:
Keying in on the Issue When trying to automate processes around ConfigMgr, there are Ways to do things then there are Supported Ways to do things.</description></item><item><title>CMPivot Reference</title><link>https://www.asquaredozen.com/2021/11/14/cmpivot_reference/</link><pubDate>Sun, 14 Nov 2021 00:00:00 +0000</pubDate><guid>https://www.asquaredozen.com/2021/11/14/cmpivot_reference/</guid><description>The following examples were compiled from the CMPivot Home screen examples and the PowerShell equivalent commands were extracted from the CMPivot PowerShell script that is copied down locally to C:\Windows\CCM\ScriptStore. The goal is the provide a way to understand what each command is actually doing when you run it.
Interpreting this Reference Query Type
WMI - The command run locally on the client is querying WMI. Any entity not listed here but available in CMPivot uses the same WMI Class that ConfigMgr Client Hardware Inventory uses.</description></item><item><title>When VDI and ConfigMgr Co-Management Collide</title><link>https://www.asquaredozen.com/2021/11/13/when-vdi-and-configmgr-co-management-collide/</link><pubDate>Sat, 13 Nov 2021 04:12:00 +0000</pubDate><guid>https://www.asquaredozen.com/2021/11/13/when-vdi-and-configmgr-co-management-collide/</guid><description>Before we begin, here are some notes about persistent and non-persistent VDI that will likely give you nightmares:
Intune doesn&amp;rsquo;t support non-persistent VDI Azure Active Directory only supports Hybrid Azure AD Join for non-persistent VDI ConfigMgr recommends limiting client functionality on non-persistent VDI but there is no mention about the impact of Co-Management on these devices. Whatever you do, don&amp;rsquo;t Hybrid Join then Co-Manage your VDI Master Image or you&amp;rsquo;re in for a bad time!</description></item><item><title>Consulting</title><link>https://www.asquaredozen.com/consulting/</link><pubDate>Sun, 22 Aug 2021 00:00:00 +0000</pubDate><guid>https://www.asquaredozen.com/consulting/</guid><description>I work part time as a consultant with System Center Dudes. If you&amp;rsquo;d like to request my assistance with consulting work, please contact them directly at System Center Dudes. Tell them that Adam sent you :-).</description></item><item><title>Contact</title><link>https://www.asquaredozen.com/contact/</link><pubDate>Sun, 22 Aug 2021 00:00:00 +0000</pubDate><guid>https://www.asquaredozen.com/contact/</guid><description>If you need to contact me, please send me a DM on Twitter or shoot me an Email.</description></item><item><title>Using ConfigMgr Run Scripts and Microsoft Quick Assist to Repair a Broken Domain Trust Relationship</title><link>https://www.asquaredozen.com/2021/02/04/using-configmgr-run-scripts-and-microsoft-quick-assist-to-repair-a-broken-domain-trust-relationship/</link><pubDate>Thu, 04 Feb 2021 06:10:23 +0000</pubDate><guid>https://www.asquaredozen.com/2021/02/04/using-configmgr-run-scripts-and-microsoft-quick-assist-to-repair-a-broken-domain-trust-relationship/</guid><description>Recently one of our sites began having some issues with domain joined devices losing their trust relationship with Active Directory. While some users were able to log in with cached credentials, we had no easy way to get admin credentials to repair the domain trust. I’m going to show how Configmgr Run Scripts and Microsoft Quick Assist helped us get admin access to the devices to perform troubleshooting and remediation. The purpose of this post is to show how we can leverage various tools to solve challenging problems in production.</description></item><item><title>Autopilot Profile causes Device Rename after ConfigMgr OSD Task Sequence and Breaks AD Domain Trust</title><link>https://www.asquaredozen.com/2020/12/02/autopilot-profile-causes-device-rename-after-configmgr-osd-task-sequence-and-breaks-ad-domain-trust/</link><pubDate>Wed, 02 Dec 2020 22:54:15 +0000</pubDate><guid>https://www.asquaredozen.com/2020/12/02/autopilot-profile-causes-device-rename-after-configmgr-osd-task-sequence-and-breaks-ad-domain-trust/</guid><description>We got some new hardware models in this week and added drivers to our ConfigMgr OSD Task Sequence (with Windows 10 1909 serviced with November 2020 updates) to test. One of the devices kept ending up with a broken domain trust relationship when you attempt to log in immediately following build completion.
The security database on the server does not have a computer account for this workstation trust relationship One clue that we had was that something was renaming the device.</description></item><item><title>Windows 10 Feature Updates – Testing the /MigNEO Disable Parameter</title><link>https://www.asquaredozen.com/2020/09/13/windows-10-feature-updates-testing-the-migneo-disable-parameter/</link><pubDate>Sun, 13 Sep 2020 16:54:40 +0000</pubDate><guid>https://www.asquaredozen.com/2020/09/13/windows-10-feature-updates-testing-the-migneo-disable-parameter/</guid><description>Over the past few weeks I&amp;rsquo;ve been testing re-writing my Windows 10 Feature Update repo to make it easier to implement - if you haven&amp;rsquo;t tried it, go check it out. Just follow the readme in the repo https://github.com/AdamGrossTX/Windows10FeatureUpdates. During the re-write I was reminded that there were a few command line parameters that I hadn&amp;rsquo;t experimented with. One of them is /MigNEO which only has a Disable option. According to the product group, NEO stands for non-event objective which, doesn&amp;rsquo;t help it make more sense to me.</description></item><item><title>Analyze SetupDiag errors for Feature Updates in ConfigMgr 2008 Technical Preview</title><link>https://www.asquaredozen.com/2020/08/11/analyze-setupdiag-errors-for-feature-updates-in-configmgr-2008-technical-preview/</link><pubDate>Wed, 12 Aug 2020 04:03:21 +0000</pubDate><guid>https://www.asquaredozen.com/2020/08/11/analyze-setupdiag-errors-for-feature-updates-in-configmgr-2008-technical-preview/</guid><description>As soon as I read the release notes for ConfigMgr 2008 Technical Preview I knew I would be doing some digging. This release introduced the first iteration of a feature that will hopefully help make Windows 10 Feature Update servicing a little easier to manage. Listed as Analyze SetupDiag errors for feature updates this feature has been added to the Windows 10 Servicing dashboard. When I initially read the release notes and looked at the included graph, I was disappointed.</description></item><item><title>Lockdown Diary – Metered Internet Connections and Broken ConfigMgr Clients</title><link>https://www.asquaredozen.com/2020/05/22/lockdown-diary-metered-internet-connections-and-broken-configmgr-clients/</link><pubDate>Sat, 23 May 2020 04:49:05 +0000</pubDate><guid>https://www.asquaredozen.com/2020/05/22/lockdown-diary-metered-internet-connections-and-broken-configmgr-clients/</guid><description>Do you know how hard it is to find things when you don&amp;rsquo;t know what to search for??
I&amp;rsquo;m paranoid. We recently upgraded our site to ConfigMgr 2002, first fast ring, then the hotfix. We also installed a Cloud Management Gateway, re-worked our Boundary Groups to handle VPN better, added a second Management Point and generally made a butt-load of changes to our environment to help our remote clients have access to content more easily.</description></item><item><title>Lockdown Diary – My Always On VPN is Schrödinger’s Cat</title><link>https://www.asquaredozen.com/2020/05/12/lockdown-diary-my-always-on-vpn-is-schrodingers-cat/</link><pubDate>Wed, 13 May 2020 04:29:36 +0000</pubDate><guid>https://www.asquaredozen.com/2020/05/12/lockdown-diary-my-always-on-vpn-is-schrodingers-cat/</guid><description>When is your Always On VPN not Always On? An Always On VPN client uses a machine certificate to connect to the VPN gateway and connect to the network on startup. This feature is wonderful since it allows VPN clients to process machine group policies and even makes it easy for users with expired passwords to reset their passwords. But how can you verify that the machine channel is connected if you can&amp;rsquo;t see any indicators on the logon screen?</description></item><item><title>LockDown Diary – How I used DJOIN to Build Test Machines over VPN</title><link>https://www.asquaredozen.com/2020/05/05/lockdown-diary-how-i-used-djoin-to-build-test-machines-over-vpn/</link><pubDate>Wed, 06 May 2020 05:16:53 +0000</pubDate><guid>https://www.asquaredozen.com/2020/05/05/lockdown-diary-how-i-used-djoin-to-build-test-machines-over-vpn/</guid><description>It&amp;rsquo;s been a few months since I&amp;rsquo;ve sat down to put write something. I&amp;rsquo;ve been taking a break trying to pick up some woodworking skills and spend a bit more time with the family during this COVID-19 lockdown. On March 5, I left work to take a week off for Spring Break and never returned to the office. Today is May 5. I wasn&amp;rsquo;t prepared for being at home and since I don&amp;rsquo;t regularly work from home, I don&amp;rsquo;t have any hardware here other than a normal desk setup.</description></item><item><title>Gather No More – Using Dynamic Task Sequence Variables in ConfigMgr</title><link>https://www.asquaredozen.com/2020/02/20/gather-no-more-using-dynamic-task-sequence-variables-in-configmgr/</link><pubDate>Fri, 21 Feb 2020 02:15:17 +0000</pubDate><guid>https://www.asquaredozen.com/2020/02/20/gather-no-more-using-dynamic-task-sequence-variables-in-configmgr/</guid><description>Update 09/14/2020 - You can download the Gather Light Task Sequence from the Community Hub now! https://communityhub.microsoft.com/item/7812
Update 02/21/2020 - I added a new section with a Gather Task Sequence. Check out the DIY Gather in the Task Sequence section below. It even has a GIF (unlike Software Center!)
If you&amp;rsquo;ve used the Microsoft Deployment ToolKit (MDT) or ConfigMgr or have ever heard of &amp;lsquo;Johan and Mikael&amp;rsquo;, you&amp;rsquo;ve likely used or at least heard/read about using MDT and the Gather script that&amp;rsquo;s included with it as part of your Task Sequences.</description></item><item><title>Repairing Invalid Win32_UserProfile WMI Class on Windows 7 to 10 In-Place Upgraded Devices</title><link>https://www.asquaredozen.com/2020/01/19/repairing-invalid-win32-userprofile-wmi-class-on-windows-7-to-10-in-place-upgraded-devices/</link><pubDate>Sun, 19 Jan 2020 21:35:28 +0000</pubDate><guid>https://www.asquaredozen.com/2020/01/19/repairing-invalid-win32-userprofile-wmi-class-on-windows-7-to-10-in-place-upgraded-devices/</guid><description>I recently needed to query the Win32_UserProfile class in WMI for some reporting I was working on. This class is a default Hardware Inventory class in ConfigMgr. I noticed that we had a large number of devices were reporting NULL values for several properties in this class when I queried them in SQL so I decided to investigate. From the ConfigMgr console, I used CMPivot (only one of the best tools ever!</description></item><item><title>Convert ConfigMgr Error Codes to Plain Text Messages for Reporting – Part 3</title><link>https://www.asquaredozen.com/2019/11/25/convert-configmgr-error-codes-to-plain-text-messages-for-reporting-part-3/</link><pubDate>Tue, 26 Nov 2019 00:23:24 +0000</pubDate><guid>https://www.asquaredozen.com/2019/11/25/convert-configmgr-error-codes-to-plain-text-messages-for-reporting-part-3/</guid><description>I demoed this at MMS Jazz 2019 Tip and Tricks. This is Part 3 of a 3-part series. Part 1covers how to create a PowerShell script to lookup error messages. Part 2 covers creating an Azure Function.
My goal is to use ConfigMgr ErrorCodes in a report in Power BI for easier deployment monitoring. As I mentioned in Part 1, the error text isn&amp;rsquo;t available in the ConfigMgr DB, so I created a PowerShell script to look up the error code.</description></item><item><title>Windows 10 Feature Updates – The Challenge of Servicing in the Enterprise</title><link>https://www.asquaredozen.com/2019/10/05/windows-10-feature-updates-the-challenge-of-servicing-in-the-enterprise/</link><pubDate>Sat, 05 Oct 2019 15:09:39 +0000</pubDate><guid>https://www.asquaredozen.com/2019/10/05/windows-10-feature-updates-the-challenge-of-servicing-in-the-enterprise/</guid><description>I hope I never have to build another Task Sequence again. Seriously. Wouldn&amp;rsquo;t that be nice? I know that&amp;rsquo;s not truly feasible, but can&amp;rsquo;t a guy dream? It&amp;rsquo;s not that I dislike Task Sequences, it&amp;rsquo;s just that I strongly believe that Modern Desktop Management (AutoPilot/Device Reset/Feature Update servicing/etc.) is going to continue to improve and we should continue to attempt to adopt these tools with as much effort as we spend on customizing Task Sequences.</description></item><item><title>Windows 10 Feature Updates – Using Custom Action Scripts</title><link>https://www.asquaredozen.com/2019/08/25/windows-10-feature-updates-using-custom-action-scripts/</link><pubDate>Mon, 26 Aug 2019 05:28:32 +0000</pubDate><guid>https://www.asquaredozen.com/2019/08/25/windows-10-feature-updates-using-custom-action-scripts/</guid><description>This is the next installment in my Windows 10 Feature Updates series.
Custom Actions Beginning in Windows 10 1803, custom actions were introduced and represent what Suma SaganeGowda referred to as a &amp;lsquo;poor man&amp;rsquo;s implementation of Task Sequences&amp;rsquo; at Ignite 2018 in session BRK3027. Windows setup will check for the existence of these special folders and scripts and use them as part of the Feature Update process. They allow you to run scripts at various stages in the Feature Update process as well as specify reflected driver paths just as you can in Setupconfig.</description></item><item><title>Windows 10 Feature Updates – Using Setupconfig.ini to Manage Feature Updates in the Enterprise</title><link>https://www.asquaredozen.com/2019/08/25/windows-10-feature-updates-using-setupconfig-ini-to-manage-feature-updates-in-the-enterprise/</link><pubDate>Mon, 26 Aug 2019 00:24:25 +0000</pubDate><guid>https://www.asquaredozen.com/2019/08/25/windows-10-feature-updates-using-setupconfig-ini-to-manage-feature-updates-in-the-enterprise/</guid><description>This is the next installment in my Windows 10 Feature Updates series.
Setupconfig.ini Setupconfig.ini is a file that can be used to pass command line arguments to the Windows Setup engine during a Windows installation. When Setupconfig.ini is specified in the command line (/ConfigFile &amp;lt;path to Setupconfig.ini&amp;gt;) or exists in the default location (%systemdrive%\Users\Default\AppData\Local\Microsoft\Windows\WSUS\Setupconfig.ini), any arguments in it will take precedence over arguments specified in the commandline. If you use this file, ensure that you aren&amp;rsquo;t counteracting commandline args that you may be using with other deployment methods such as Task Sequences (Task Sequences simply generate a command line based on which options you select).</description></item><item><title>Windows 10 Feature Updates – Leveraging SetupDiag for Better Reporting</title><link>https://www.asquaredozen.com/2019/08/22/windows-10-feature-updates-leveraging-setupdiag-for-better-reporting/</link><pubDate>Fri, 23 Aug 2019 05:57:11 +0000</pubDate><guid>https://www.asquaredozen.com/2019/08/22/windows-10-feature-updates-leveraging-setupdiag-for-better-reporting/</guid><description>This is the first post of my Windows 10 Feature Updates series, probably totally out of sequence, but I just need to start getting the pieces written and published. So here goes.
What is SetupDiag If you have worked with Windows 10 Operating System Deployments for any amount of time, you&amp;rsquo;ve likely had failures and encountered cryptic messages that you needed to triage. Hopefully you&amp;rsquo;ve come across SetupDiag. For the uninitiated, SetupDiag is a fancy little tool from Microsoft that you can run against the Windows installation logs (Panther Logs) either directly on a client or against an offline copy of the Panther logs from another client.</description></item><item><title>How to Use Profiles in Microsoft’s Chromium Edge for Managing Multiple Accounts in Azure, Teams and More</title><link>https://www.asquaredozen.com/2019/08/15/how-to-use-profiles-in-microsofts-chromium-edge-for-managing-multiple-accounts-in-azure-teams-and-more/</link><pubDate>Thu, 15 Aug 2019 06:01:54 +0000</pubDate><guid>https://www.asquaredozen.com/2019/08/15/how-to-use-profiles-in-microsofts-chromium-edge-for-managing-multiple-accounts-in-azure-teams-and-more/</guid><description>I&amp;rsquo;ve never been a fan of alternate web browsers (Chrome, Firefox, etc), not because I don&amp;rsquo;t believe they may have better features than Internet Explorer or Edge, but because I live in the End User Computing space and find it easier to support users if I use the same browsers that they do. Even at home, I keep it simple and just use Edge or IE to help reduce my frustration of having different features depending on where I may be logged in each day.</description></item><item><title>How to Identify Repeated SCCM Client Inventory Failures Using SQL</title><link>https://www.asquaredozen.com/2019/07/17/how-to-identify-repeated-sccm-client-inventory-failures-using/</link><pubDate>Wed, 17 Jul 2019 22:49:56 +0000</pubDate><guid>https://www.asquaredozen.com/2019/07/17/how-to-identify-repeated-sccm-client-inventory-failures-using/</guid><description>For the past few weeks I&amp;rsquo;ve been chasing some issues in my production ConfigMgr environment related to Windows 7 to Windows 10 upgrades and Windows 10 Feature Updates and SCCM Hardware Inventory. During that process, I found that several of my clients had successfully been upgraded, but were still reporting the old OS version in the ConfigMgr console. My search led to several root causes which I&amp;rsquo;m still working through, but the solution in most cases was to force a Full Hardware Inventory on the client or fully uninstall, clean and reinstall the client - I also won&amp;rsquo;t go into those steps here.</description></item><item><title>ConfigMgr 1906 Technical Preview – Testing CMPivot over CMG using AdminService</title><link>https://www.asquaredozen.com/2019/06/18/configmgr-1906-technical-preview-testing-cmpivot-over-cmg-using-adminservice/</link><pubDate>Wed, 19 Jun 2019 02:50:33 +0000</pubDate><guid>https://www.asquaredozen.com/2019/06/18/configmgr-1906-technical-preview-testing-cmpivot-over-cmg-using-adminservice/</guid><description>ConfigMgr 1906 Technical Preview was released last week and I immediately upgraded one of my tech preview labs I have running in Hyper-V on my laptop. As you may know, I&amp;rsquo;m a huge fan of the new AdminService functionality which will allow you to interact with the SMS Provider over HTTPS. With each release, it has had more features added. With Tech preview 1906, I noticed that you can run CMPivot using the AdminService.</description></item><item><title>Building a Smarter Task Sequence</title><link>https://www.asquaredozen.com/2019/04/30/building-a-smarter-task-sequence/</link><pubDate>Tue, 30 Apr 2019 06:41:33 +0000</pubDate><guid>https://www.asquaredozen.com/2019/04/30/building-a-smarter-task-sequence/</guid><description>I&amp;rsquo;m procrastinating prepping my sessions for MMS 2019 and decided I should write a blog post instead to help get me motivated. A few weeks ago I tweeted that my task sequence is built to be re-run if it fails and it will &amp;lsquo;pick up where it left off&amp;rsquo;. Several folks expressed interest in the idea so I wanted to share the general framework for having a task sequence that can be re-run after failure to complete the job.</description></item><item><title>Building An Even Better Task Sequence</title><link>https://www.asquaredozen.com/2018/12/14/building-an-even-better-task-sequence/</link><pubDate>Fri, 14 Dec 2018 08:09:31 +0000</pubDate><guid>https://www.asquaredozen.com/2018/12/14/building-an-even-better-task-sequence/</guid><description>Note
03/12/2019 - This post has been updated to support changes in 1901 TP and (I assume) 1902 CB to the TSProgressUI.exe ConfigMgr client component used for the custom described dialog below.
Note: You must be running ConfigMgr/SCCM 1810 or higher to use the _SMSTSLastActionName variable included in this post. However you can use the same concepts and error dialog with previous versions (but seriously, upgrade already!). Also, go upvote the UserVoice item to have the product do this natively.</description></item><item><title>Making Continue on PC Work with Microsoft Windows Consumer Features Disabled in Windows 10</title><link>https://www.asquaredozen.com/2018/12/03/making-continue-on-pc-work-with-microsoft-windows-consumer-features-disabled-in-windows-10/</link><pubDate>Mon, 03 Dec 2018 23:31:20 +0000</pubDate><guid>https://www.asquaredozen.com/2018/12/03/making-continue-on-pc-work-with-microsoft-windows-consumer-features-disabled-in-windows-10/</guid><description>I recently had a request to make the Continue on PC feature work on our standard Windows 10 devices. Continue on PC is a Windows 10 feature that allows users to use the Edge browser on their phone then continue the browsing session on their PC. As I started testing the feature in Windows 10, I found that the setting was disabled with the message
Some settings are hidden or managed by your organization.</description></item><item><title>Debugging SCCM/ConfigMgr Task Sequences on the Fly</title><link>https://www.asquaredozen.com/2018/10/03/debugging-sccm-configmgr-task-sequences-on-the-fly/</link><pubDate>Wed, 03 Oct 2018 16:11:08 +0000</pubDate><guid>https://www.asquaredozen.com/2018/10/03/debugging-sccm-configmgr-task-sequences-on-the-fly/</guid><description>If you have worked with SCCM/ConfigMgr Task Sequences for any length of time, you&amp;rsquo;ve likely needed to debug them. Many times, you need to check the value of a Task Sequence variable. The generally accepted approach is to add a Run Command Line step to your Task Sequence and run ServiceUI.exe like this:
ServiceUI.exe -process:TSProgressUI.exe cmd.exe
This approach is great if you planned ahead and you are in a test Task Sequence.</description></item><item><title>Configuring 802.1x Authentication for Windows Deployment – Part 5 – Dynamic Whitelisting using the Cisco ISE External RESTful Service</title><link>https://www.asquaredozen.com/2018/09/29/configuring-802-1x-authentication-for-windows-deployment-part-5-dynamic-whitelisting-using-the-cisco-ise-external-restful-service/</link><pubDate>Sat, 29 Sep 2018 07:00:27 +0000</pubDate><guid>https://www.asquaredozen.com/2018/09/29/configuring-802-1x-authentication-for-windows-deployment-part-5-dynamic-whitelisting-using-the-cisco-ise-external-restful-service/</guid><description>This is Part 5 in my Configuring 802.1x Authentication for Windows Deployment series. Be sure to check out all of the other parts.
A few months ago, when I published the first 4 parts on this series, I was unaware that there was a web service available for managing Cisco ISE, which is the NAC that I have to work with in my environment. I was fortunate to meet with a peer who works nearby and he shared a script demonstrating how to interact with the Cisco ISE External RESTful Service (ERS) to dynamically whitelist devices when WinPE starts for Bare Metal OSD and inside an SCCM/ConfigMgr Task Sequence for In-Place upgrades.</description></item><item><title>Adding Dynamic Updates to Windows 10 In-Place Upgrade Media During Offline Servicing</title><link>https://www.asquaredozen.com/2018/08/20/adding-dynamic-updates-to-windows-10-in-place-upgrade-media-during-offline-servicing/</link><pubDate>Mon, 20 Aug 2018 06:14:08 +0000</pubDate><guid>https://www.asquaredozen.com/2018/08/20/adding-dynamic-updates-to-windows-10-in-place-upgrade-media-during-offline-servicing/</guid><description>For the past few months, there has been a community-wide push to determine the optimal approach for Offline Servicing Windows 10 media and to get Microsoft to take on more of this burden so we can get on with other tasks instead of dealing with servicing every month. Ultimately, Microsoft needs a better process for updating media each month, but until they do, all we can do is what we do best, Socially Engineer solutions.</description></item><item><title>Failed to decrypt state encryption key (0x80070057) – Can't get StateEncryptDecryptKey property error in SCCM/ConfigMgr User State Migration Console</title><link>https://www.asquaredozen.com/2018/08/09/failed-to-decrypt-state-encryption-key-0x80070057-cant-get-stateencryptdecryptkey-property-error-in-sccm-configmgr-user-state-migration-console/</link><pubDate>Fri, 10 Aug 2018 04:14:35 +0000</pubDate><guid>https://www.asquaredozen.com/2018/08/09/failed-to-decrypt-state-encryption-key-0x80070057-cant-get-stateencryptdecryptkey-property-error-in-sccm-configmgr-user-state-migration-console/</guid><description>I found this issue today and hope to get some help from the ConfigMgr team on it but figured it was worth writing up the workaround for now.
The Issue While attempting to perform a user state backup on a machine using an SCCM task sequence, we received the error in SMSTS.LOG:
Failed to decrypt state encryption key (0x80070057) Failed to run the action: Request User State Storage. The parameter is incorrect.</description></item><item><title>Configuring 802.1x Authentication for Windows Deployment</title><link>https://www.asquaredozen.com/2018/07/29/configuring-802-1x-authentication-for-windows-deployment/</link><pubDate>Mon, 30 Jul 2018 05:13:30 +0000</pubDate><guid>https://www.asquaredozen.com/2018/07/29/configuring-802-1x-authentication-for-windows-deployment/</guid><description>Update 10/1/2018 - Check out my latest post Part 5 below. You may be able to skip all of the other stuff!!
The Links first so you don&amp;rsquo;t have to scroll so far. These are also on the menu at top for easy access. Since I ended up with so much content for this topic, I felt that it warranted a landing page. Hopefully you will be able to easily navigate through these topics and find some useful nuggets to save yourself some headaches down the road.</description></item><item><title>Configuring 802.1x Authentication for Windows Deployment – Tips and Tricks</title><link>https://www.asquaredozen.com/2018/07/29/configuring-802-1x-authentication-for-windows-deployment-tips-and-tricks/</link><pubDate>Mon, 30 Jul 2018 04:54:30 +0000</pubDate><guid>https://www.asquaredozen.com/2018/07/29/configuring-802-1x-authentication-for-windows-deployment-tips-and-tricks/</guid><description>This is the Tips and Tricks section of my Configuring 802.1x Authentication for Windows Deployment series. Be sure to check out all of the other parts here.
These are just some random things I found while going through this.
File and Registry Locations Profiles
C:\ProgramData\Microsoft\dot3svc\Profiles HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\dot3svc
Policies
C:\Windows\dot3svc\Policies*.TMP (rename TMP to XML to see the Policy and Profile) HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WiredL2\GP_Policy
Migration Data C:\ProgramData\Microsoft\dot3svc\MigrationData HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\dot3svc\MigrationData
Quickly Remove 802.1x Group Policy for Testing Rename the .</description></item><item><title>Configuring 802.1x Authentication for Windows Deployment – Part 4 – Integrating 802.1x Authentication into an In-Place Upgrade Task Sequence</title><link>https://www.asquaredozen.com/2018/07/29/configuring-802-1x-authentication-for-windows-deployment-part-4-integrating-802-1x-authentication-into-an-in-place-upgrade-task-sequence/</link><pubDate>Mon, 30 Jul 2018 04:10:44 +0000</pubDate><guid>https://www.asquaredozen.com/2018/07/29/configuring-802-1x-authentication-for-windows-deployment-part-4-integrating-802-1x-authentication-into-an-in-place-upgrade-task-sequence/</guid><description>This is Part 4 in my Configuring 802.1x Authentication for Windows Deployment series. Be sure to check out all of the other parts here.
Quick Note About Cisco Switch Firmware If you&amp;rsquo;ve made it this far, a word of caution. Make sure that your switch firmware is matched to the version required by ISE. I spent several weeks working with our Security and Networking guys to troubleshoot and discovered that our switches weren&amp;rsquo;t at the required version for ISE 2.</description></item><item><title>Configuring 802.1x Authentication for Windows Deployment – Part 3 – Integrating 802.1x Authentication into a Bare Metal Task Sequence</title><link>https://www.asquaredozen.com/2018/07/29/configuring-802-1x-authentication-for-windows-deployment-part-3-integrating-802-1x-authentication-into-a-bare-metal-task-sequence/</link><pubDate>Mon, 30 Jul 2018 02:31:16 +0000</pubDate><guid>https://www.asquaredozen.com/2018/07/29/configuring-802-1x-authentication-for-windows-deployment-part-3-integrating-802-1x-authentication-into-a-bare-metal-task-sequence/</guid><description>This is Part 3 in my Configuring 802.1x Authentication for Windows Deployment series. Be sure to check out all of the other parts here.
You will need all of the files you created in Part 1 for this part.
During a Bare Metal/Wipe &amp;amp; Load OSD Task Sequence, the Task Sequence will start in WinPE and copy down the OS installation files. Once Windows as been installed, the Task Sequence will boot out of WinPE and into the new OS.</description></item><item><title>Configuring 802.1x Authentication for Windows Deployment – Part 2 – Building an 802.1x Enabled WinPE Boot Image</title><link>https://www.asquaredozen.com/2018/07/29/configuring-802-1x-authentication-for-windows-deployment-part-2-building-an-802-1x-enabled-winpe-boot-image/</link><pubDate>Mon, 30 Jul 2018 02:17:55 +0000</pubDate><guid>https://www.asquaredozen.com/2018/07/29/configuring-802-1x-authentication-for-windows-deployment-part-2-building-an-802-1x-enabled-winpe-boot-image/</guid><description>This is Part 2 in my Configuring 802.1x Authentication for Windows Deployment series. Be sure to check out all of the other parts here.
Note: I don&amp;rsquo;t have 802.1x setup in a lab to show how to configure the 802.1x service on the server side. However, I do know that you will need to configure your 802.1x service to allow PXE traffic. I believe that Cisco ISE has a setting already that you can just turn on to allow it.</description></item><item><title>Configuring 802.1x Authentication for Windows Deployment – Part 1 – Building an 802.1x Computer Authentication Script</title><link>https://www.asquaredozen.com/2018/07/29/configuring-802-1x-authentication-for-windows-deployment-part-1-building-an-802-1x-computer-authentication-script/</link><pubDate>Mon, 30 Jul 2018 02:07:10 +0000</pubDate><guid>https://www.asquaredozen.com/2018/07/29/configuring-802-1x-authentication-for-windows-deployment-part-1-building-an-802-1x-computer-authentication-script/</guid><description>This is Part 1 in my Configuring 802.1x Authentication for Windows Deployment series. Be sure to check out all of the other parts here.
The Anatomy of an 802.1x Configuration Script These are the basic steps need to be performed by your auth script. The code below is commented to help understand what each step is for.
Set Wired Autoconfig (dot3svc) service startup to Auto Start Wired Autoconfig Import Configuration Profile Import Certificates Force adapter authentication event You may be looking at this and wonder why I&amp;rsquo;m creating a Batch file instead of using PowerShell.</description></item><item><title>Enabling Dynamic Update AND Ignoring Dissmissable Compatibility Warnings during an Windows 10 In-Place Upgrade Task Sequence in ConfigMgr</title><link>https://www.asquaredozen.com/2018/07/18/enabling-dynamic-update-and-ignoring-dissmissable-compatibility-warnings-during-an-windows-10-in-place-upgrade-task-sequence-in-configmgr/</link><pubDate>Wed, 18 Jul 2018 13:49:32 +0000</pubDate><guid>https://www.asquaredozen.com/2018/07/18/enabling-dynamic-update-and-ignoring-dissmissable-compatibility-warnings-during-an-windows-10-in-place-upgrade-task-sequence-in-configmgr/</guid><description>WARNING!! 8/21/2018 - The following steps will enable Dynamic Updates for Windows 10 In-Place Upgrade. If you have not serviced your WIM with THE LATEST Cumulative updates - like today is patch Tuesday and you haven&amp;rsquo;t updated your WIM with today&amp;rsquo;s CU, proceed with caution! Your Enabling Dynamic Updates will allow your clients to go to the internet and download the latest Cumulative Update and install it during the upgrade. This is an extra ~800 MB per client from the internet.</description></item><item><title>Enabling Dynamic Updates and Servicing Drivers from Microsoft Update during a Windows 10 In-Place Upgrade Task Sequence in ConfigMgr</title><link>https://www.asquaredozen.com/2018/07/18/enabling-dynamic-updates-and-servicing-drivers-from-microsoft-update-during-a-windows-10-in-place-upgrade-task-sequence-in-configmgr/</link><pubDate>Wed, 18 Jul 2018 06:30:04 +0000</pubDate><guid>https://www.asquaredozen.com/2018/07/18/enabling-dynamic-updates-and-servicing-drivers-from-microsoft-update-during-a-windows-10-in-place-upgrade-task-sequence-in-configmgr/</guid><description>UPDATE - See Part 2 Here
WARNING!! 8/21/2018 - The following steps will enable Dynamic Updates for Windows 10 In-Place Upgrade. If you have not serviced your WIM with THE LATEST Cumulative updates - like today is patch Tuesday and you haven&amp;rsquo;t updated your WIM with today&amp;rsquo;s CU, proceed with caution! Your Enabling Dynamic Updates will allow your clients to go to the internet and download the latest Cumulative Update and install it during the upgrade.</description></item><item><title>Clearing Local Group Policies during an Windows 7 to 10 In-Place Upgrade Task Sequence</title><link>https://www.asquaredozen.com/2018/07/16/clearing-local-group-policies-during-an-windows-7-to-10-in-place-upgrade-task-sequence/</link><pubDate>Mon, 16 Jul 2018 07:00:12 +0000</pubDate><guid>https://www.asquaredozen.com/2018/07/16/clearing-local-group-policies-during-an-windows-7-to-10-in-place-upgrade-task-sequence/</guid><description>Our Windows 7 Reference Image was originally built in 2011. At the time, we had some consultants in helping us migrate from Windows XP to Windows 7. At the time, the consultant who was building the image edited the Local Group Polices on the Windows 7 machine prior to capturing it. Since then, we&amp;rsquo;ve continued to service the WIM and use it as our production image. Some years later, we were trying to change our Windows Update settings and found these nice Local Group Policies just sitting there screwing everything up!</description></item><item><title>Dynamically Updating Unattend.XML during an OSD Task Sequence using MDT Variables and ZTI Scripts.</title><link>https://www.asquaredozen.com/2018/07/11/dynamically-updating-unattend-xml-during-an-osd-task-sequence-using-mdt-variables-and-zti-scripts/</link><pubDate>Wed, 11 Jul 2018 21:25:48 +0000</pubDate><guid>https://www.asquaredozen.com/2018/07/11/dynamically-updating-unattend-xml-during-an-osd-task-sequence-using-mdt-variables-and-zti-scripts/</guid><description>While trying to set the KeyboardLocale in my ConfigMgr/SCCM Task Sequence, I found that my settings weren&amp;rsquo;t getting updated during the Task Sequence. I used to think that custom Unattend.XML that you include in your Task Sequence would be used as-is. I was wrong. I did a bit of digging and here&amp;rsquo;s what I discovered.
FYI: I&amp;rsquo;m using ConfigMgr/SCCM with MDT integrated and I&amp;rsquo;m using an MDT Task Sequence built in ConfigMgr as the basis for this discussion.</description></item><item><title>Triggering ConfigMgr Client Actions from a Task Sequence</title><link>https://www.asquaredozen.com/2018/06/14/triggering-configmgr-client-actions-from-a-task-sequence/</link><pubDate>Fri, 15 Jun 2018 04:20:56 +0000</pubDate><guid>https://www.asquaredozen.com/2018/06/14/triggering-configmgr-client-actions-from-a-task-sequence/</guid><description>This week, we were working on testing Windows 7 to Windows 10 In-Place Upgrades and ran into an issue where our clients weren&amp;rsquo;t updating their Operating System version in the ConfigMgr console. After some helpful responses on Twitter, I was able to add a client action trigger step to the end of my Task Sequence. In my production environment, we have a child task sequence that we call that has several client action steps in it including Request Machine Assignments (Machine Policies) {00000000-0000-0000-0000-000000000021}, Hardware Inventory {00000000-0000-0000-0000-000000000001} and now a Discovery Inventory {00000000-0000-0000-0000-000000000003}.</description></item><item><title>Windows 10 1709 In-Place Upgrade Hangs on Making sure you're ready to install</title><link>https://www.asquaredozen.com/2018/05/21/windows-10-1709-in-place-upgrade-hangs-on-making-sure-youre-ready-to-install/</link><pubDate>Mon, 21 May 2018 19:34:37 +0000</pubDate><guid>https://www.asquaredozen.com/2018/05/21/windows-10-1709-in-place-upgrade-hangs-on-making-sure-youre-ready-to-install/</guid><description>UPDATE #3 - 6/28/2018 Feel free to read below, however, if you want the quick solution, check out Marc&amp;rsquo;s updated blog post. He&amp;rsquo;s put together a simple solution to this issue.
http://blog.ctglobalservices.com/configuration-manager-sccm/mag/devicemap-and-device-inventory-failures-in-win7-to-win10-1709-in-place-upgrades/
UPDATE #2 - 5/24/2018 After posting this, I came across these https://twitter.com/jarwidmark/status/998591545392685057 and http://blog.ctglobalservices.com/configuration-manager-sccm/mag/devicemap-and-device-inventory-failures-in-win7-to-win10-1709-in-place-upgrades/ which indicated that the fix was to update the devinv.dll file in Sources directory of your Windows 10 Upgrade media. This led me to finding out that KB2952664 updates devinv.</description></item><item><title>WinPE Image fails to load on HP Proliant Gen9 servers using ADK 1709</title><link>https://www.asquaredozen.com/2018/01/27/winpe-image-fails-load-hp-proliant-gen9-servers-using-adk-1709/</link><pubDate>Sun, 28 Jan 2018 02:15:45 +0000</pubDate><guid>https://www.asquaredozen.com/2018/01/27/winpe-image-fails-load-hp-proliant-gen9-servers-using-adk-1709/</guid><description>We have several generations of HP ProLiant servers in our environment. We recently upgraded SCCM to 1710 then applied ADK 1709. We have been imaging these servers using the ADK 1703 Boot Image without issue. After upgrading to ADK 1709 and creating new boot images, we are unable to boot to into WinPE on any of our Gen9 servers. After doing the standard diagnostics (testing old, testing new, updating drivers, updating firmware, etc) we found that these servers would still freeze after downloading the boot WIM and get stuck on this screen:</description></item><item><title>Modern Driver Management and How I Barely Got It Working – Some Lessons Learned</title><link>https://www.asquaredozen.com/2018/01/16/modern-driver-management-barely-got-working-lessons-learned/</link><pubDate>Wed, 17 Jan 2018 03:57:44 +0000</pubDate><guid>https://www.asquaredozen.com/2018/01/16/modern-driver-management-barely-got-working-lessons-learned/</guid><description>Several months ago, my boss came back from Microsoft Ignite where he &amp;lsquo;drank the Kool-Aid&amp;rsquo; big time. We had been telling him about all of the amazing things that were being released to help with the move to Modern Windows Management with Windows 10 for months but he got to hear it directly from some of the experts and got really excited. One of the things he suggested looking into came from a session with Mike Nystrom and Johan Arwidmark called Expert-level Windows 10 deployment (Skip to 50:12 for driver management).</description></item><item><title>Windows 7 to Windows 10 Fall Creators Update (1709) In-Place Upgrade Fails with error 0xC1900204 (Invalid Sku)</title><link>https://www.asquaredozen.com/2018/01/16/windows-7-windows-10-fall-creators-update-1709-place-upgrade-fails-error-0xc1900204-invalid-sku/</link><pubDate>Tue, 16 Jan 2018 19:07:19 +0000</pubDate><guid>https://www.asquaredozen.com/2018/01/16/windows-7-windows-10-fall-creators-update-1709-place-upgrade-fails-error-0xc1900204-invalid-sku/</guid><description>We have built an SCCM In-Place upgrade task sequence to migrate our enterprise from Windows 7 Enterprise to Windows 10 Enterprise. We have been using the same basic TS for over a year without issues. With the release of Windows 10 Fall Creators Update (1709), we began having issues upgrading certain devices and were seeing error code 0xC1900204, indicating Invalid SKU.
Windows setup looks at the existing OS, install media and the command line image number to validate that the existing and desired versions are a match and can be upgraded.</description></item><item><title>Hello World!</title><link>https://www.asquaredozen.com/2018/01/16/hello-world/</link><pubDate>Tue, 16 Jan 2018 06:26:11 +0000</pubDate><guid>https://www.asquaredozen.com/2018/01/16/hello-world/</guid><description>I guess that&amp;rsquo;s how I&amp;rsquo;m supposed to start out.
If you want to know more about me or my site name, please visit the About page before proceeding. I&amp;rsquo;ll wait.
Welcome back! As you can see, I&amp;rsquo;m not an expert, but I have been doing this for a while and just wanted to have a place to call my own where I can post with more than characters on Twitter. I hope that I will be able to add value to the community.</description></item></channel></rss>