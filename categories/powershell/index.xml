<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>PowerShell on A Square Dozen</title><link>https://www.asquaredozen.com/categories/powershell/</link><description>Recent content in PowerShell on A Square Dozen</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Wed, 17 Nov 2021 00:00:00 +0000</lastBuildDate><atom:link href="https://www.asquaredozen.com/categories/powershell/index.xml" rel="self" type="application/rss+xml"/><item><title>Using the ConfigMgr AdminService to Retrieve BitLocker Recovery Keys and Triggering Key Rotation</title><link>https://www.asquaredozen.com/2021/11/17/using-the-configmgr-adminservice-to-retrieve-bitlocker-recovery-keys-and-triggering-key-rotation/</link><pubDate>Wed, 17 Nov 2021 00:00:00 +0000</pubDate><guid>https://www.asquaredozen.com/2021/11/17/using-the-configmgr-adminservice-to-retrieve-bitlocker-recovery-keys-and-triggering-key-rotation/</guid><description>The Key to Success is Knowledge Recently Garth Jones accused me of knowing something that I knew nothing about and I was very offended by that. So much so, that when Bryan Dam came to me demanding to know the keys to BitLocker keys in ConfigMgr, I decided I should figure it out. So I did. Here&amp;rsquo;s what I know now:
Keying in on the Issue When trying to automate processes around ConfigMgr, there are Ways to do things then there are Supported Ways to do things.</description></item><item><title>CMPivot Reference</title><link>https://www.asquaredozen.com/2021/11/14/cmpivot_reference/</link><pubDate>Sun, 14 Nov 2021 00:00:00 +0000</pubDate><guid>https://www.asquaredozen.com/2021/11/14/cmpivot_reference/</guid><description>The following examples were compiled from the CMPivot Home screen examples and the PowerShell equivalent commands were extracted from the CMPivot PowerShell script that is copied down locally to C:\Windows\CCM\ScriptStore. The goal is the provide a way to understand what each command is actually doing when you run it.
Interpreting this Reference Query Type
WMI - The command run locally on the client is querying WMI. Any entity not listed here but available in CMPivot uses the same WMI Class that ConfigMgr Client Hardware Inventory uses.</description></item><item><title>When VDI and ConfigMgr Co-Management Collide</title><link>https://www.asquaredozen.com/2021/11/13/when-vdi-and-configmgr-co-management-collide/</link><pubDate>Sat, 13 Nov 2021 04:12:00 +0000</pubDate><guid>https://www.asquaredozen.com/2021/11/13/when-vdi-and-configmgr-co-management-collide/</guid><description>Before we begin, here are some notes about persistent and non-persistent VDI that will likely give you nightmares:
Intune doesn&amp;rsquo;t support non-persistent VDI Azure Active Directory only supports Hybrid Azure AD Join for non-persistent VDI ConfigMgr recommends limiting client functionality on non-persistent VDI but there is no mention about the impact of Co-Management on these devices. Whatever you do, don&amp;rsquo;t Hybrid Join then Co-Manage your VDI Master Image or you&amp;rsquo;re in for a bad time!</description></item><item><title>Using ConfigMgr Run Scripts and Microsoft Quick Assist to Repair a Broken Domain Trust Relationship</title><link>https://www.asquaredozen.com/2021/02/04/using-configmgr-run-scripts-and-microsoft-quick-assist-to-repair-a-broken-domain-trust-relationship/</link><pubDate>Thu, 04 Feb 2021 06:10:23 +0000</pubDate><guid>https://www.asquaredozen.com/2021/02/04/using-configmgr-run-scripts-and-microsoft-quick-assist-to-repair-a-broken-domain-trust-relationship/</guid><description>Recently one of our sites began having some issues with domain joined devices losing their trust relationship with Active Directory. While some users were able to log in with cached credentials, we had no easy way to get admin credentials to repair the domain trust. I’m going to show how Configmgr Run Scripts and Microsoft Quick Assist helped us get admin access to the devices to perform troubleshooting and remediation. The purpose of this post is to show how we can leverage various tools to solve challenging problems in production.</description></item><item><title>Analyze SetupDiag errors for Feature Updates in ConfigMgr 2008 Technical Preview</title><link>https://www.asquaredozen.com/2020/08/11/analyze-setupdiag-errors-for-feature-updates-in-configmgr-2008-technical-preview/</link><pubDate>Wed, 12 Aug 2020 04:03:21 +0000</pubDate><guid>https://www.asquaredozen.com/2020/08/11/analyze-setupdiag-errors-for-feature-updates-in-configmgr-2008-technical-preview/</guid><description>As soon as I read the release notes for ConfigMgr 2008 Technical Preview I knew I would be doing some digging. This release introduced the first iteration of a feature that will hopefully help make Windows 10 Feature Update servicing a little easier to manage. Listed as Analyze SetupDiag errors for feature updates this feature has been added to the Windows 10 Servicing dashboard. When I initially read the release notes and looked at the included graph, I was disappointed.</description></item><item><title>Remove Windows 10 In-Box Apps with ConfigMgr or Intune and the Microsoft Store for Business</title><link>https://www.asquaredozen.com/2020/08/06/remove-windows-10-in-box-apps-with-configmgr-or-intune-and-the-microsoft-store-for-business/</link><pubDate>Thu, 06 Aug 2020 07:31:52 +0000</pubDate><guid>https://www.asquaredozen.com/2020/08/06/remove-windows-10-in-box-apps-with-configmgr-or-intune-and-the-microsoft-store-for-business/</guid><description>If you&amp;rsquo;ve been managing Windows 10 for very long, you&amp;rsquo;ve likely implemented a script or other method to remove some of the In-Box apps that come with Windows 10. We have been using a customized version of a script that Michael Niehaus published in 2015. It uses PowerShell and an XML file with a list of apps to be removed. I have integrated it into my Windows 10 offline servicing script that I use to apply updates to my image each month.</description></item><item><title>Demystifying Windows 10 Feature Update Blocks</title><link>https://www.asquaredozen.com/2020/07/26/demystifying-windows-10-feature-update-blocks/</link><pubDate>Mon, 27 Jul 2020 04:00:36 +0000</pubDate><guid>https://www.asquaredozen.com/2020/07/26/demystifying-windows-10-feature-update-blocks/</guid><description>Disclaimer - if you manually bypass Feature Update blocks, you risk causing issues with your device. The blocks exist for a reason and should be respected. This information is provided for educational purposes only. Proceed with caution.
Windows 10 Feature Updates are released twice per year. For each release, Microsoft has the ability to block the update from being installed or even showing up in Widows Update for applications/drivers/devices that have known compatibility issues.</description></item><item><title>Lockdown Diary – Metered Internet Connections and Broken ConfigMgr Clients</title><link>https://www.asquaredozen.com/2020/05/22/lockdown-diary-metered-internet-connections-and-broken-configmgr-clients/</link><pubDate>Sat, 23 May 2020 04:49:05 +0000</pubDate><guid>https://www.asquaredozen.com/2020/05/22/lockdown-diary-metered-internet-connections-and-broken-configmgr-clients/</guid><description>Do you know how hard it is to find things when you don&amp;rsquo;t know what to search for??
I&amp;rsquo;m paranoid. We recently upgraded our site to ConfigMgr 2002, first fast ring, then the hotfix. We also installed a Cloud Management Gateway, re-worked our Boundary Groups to handle VPN better, added a second Management Point and generally made a butt-load of changes to our environment to help our remote clients have access to content more easily.</description></item><item><title>Extracting Device Names from Bad MIFs in ConfigMgr</title><link>https://www.asquaredozen.com/2020/05/19/extracting-device-names-from-bad-mifs-in-configmgr/</link><pubDate>Tue, 19 May 2020 19:36:05 +0000</pubDate><guid>https://www.asquaredozen.com/2020/05/19/extracting-device-names-from-bad-mifs-in-configmgr/</guid><description>If you are here, you either know what a BADMIF is or Google brought you here after you searched for something like &amp;lsquo;Large number of BADMIFS&amp;rsquo; or &amp;lsquo;Can I delete BADMIFS&amp;rsquo; or something like that. Anyway, if you want great info on what MIFs are and some great in-depth troubleshooting steps for them, you should check out Umair Kahn&amp;rsquo;s post over on Tech Community (migrated from Technet). It&amp;rsquo;s a bit old, but still very relevant.</description></item><item><title>ConfigMgr AdminService and WMI Methods – A match made in the cloud (1910)</title><link>https://www.asquaredozen.com/2019/11/29/configmgr-adminservice-and-wmi-methods-a-match-made-in-the-cloud-1910/</link><pubDate>Fri, 29 Nov 2019 22:12:08 +0000</pubDate><guid>https://www.asquaredozen.com/2019/11/29/configmgr-adminservice-and-wmi-methods-a-match-made-in-the-cloud-1910/</guid><description>This post applies to Microsoft Endpoint Configuration Manager 1910 Current Branch
At Microsoft Ignite 2019 Brad Anderson demoed a few things in his sessions, later covered more in depth in other sessions, that highlighted some new features to allow you to leverage the cloud console to manage ConfigMgr-only devices. As I watched these sessions, I realized that they were using the ConfigMgr Administration Service to do integrate into the cloud.</description></item><item><title>Convert ConfigMgr Error Codes to Plain Text Messages for Reporting – Part 3</title><link>https://www.asquaredozen.com/2019/11/25/convert-configmgr-error-codes-to-plain-text-messages-for-reporting-part-3/</link><pubDate>Tue, 26 Nov 2019 00:23:24 +0000</pubDate><guid>https://www.asquaredozen.com/2019/11/25/convert-configmgr-error-codes-to-plain-text-messages-for-reporting-part-3/</guid><description>I demoed this at MMS Jazz 2019 Tip and Tricks. This is Part 3 of a 3-part series. Part 1covers how to create a PowerShell script to lookup error messages. Part 2 covers creating an Azure Function.
My goal is to use ConfigMgr ErrorCodes in a report in Power BI for easier deployment monitoring. As I mentioned in Part 1, the error text isn&amp;rsquo;t available in the ConfigMgr DB, so I created a PowerShell script to look up the error code.</description></item><item><title>Convert ConfigMgr Error Codes to Plain Text Messages for Reporting – Part 2</title><link>https://www.asquaredozen.com/2019/11/25/convert-configmgr-error-codes-to-plain-text-messages-for-reporting-part-2/</link><pubDate>Mon, 25 Nov 2019 18:56:50 +0000</pubDate><guid>https://www.asquaredozen.com/2019/11/25/convert-configmgr-error-codes-to-plain-text-messages-for-reporting-part-2/</guid><description>I demoed this at MMS Jazz 2019 Tip and Tricks. This is Part 2 of a 3-part series. Part 1 covers how to create a PowerShell script to lookup error messages. Part 3 covers how to create a Power BI function to use an Azure Function.
I had heard of Azure Functions and I&amp;rsquo;ve written web API&amp;rsquo;s but I had never put the 2 together until I ran into this dilemma.</description></item><item><title>Convert ConfigMgr Error Codes to Plain Text Messages for Reporting – Part 1</title><link>https://www.asquaredozen.com/2019/11/25/convert-configmgr-error-codes-to-plain-text-messages-for-reporting-part-1/</link><pubDate>Mon, 25 Nov 2019 18:02:24 +0000</pubDate><guid>https://www.asquaredozen.com/2019/11/25/convert-configmgr-error-codes-to-plain-text-messages-for-reporting-part-1/</guid><description>I demoed this at MMS Jazz 2019 Tip and Tricks. This is Part 1 of a 3-part series. Part 2 covers creating an Azure Function. Part 3 covers how to create a Power BI function to use an Azure Function.
If you have ever checked the logs in ConfigMgr, you&amp;rsquo;ve likely run across an error code in a format like 0x87D00664 or -2016410012. If use the error lookup feature in CMTrace, you can generally convert the error to plain text.</description></item><item><title>Windows 10 Feature Updates – Using Custom Action Scripts</title><link>https://www.asquaredozen.com/2019/08/25/windows-10-feature-updates-using-custom-action-scripts/</link><pubDate>Mon, 26 Aug 2019 05:28:32 +0000</pubDate><guid>https://www.asquaredozen.com/2019/08/25/windows-10-feature-updates-using-custom-action-scripts/</guid><description>This is the next installment in my Windows 10 Feature Updates series.
Custom Actions Beginning in Windows 10 1803, custom actions were introduced and represent what Suma SaganeGowda referred to as a &amp;lsquo;poor man&amp;rsquo;s implementation of Task Sequences&amp;rsquo; at Ignite 2018 in session BRK3027. Windows setup will check for the existence of these special folders and scripts and use them as part of the Feature Update process. They allow you to run scripts at various stages in the Feature Update process as well as specify reflected driver paths just as you can in Setupconfig.</description></item><item><title>ConfigMgr 1906 Technical Preview – Testing CMPivot over CMG using AdminService</title><link>https://www.asquaredozen.com/2019/06/18/configmgr-1906-technical-preview-testing-cmpivot-over-cmg-using-adminservice/</link><pubDate>Wed, 19 Jun 2019 02:50:33 +0000</pubDate><guid>https://www.asquaredozen.com/2019/06/18/configmgr-1906-technical-preview-testing-cmpivot-over-cmg-using-adminservice/</guid><description>ConfigMgr 1906 Technical Preview was released last week and I immediately upgraded one of my tech preview labs I have running in Hyper-V on my laptop. As you may know, I&amp;rsquo;m a huge fan of the new AdminService functionality which will allow you to interact with the SMS Provider over HTTPS. With each release, it has had more features added. With Tech preview 1906, I noticed that you can run CMPivot using the AdminService.</description></item><item><title>Building a Smarter Task Sequence</title><link>https://www.asquaredozen.com/2019/04/30/building-a-smarter-task-sequence/</link><pubDate>Tue, 30 Apr 2019 06:41:33 +0000</pubDate><guid>https://www.asquaredozen.com/2019/04/30/building-a-smarter-task-sequence/</guid><description>I&amp;rsquo;m procrastinating prepping my sessions for MMS 2019 and decided I should write a blog post instead to help get me motivated. A few weeks ago I tweeted that my task sequence is built to be re-run if it fails and it will &amp;lsquo;pick up where it left off&amp;rsquo;. Several folks expressed interest in the idea so I wanted to share the general framework for having a task sequence that can be re-run after failure to complete the job.</description></item><item><title>Building An Even Better Task Sequence</title><link>https://www.asquaredozen.com/2018/12/14/building-an-even-better-task-sequence/</link><pubDate>Fri, 14 Dec 2018 08:09:31 +0000</pubDate><guid>https://www.asquaredozen.com/2018/12/14/building-an-even-better-task-sequence/</guid><description>Note
03/12/2019 - This post has been updated to support changes in 1901 TP and (I assume) 1902 CB to the TSProgressUI.exe ConfigMgr client component used for the custom described dialog below.
Note: You must be running ConfigMgr/SCCM 1810 or higher to use the _SMSTSLastActionName variable included in this post. However you can use the same concepts and error dialog with previous versions (but seriously, upgrade already!). Also, go upvote the UserVoice item to have the product do this natively.</description></item><item><title>The ConfigMgr OData Web Service – V2</title><link>https://www.asquaredozen.com/2018/10/14/the-configmgr-odata-web-service-v2/</link><pubDate>Mon, 15 Oct 2018 03:41:42 +0000</pubDate><guid>https://www.asquaredozen.com/2018/10/14/the-configmgr-odata-web-service-v2/</guid><description>I went to Microsoft Ignite 2018 for the first time this year. During the week, I got to chat with lots of folks, including some of the SCCM/ConfigMgr product group. Mark Silvey was kind enough to chat with me about plans for the OData connector that was first introduced in ConfigMgr 1612 Technical Preview. When it was first released it was called CMRestProvider and it had to be enabled in the console (you can read more about this initial implementation here).</description></item><item><title>Debugging SCCM/ConfigMgr Task Sequences on the Fly</title><link>https://www.asquaredozen.com/2018/10/03/debugging-sccm-configmgr-task-sequences-on-the-fly/</link><pubDate>Wed, 03 Oct 2018 16:11:08 +0000</pubDate><guid>https://www.asquaredozen.com/2018/10/03/debugging-sccm-configmgr-task-sequences-on-the-fly/</guid><description>If you have worked with SCCM/ConfigMgr Task Sequences for any length of time, you&amp;rsquo;ve likely needed to debug them. Many times, you need to check the value of a Task Sequence variable. The generally accepted approach is to add a Run Command Line step to your Task Sequence and run ServiceUI.exe like this:
ServiceUI.exe -process:TSProgressUI.exe cmd.exe
This approach is great if you planned ahead and you are in a test Task Sequence.</description></item><item><title>Configuring 802.1x Authentication for Windows Deployment – Part 5 – Dynamic Whitelisting using the Cisco ISE External RESTful Service</title><link>https://www.asquaredozen.com/2018/09/29/configuring-802-1x-authentication-for-windows-deployment-part-5-dynamic-whitelisting-using-the-cisco-ise-external-restful-service/</link><pubDate>Sat, 29 Sep 2018 07:00:27 +0000</pubDate><guid>https://www.asquaredozen.com/2018/09/29/configuring-802-1x-authentication-for-windows-deployment-part-5-dynamic-whitelisting-using-the-cisco-ise-external-restful-service/</guid><description>This is Part 5 in my Configuring 802.1x Authentication for Windows Deployment series. Be sure to check out all of the other parts.
A few months ago, when I published the first 4 parts on this series, I was unaware that there was a web service available for managing Cisco ISE, which is the NAC that I have to work with in my environment. I was fortunate to meet with a peer who works nearby and he shared a script demonstrating how to interact with the Cisco ISE External RESTful Service (ERS) to dynamically whitelist devices when WinPE starts for Bare Metal OSD and inside an SCCM/ConfigMgr Task Sequence for In-Place upgrades.</description></item><item><title>Using SCCM Task Sequence Variables as Scripts</title><link>https://www.asquaredozen.com/2018/08/27/using-sccm-task-sequence-variables-as-scripts/</link><pubDate>Mon, 27 Aug 2018 06:09:27 +0000</pubDate><guid>https://www.asquaredozen.com/2018/08/27/using-sccm-task-sequence-variables-as-scripts/</guid><description>The more I dig in to SCCM/ConfigMgr, the more cool things I find. Every time I read a new post blog about things people have done with their Task Sequences, I get inspired to try more things. One of those things is setting Task Sequence variable values from the output of a script. At this point, I&amp;rsquo;m sure we&amp;rsquo;ve all read and re-read Gary Blok&amp;rsquo;s Waas posts and picked up a few tricks, I know I have.</description></item><item><title>Adding Dynamic Updates to Windows 10 In-Place Upgrade Media During Offline Servicing</title><link>https://www.asquaredozen.com/2018/08/20/adding-dynamic-updates-to-windows-10-in-place-upgrade-media-during-offline-servicing/</link><pubDate>Mon, 20 Aug 2018 06:14:08 +0000</pubDate><guid>https://www.asquaredozen.com/2018/08/20/adding-dynamic-updates-to-windows-10-in-place-upgrade-media-during-offline-servicing/</guid><description>For the past few months, there has been a community-wide push to determine the optimal approach for Offline Servicing Windows 10 media and to get Microsoft to take on more of this burden so we can get on with other tasks instead of dealing with servicing every month. Ultimately, Microsoft needs a better process for updating media each month, but until they do, all we can do is what we do best, Socially Engineer solutions.</description></item><item><title>Clearing Local Group Policies during an Windows 7 to 10 In-Place Upgrade Task Sequence</title><link>https://www.asquaredozen.com/2018/07/16/clearing-local-group-policies-during-an-windows-7-to-10-in-place-upgrade-task-sequence/</link><pubDate>Mon, 16 Jul 2018 07:00:12 +0000</pubDate><guid>https://www.asquaredozen.com/2018/07/16/clearing-local-group-policies-during-an-windows-7-to-10-in-place-upgrade-task-sequence/</guid><description>Our Windows 7 Reference Image was originally built in 2011. At the time, we had some consultants in helping us migrate from Windows XP to Windows 7. At the time, the consultant who was building the image edited the Local Group Polices on the Windows 7 machine prior to capturing it. Since then, we&amp;rsquo;ve continued to service the WIM and use it as our production image. Some years later, we were trying to change our Windows Update settings and found these nice Local Group Policies just sitting there screwing everything up!</description></item><item><title>Triggering ConfigMgr Client Actions from a Task Sequence</title><link>https://www.asquaredozen.com/2018/06/14/triggering-configmgr-client-actions-from-a-task-sequence/</link><pubDate>Fri, 15 Jun 2018 04:20:56 +0000</pubDate><guid>https://www.asquaredozen.com/2018/06/14/triggering-configmgr-client-actions-from-a-task-sequence/</guid><description>This week, we were working on testing Windows 7 to Windows 10 In-Place Upgrades and ran into an issue where our clients weren&amp;rsquo;t updating their Operating System version in the ConfigMgr console. After some helpful responses on Twitter, I was able to add a client action trigger step to the end of my Task Sequence. In my production environment, we have a child task sequence that we call that has several client action steps in it including Request Machine Assignments (Machine Policies) {00000000-0000-0000-0000-000000000021}, Hardware Inventory {00000000-0000-0000-0000-000000000001} and now a Discovery Inventory {00000000-0000-0000-0000-000000000003}.</description></item></channel></rss>