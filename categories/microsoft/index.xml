<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Microsoft on A Square Dozen</title><link>https://www.asquaredozen.com/categories/microsoft/</link><description>Recent content in Microsoft on A Square Dozen</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Sun, 12 Dec 2021 00:00:00 +0000</lastBuildDate><atom:link href="https://www.asquaredozen.com/categories/microsoft/index.xml" rel="self" type="application/rss+xml"/><item><title>Remove Teams for Home from Windows 11</title><link>https://www.asquaredozen.com/2021/12/12/remove-teams-for-home-from-windows-11/</link><pubDate>Sun, 12 Dec 2021 00:00:00 +0000</pubDate><guid>https://www.asquaredozen.com/2021/12/12/remove-teams-for-home-from-windows-11/</guid><description>Have you ever looked at something and just wondered &amp;ldquo;What were they thinking&amp;rdquo;? This is the thought I have every time I log into a newly built Windows 11 Enterprise device and see the Teams for home and Chat apps loaded.
Anyone else feel like the dude in the glasses is mocking you as you fail to log in with your work account over and over?? So glad we can Chat and collaborate in one app!</description></item><item><title>Using the ConfigMgr AdminService to Retrieve BitLocker Recovery Keys and Triggering Key Rotation</title><link>https://www.asquaredozen.com/2021/11/17/using-the-configmgr-adminservice-to-retrieve-bitlocker-recovery-keys-and-triggering-key-rotation/</link><pubDate>Wed, 17 Nov 2021 00:00:00 +0000</pubDate><guid>https://www.asquaredozen.com/2021/11/17/using-the-configmgr-adminservice-to-retrieve-bitlocker-recovery-keys-and-triggering-key-rotation/</guid><description>The Key to Success is Knowledge Recently Garth Jones accused me of knowing something that I knew nothing about and I was very offended by that. So much so, that when Bryan Dam came to me demanding to know the keys to BitLocker keys in ConfigMgr, I decided I should figure it out. So I did. Here&amp;rsquo;s what I know now:
Keying in on the Issue When trying to automate processes around ConfigMgr, there are Ways to do things then there are Supported Ways to do things.</description></item><item><title>CMPivot Reference</title><link>https://www.asquaredozen.com/2021/11/14/cmpivot_reference/</link><pubDate>Sun, 14 Nov 2021 00:00:00 +0000</pubDate><guid>https://www.asquaredozen.com/2021/11/14/cmpivot_reference/</guid><description>The following examples were compiled from the CMPivot Home screen examples and the PowerShell equivalent commands were extracted from the CMPivot PowerShell script that is copied down locally to C:\Windows\CCM\ScriptStore. The goal is the provide a way to understand what each command is actually doing when you run it.
Interpreting this Reference Query Type
WMI - The command run locally on the client is querying WMI. Any entity not listed here but available in CMPivot uses the same WMI Class that ConfigMgr Client Hardware Inventory uses.</description></item><item><title>When VDI and ConfigMgr Co-Management Collide</title><link>https://www.asquaredozen.com/2021/11/13/when-vdi-and-configmgr-co-management-collide/</link><pubDate>Sat, 13 Nov 2021 04:12:00 +0000</pubDate><guid>https://www.asquaredozen.com/2021/11/13/when-vdi-and-configmgr-co-management-collide/</guid><description>Before we begin, here are some notes about persistent and non-persistent VDI that will likely give you nightmares:
Intune doesn&amp;rsquo;t support non-persistent VDI Azure Active Directory only supports Hybrid Azure AD Join for non-persistent VDI ConfigMgr recommends limiting client functionality on non-persistent VDI but there is no mention about the impact of Co-Management on these devices. Whatever you do, don&amp;rsquo;t Hybrid Join then Co-Manage your VDI Master Image or you&amp;rsquo;re in for a bad time!</description></item><item><title>Using ConfigMgr Run Scripts and Microsoft Quick Assist to Repair a Broken Domain Trust Relationship</title><link>https://www.asquaredozen.com/2021/02/04/using-configmgr-run-scripts-and-microsoft-quick-assist-to-repair-a-broken-domain-trust-relationship/</link><pubDate>Thu, 04 Feb 2021 06:10:23 +0000</pubDate><guid>https://www.asquaredozen.com/2021/02/04/using-configmgr-run-scripts-and-microsoft-quick-assist-to-repair-a-broken-domain-trust-relationship/</guid><description>Recently one of our sites began having some issues with domain joined devices losing their trust relationship with Active Directory. While some users were able to log in with cached credentials, we had no easy way to get admin credentials to repair the domain trust. I’m going to show how Configmgr Run Scripts and Microsoft Quick Assist helped us get admin access to the devices to perform troubleshooting and remediation. The purpose of this post is to show how we can leverage various tools to solve challenging problems in production.</description></item><item><title>How to find Settings Preventing Application Deletion in ConfigMgr</title><link>https://www.asquaredozen.com/2021/01/12/how-to-find-settings-preventing-application-deletion-in-configmgr/</link><pubDate>Tue, 12 Jan 2021 21:53:01 +0000</pubDate><guid>https://www.asquaredozen.com/2021/01/12/how-to-find-settings-preventing-application-deletion-in-configmgr/</guid><description>Today my co-worker was attempting to delete an old application and got blocked with the following message message and I wanted to document it for future reference.
Configuration Manager cannot delete this application because other applications or task sequences reference it or it is configured as a deployment. 1 2 3 4 5 6 7 8 9 10 11 12 13 Configuration Manager cannot delete this application because other applications or task sequences reference it or it is configured as a deployment.</description></item><item><title>Autopilot Profile causes Device Rename after ConfigMgr OSD Task Sequence and Breaks AD Domain Trust</title><link>https://www.asquaredozen.com/2020/12/02/autopilot-profile-causes-device-rename-after-configmgr-osd-task-sequence-and-breaks-ad-domain-trust/</link><pubDate>Wed, 02 Dec 2020 22:54:15 +0000</pubDate><guid>https://www.asquaredozen.com/2020/12/02/autopilot-profile-causes-device-rename-after-configmgr-osd-task-sequence-and-breaks-ad-domain-trust/</guid><description>We got some new hardware models in this week and added drivers to our ConfigMgr OSD Task Sequence (with Windows 10 1909 serviced with November 2020 updates) to test. One of the devices kept ending up with a broken domain trust relationship when you attempt to log in immediately following build completion.
The security database on the server does not have a computer account for this workstation trust relationship One clue that we had was that something was renaming the device.</description></item><item><title>Windows 10 Feature Updates – Testing the /MigNEO Disable Parameter</title><link>https://www.asquaredozen.com/2020/09/13/windows-10-feature-updates-testing-the-migneo-disable-parameter/</link><pubDate>Sun, 13 Sep 2020 16:54:40 +0000</pubDate><guid>https://www.asquaredozen.com/2020/09/13/windows-10-feature-updates-testing-the-migneo-disable-parameter/</guid><description>Over the past few weeks I&amp;rsquo;ve been testing re-writing my Windows 10 Feature Update repo to make it easier to implement - if you haven&amp;rsquo;t tried it, go check it out. Just follow the readme in the repo https://github.com/AdamGrossTX/Windows10FeatureUpdates. During the re-write I was reminded that there were a few command line parameters that I hadn&amp;rsquo;t experimented with. One of them is /MigNEO which only has a Disable option. According to the product group, NEO stands for non-event objective which, doesn&amp;rsquo;t help it make more sense to me.</description></item><item><title>Analyze SetupDiag errors for Feature Updates in ConfigMgr 2008 Technical Preview</title><link>https://www.asquaredozen.com/2020/08/11/analyze-setupdiag-errors-for-feature-updates-in-configmgr-2008-technical-preview/</link><pubDate>Wed, 12 Aug 2020 04:03:21 +0000</pubDate><guid>https://www.asquaredozen.com/2020/08/11/analyze-setupdiag-errors-for-feature-updates-in-configmgr-2008-technical-preview/</guid><description>As soon as I read the release notes for ConfigMgr 2008 Technical Preview I knew I would be doing some digging. This release introduced the first iteration of a feature that will hopefully help make Windows 10 Feature Update servicing a little easier to manage. Listed as Analyze SetupDiag errors for feature updates this feature has been added to the Windows 10 Servicing dashboard. When I initially read the release notes and looked at the included graph, I was disappointed.</description></item><item><title>Troubleshooting ConfigMgr Enhanced HTTP and Azure Directory Group Sync</title><link>https://www.asquaredozen.com/2020/08/07/troubleshooting-configmgr-enhanced-http-and-azure-directory-group-sync/</link><pubDate>Fri, 07 Aug 2020 18:52:55 +0000</pubDate><guid>https://www.asquaredozen.com/2020/08/07/troubleshooting-configmgr-enhanced-http-and-azure-directory-group-sync/</guid><description>Today I got to help my buddy Adam Juelich with getting ConfigMgr Azure Directory Group Sync working. It&amp;rsquo;s an awesome new feature that allows you to sync ConfigMgr collection memberships to your Azure tenant. Adam had followed all of the steps and ensured that prerequisites were all configured properly but sync would never work.
Over a Teams meeting we double checked everything and walked through Ronny Dejong&amp;rsquo;s (He covers pretty much all of troubleshooting steps needed for this!</description></item><item><title>Remove Windows 10 In-Box Apps with ConfigMgr or Intune and the Microsoft Store for Business</title><link>https://www.asquaredozen.com/2020/08/06/remove-windows-10-in-box-apps-with-configmgr-or-intune-and-the-microsoft-store-for-business/</link><pubDate>Thu, 06 Aug 2020 07:31:52 +0000</pubDate><guid>https://www.asquaredozen.com/2020/08/06/remove-windows-10-in-box-apps-with-configmgr-or-intune-and-the-microsoft-store-for-business/</guid><description>If you&amp;rsquo;ve been managing Windows 10 for very long, you&amp;rsquo;ve likely implemented a script or other method to remove some of the In-Box apps that come with Windows 10. We have been using a customized version of a script that Michael Niehaus published in 2015. It uses PowerShell and an XML file with a list of apps to be removed. I have integrated it into my Windows 10 offline servicing script that I use to apply updates to my image each month.</description></item><item><title>Demystifying Windows 10 Feature Update Blocks</title><link>https://www.asquaredozen.com/2020/07/26/demystifying-windows-10-feature-update-blocks/</link><pubDate>Mon, 27 Jul 2020 04:00:36 +0000</pubDate><guid>https://www.asquaredozen.com/2020/07/26/demystifying-windows-10-feature-update-blocks/</guid><description>Disclaimer - if you manually bypass Feature Update blocks, you risk causing issues with your device. The blocks exist for a reason and should be respected. This information is provided for educational purposes only. Proceed with caution.
Windows 10 Feature Updates are released twice per year. For each release, Microsoft has the ability to block the update from being installed or even showing up in Widows Update for applications/drivers/devices that have known compatibility issues.</description></item><item><title>Lockdown Diary – Metered Internet Connections and Broken ConfigMgr Clients</title><link>https://www.asquaredozen.com/2020/05/22/lockdown-diary-metered-internet-connections-and-broken-configmgr-clients/</link><pubDate>Sat, 23 May 2020 04:49:05 +0000</pubDate><guid>https://www.asquaredozen.com/2020/05/22/lockdown-diary-metered-internet-connections-and-broken-configmgr-clients/</guid><description>Do you know how hard it is to find things when you don&amp;rsquo;t know what to search for??
I&amp;rsquo;m paranoid. We recently upgraded our site to ConfigMgr 2002, first fast ring, then the hotfix. We also installed a Cloud Management Gateway, re-worked our Boundary Groups to handle VPN better, added a second Management Point and generally made a butt-load of changes to our environment to help our remote clients have access to content more easily.</description></item><item><title>Extracting Device Names from Bad MIFs in ConfigMgr</title><link>https://www.asquaredozen.com/2020/05/19/extracting-device-names-from-bad-mifs-in-configmgr/</link><pubDate>Tue, 19 May 2020 19:36:05 +0000</pubDate><guid>https://www.asquaredozen.com/2020/05/19/extracting-device-names-from-bad-mifs-in-configmgr/</guid><description>If you are here, you either know what a BADMIF is or Google brought you here after you searched for something like &amp;lsquo;Large number of BADMIFS&amp;rsquo; or &amp;lsquo;Can I delete BADMIFS&amp;rsquo; or something like that. Anyway, if you want great info on what MIFs are and some great in-depth troubleshooting steps for them, you should check out Umair Kahn&amp;rsquo;s post over on Tech Community (migrated from Technet). It&amp;rsquo;s a bit old, but still very relevant.</description></item><item><title>Lockdown Diary – My Always On VPN is Schrödinger’s Cat</title><link>https://www.asquaredozen.com/2020/05/12/lockdown-diary-my-always-on-vpn-is-schrodingers-cat/</link><pubDate>Wed, 13 May 2020 04:29:36 +0000</pubDate><guid>https://www.asquaredozen.com/2020/05/12/lockdown-diary-my-always-on-vpn-is-schrodingers-cat/</guid><description>When is your Always On VPN not Always On? An Always On VPN client uses a machine certificate to connect to the VPN gateway and connect to the network on startup. This feature is wonderful since it allows VPN clients to process machine group policies and even makes it easy for users with expired passwords to reset their passwords. But how can you verify that the machine channel is connected if you can&amp;rsquo;t see any indicators on the logon screen?</description></item><item><title>Gather No More – Using Dynamic Task Sequence Variables in ConfigMgr</title><link>https://www.asquaredozen.com/2020/02/20/gather-no-more-using-dynamic-task-sequence-variables-in-configmgr/</link><pubDate>Fri, 21 Feb 2020 02:15:17 +0000</pubDate><guid>https://www.asquaredozen.com/2020/02/20/gather-no-more-using-dynamic-task-sequence-variables-in-configmgr/</guid><description>Update 09/14/2020 - You can download the Gather Light Task Sequence from the Community Hub now! https://communityhub.microsoft.com/item/7812
Update 02/21/2020 - I added a new section with a Gather Task Sequence. Check out the DIY Gather in the Task Sequence section below. It even has a GIF (unlike Software Center!)
If you&amp;rsquo;ve used the Microsoft Deployment ToolKit (MDT) or ConfigMgr or have ever heard of &amp;lsquo;Johan and Mikael&amp;rsquo;, you&amp;rsquo;ve likely used or at least heard/read about using MDT and the Gather script that&amp;rsquo;s included with it as part of your Task Sequences.</description></item><item><title>Repairing Invalid Win32_UserProfile WMI Class on Windows 7 to 10 In-Place Upgraded Devices</title><link>https://www.asquaredozen.com/2020/01/19/repairing-invalid-win32-userprofile-wmi-class-on-windows-7-to-10-in-place-upgraded-devices/</link><pubDate>Sun, 19 Jan 2020 21:35:28 +0000</pubDate><guid>https://www.asquaredozen.com/2020/01/19/repairing-invalid-win32-userprofile-wmi-class-on-windows-7-to-10-in-place-upgraded-devices/</guid><description>I recently needed to query the Win32_UserProfile class in WMI for some reporting I was working on. This class is a default Hardware Inventory class in ConfigMgr. I noticed that we had a large number of devices were reporting NULL values for several properties in this class when I queried them in SQL so I decided to investigate. From the ConfigMgr console, I used CMPivot (only one of the best tools ever!</description></item><item><title>ConfigMgr AdminService and WMI Methods – A match made in the cloud (1910)</title><link>https://www.asquaredozen.com/2019/11/29/configmgr-adminservice-and-wmi-methods-a-match-made-in-the-cloud-1910/</link><pubDate>Fri, 29 Nov 2019 22:12:08 +0000</pubDate><guid>https://www.asquaredozen.com/2019/11/29/configmgr-adminservice-and-wmi-methods-a-match-made-in-the-cloud-1910/</guid><description>This post applies to Microsoft Endpoint Configuration Manager 1910 Current Branch
At Microsoft Ignite 2019 Brad Anderson demoed a few things in his sessions, later covered more in depth in other sessions, that highlighted some new features to allow you to leverage the cloud console to manage ConfigMgr-only devices. As I watched these sessions, I realized that they were using the ConfigMgr Administration Service to do integrate into the cloud.</description></item><item><title>Convert ConfigMgr Error Codes to Plain Text Messages for Reporting – Part 3</title><link>https://www.asquaredozen.com/2019/11/25/convert-configmgr-error-codes-to-plain-text-messages-for-reporting-part-3/</link><pubDate>Tue, 26 Nov 2019 00:23:24 +0000</pubDate><guid>https://www.asquaredozen.com/2019/11/25/convert-configmgr-error-codes-to-plain-text-messages-for-reporting-part-3/</guid><description>I demoed this at MMS Jazz 2019 Tip and Tricks. This is Part 3 of a 3-part series. Part 1covers how to create a PowerShell script to lookup error messages. Part 2 covers creating an Azure Function.
My goal is to use ConfigMgr ErrorCodes in a report in Power BI for easier deployment monitoring. As I mentioned in Part 1, the error text isn&amp;rsquo;t available in the ConfigMgr DB, so I created a PowerShell script to look up the error code.</description></item><item><title>Convert ConfigMgr Error Codes to Plain Text Messages for Reporting – Part 2</title><link>https://www.asquaredozen.com/2019/11/25/convert-configmgr-error-codes-to-plain-text-messages-for-reporting-part-2/</link><pubDate>Mon, 25 Nov 2019 18:56:50 +0000</pubDate><guid>https://www.asquaredozen.com/2019/11/25/convert-configmgr-error-codes-to-plain-text-messages-for-reporting-part-2/</guid><description>I demoed this at MMS Jazz 2019 Tip and Tricks. This is Part 2 of a 3-part series. Part 1 covers how to create a PowerShell script to lookup error messages. Part 3 covers how to create a Power BI function to use an Azure Function.
I had heard of Azure Functions and I&amp;rsquo;ve written web API&amp;rsquo;s but I had never put the 2 together until I ran into this dilemma.</description></item><item><title>Convert ConfigMgr Error Codes to Plain Text Messages for Reporting – Part 1</title><link>https://www.asquaredozen.com/2019/11/25/convert-configmgr-error-codes-to-plain-text-messages-for-reporting-part-1/</link><pubDate>Mon, 25 Nov 2019 18:02:24 +0000</pubDate><guid>https://www.asquaredozen.com/2019/11/25/convert-configmgr-error-codes-to-plain-text-messages-for-reporting-part-1/</guid><description>I demoed this at MMS Jazz 2019 Tip and Tricks. This is Part 1 of a 3-part series. Part 2 covers creating an Azure Function. Part 3 covers how to create a Power BI function to use an Azure Function.
If you have ever checked the logs in ConfigMgr, you&amp;rsquo;ve likely run across an error code in a format like 0x87D00664 or -2016410012. If use the error lookup feature in CMTrace, you can generally convert the error to plain text.</description></item><item><title>Windows 10 Feature Updates – The Challenge of Servicing in the Enterprise</title><link>https://www.asquaredozen.com/2019/10/05/windows-10-feature-updates-the-challenge-of-servicing-in-the-enterprise/</link><pubDate>Sat, 05 Oct 2019 15:09:39 +0000</pubDate><guid>https://www.asquaredozen.com/2019/10/05/windows-10-feature-updates-the-challenge-of-servicing-in-the-enterprise/</guid><description>I hope I never have to build another Task Sequence again. Seriously. Wouldn&amp;rsquo;t that be nice? I know that&amp;rsquo;s not truly feasible, but can&amp;rsquo;t a guy dream? It&amp;rsquo;s not that I dislike Task Sequences, it&amp;rsquo;s just that I strongly believe that Modern Desktop Management (AutoPilot/Device Reset/Feature Update servicing/etc.) is going to continue to improve and we should continue to attempt to adopt these tools with as much effort as we spend on customizing Task Sequences.</description></item><item><title>Windows 10 Feature Updates – Using Setupconfig.ini to Manage Feature Updates in the Enterprise</title><link>https://www.asquaredozen.com/2019/08/25/windows-10-feature-updates-using-setupconfig-ini-to-manage-feature-updates-in-the-enterprise/</link><pubDate>Mon, 26 Aug 2019 00:24:25 +0000</pubDate><guid>https://www.asquaredozen.com/2019/08/25/windows-10-feature-updates-using-setupconfig-ini-to-manage-feature-updates-in-the-enterprise/</guid><description>This is the next installment in my Windows 10 Feature Updates series.
Setupconfig.ini Setupconfig.ini is a file that can be used to pass command line arguments to the Windows Setup engine during a Windows installation. When Setupconfig.ini is specified in the command line (/ConfigFile &amp;lt;path to Setupconfig.ini&amp;gt;) or exists in the default location (%systemdrive%\Users\Default\AppData\Local\Microsoft\Windows\WSUS\Setupconfig.ini), any arguments in it will take precedence over arguments specified in the commandline. If you use this file, ensure that you aren&amp;rsquo;t counteracting commandline args that you may be using with other deployment methods such as Task Sequences (Task Sequences simply generate a command line based on which options you select).</description></item><item><title>Troubleshooting Win32 App Installs in Intune</title><link>https://www.asquaredozen.com/2019/08/21/troubleshooting-win32-app-installs-in-intune/</link><pubDate>Wed, 21 Aug 2019 06:32:54 +0000</pubDate><guid>https://www.asquaredozen.com/2019/08/21/troubleshooting-win32-app-installs-in-intune/</guid><description>As you may know, Steven Hosking and I recently started a YouTube channel called Intune.Training where we are walking through how to get started with Microsoft Intune each week. As we were recording our latest episode (coming soon) on Win32 applications, the demo failed when we attempted to install the application we had just built in Intune. We didn&amp;rsquo;t have time in the video to go through troubleshooting the issue, but I later determined the issue.</description></item><item><title>How to Use Profiles in Microsoft’s Chromium Edge for Managing Multiple Accounts in Azure, Teams and More</title><link>https://www.asquaredozen.com/2019/08/15/how-to-use-profiles-in-microsofts-chromium-edge-for-managing-multiple-accounts-in-azure-teams-and-more/</link><pubDate>Thu, 15 Aug 2019 06:01:54 +0000</pubDate><guid>https://www.asquaredozen.com/2019/08/15/how-to-use-profiles-in-microsofts-chromium-edge-for-managing-multiple-accounts-in-azure-teams-and-more/</guid><description>I&amp;rsquo;ve never been a fan of alternate web browsers (Chrome, Firefox, etc), not because I don&amp;rsquo;t believe they may have better features than Internet Explorer or Edge, but because I live in the End User Computing space and find it easier to support users if I use the same browsers that they do. Even at home, I keep it simple and just use Edge or IE to help reduce my frustration of having different features depending on where I may be logged in each day.</description></item></channel></rss>