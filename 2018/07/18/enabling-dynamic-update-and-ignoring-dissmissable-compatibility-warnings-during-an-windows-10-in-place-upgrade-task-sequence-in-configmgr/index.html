<!DOCTYPE html>
<html lang="en-us">
	    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="keyword"  content="ConfigMgr Microsoft MVP Gross Intune Windows">
        <meta name="viewport" content="width=device-width">
        <link rel="shortcut icon" href="/img/favicon.ico">
        <title>Enabling Dynamic Update AND Ignoring Dissmissable Compatibility Warnings during an Windows 10 In-Place Upgrade Task Sequence in ConfigMgr-A Square Dozen | A. Gross Blog</title>

        <meta name="description" content="A.Gross Blog | Adam Gross Enterprise Mobility MVP">
        

        
<script async src="https://www.googletagmanager.com/gtag/js?id=G-DYVXTRTXN4"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-DYVXTRTXN4', { 'anonymize_ip': false });
}
</script>

        <meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://blog.asquaredozen.com/105"/>

<meta name="twitter:title" content="Enabling Dynamic Update AND Ignoring Dissmissable Compatibility Warnings during an Windows 10 In-Place Upgrade Task Sequence in ConfigMgr"/>
<meta name="twitter:description" content="WARNING!! 8/21/2018 - The following steps will enable Dynamic Updates for Windows 10 In-Place Upgrade. If you have not serviced your WIM with THE LATEST Cumulative updates - like today is patch Tuesday and you haven&rsquo;t updated your WIM with today&rsquo;s CU, proceed with caution! Your Enabling Dynamic Updates will allow your clients to go to the internet and download the latest Cumulative Update and install it during the upgrade. This is an extra ~800 MB per client from the internet."/>


        <link rel="canonical" href="/2018/07/18/enabling-dynamic-update-and-ignoring-dissmissable-compatibility-warnings-during-an-windows-10-in-place-upgrade-task-sequence-in-configmgr/">
        <link rel="stylesheet" href="/css/style.css">
        <link rel="stylesheet" href="/css/code.css">
        

        
        <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" rel="stylesheet" type="text/css">
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>

        <script src="js/asd.js"></script>

        
        

        
    </head>
		<body class="home blog">
			<div id="asd-container">
				
				
<div id="top-bar">
    <div class="container">
        <div id="nav-wrapper">
                <ul class="menu" id="menu-top-menu">
                    <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                        <a href="/">Home</a>
                    </li>
                    
                    
                        
                            <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                <a href="#">
                                    
                                    <span>Feature Updates</span>
                                </a>
                                <ul class="sub-menu menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                    
                                        <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                            <a href="/2019/08/22/windows-10-feature-updates-leveraging-setupdiag-for-better-reporting/">Windows 10 Feature Updates – Leveraging SetupDiag for Better Reporting</a>
                                        </li>
                                    
                                        <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                            <a href="/2019/10/05/windows-10-feature-updates-the-challenge-of-servicing-in-the-enterprise/">Windows 10 Feature Updates – The Challenge of Servicing in the Enterprise</a>
                                        </li>
                                    
                                        <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                            <a href="/2019/08/25/windows-10-feature-updates-using-custom-action-scripts/">Windows 10 Feature Updates – Using Custom Action Scripts</a>
                                        </li>
                                    
                                        <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                            <a href="/2019/08/25/windows-10-feature-updates-using-setupconfig-ini-to-manage-feature-updates-in-the-enterprise/">Windows 10 Feature Updates – Using Setupconfig.ini to Manage Feature Updates in the Enterprise</a>
                                        </li>
                                    
                                </ul>
                            </li>
                        
                    
                        
                            <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                <a href="/2019/02/12/the-system-center-configuration-manager-adminservice-guide/">
                                    
                                    <span>ConfigMgr AdminService</span>
                                </a>
                            </li>
                        
                    
                        
                            <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                <a href="#">
                                    
                                    <span>802.1x for OSD</span>
                                </a>
                                <ul class="sub-menu menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                    
                                        <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                            <a href="/2018/07/29/configuring-802-1x-authentication-for-windows-deployment-part-1-building-an-802-1x-computer-authentication-script/">Part 1 – Building an 802.1x Computer Authentication Script</a>
                                        </li>
                                    
                                        <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                            <a href="/2018/07/29/configuring-802-1x-authentication-for-windows-deployment-part-2-building-an-802-1x-enabled-winpe-boot-image/">Part 2 – Building an 802.1x Enabled WinPE Boot Image</a>
                                        </li>
                                    
                                        <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                            <a href="/2018/07/29/configuring-802-1x-authentication-for-windows-deployment-part-3-integrating-802-1x-authentication-into-a-bare-metal-task-sequence/">Part 3 – Integrating 802.1x Authentication into a Bare Metal Task Sequence</a>
                                        </li>
                                    
                                        <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                            <a href="/2018/07/29/configuring-802-1x-authentication-for-windows-deployment-part-4-integrating-802-1x-authentication-into-an-in-place-upgrade-task-sequence/">Part 4 – Integrating 802.1x Authentication into an In-Place Upgrade Task Sequence</a>
                                        </li>
                                    
                                        <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                            <a href="/2018/09/29/configuring-802-1x-authentication-for-windows-deployment-part-5-dynamic-whitelisting-using-the-cisco-ise-external-restful-service/">Part 5 – Dynamic Whitelisting using the Cisco ISE External RESTful Service</a>
                                        </li>
                                    
                                        <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                            <a href="/2018/07/29/configuring-802-1x-authentication-for-windows-deployment-tips-and-tricks/">Tips and Tricks</a>
                                        </li>
                                    
                                </ul>
                            </li>
                        
                    
                        
                            <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                <a href="#">
                                    
                                    <span>Task Sequence Hacks</span>
                                </a>
                                <ul class="sub-menu menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                    
                                        <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                            <a href="/2018/11/29/building-a-better-task-sequence/">Building a Better Task Sequence</a>
                                        </li>
                                    
                                        <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                            <a href="/2019/04/30/building-a-smarter-task-sequence/">Building a Smarter Task Sequence</a>
                                        </li>
                                    
                                        <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                            <a href="/2018/12/14/building-an-even-better-task-sequence/">Building An Even Better Task Sequence</a>
                                        </li>
                                    
                                        <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                            <a href="/2018/07/16/clearing-local-group-policies-during-an-windows-7-to-10-in-place-upgrade-task-sequence/">Clearing Local Group Policies during an Windows 7 to 10 In-Place Upgrade Task Sequence</a>
                                        </li>
                                    
                                        <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                            <a href="/2018/10/03/debugging-sccm-configmgr-task-sequences-on-the-fly/">Debugging SCCM/ConfigMgr Task Sequences on the Fly</a>
                                        </li>
                                    
                                        <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                            <a href="/2018/07/11/dynamically-updating-unattend-xml-during-an-osd-task-sequence-using-mdt-variables-and-zti-scripts/">Dynamically Updating Unattend.XML during an OSD Task Sequence using MDT Variables and ZTI Scripts.</a>
                                        </li>
                                    
                                        <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                            <a href="/2018/06/14/triggering-configmgr-client-actions-from-a-task-sequence/">Triggering ConfigMgr Client Actions from a Task Sequence</a>
                                        </li>
                                    
                                        <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                            <a href="/2018/08/27/using-sccm-task-sequence-variables-as-scripts/">Using SCCM Task Sequence Variables as Scripts</a>
                                        </li>
                                    
                                </ul>
                            </li>
                        
                    
                        
                            <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                <a href="https://github.com/AdamGrossTX">
                                    
                                    <span>GitHub</span>
                                </a>
                            </li>
                        
                    
                        
                            <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                <a href="#">
                                    
                                    <span>MORE&gt;</span>
                                </a>
                                <ul class="sub-menu menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                    
                                        <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                            <a href="/about/">About</a>
                                        </li>
                                    
                                        <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                            <a href="/consulting/">Consulting</a>
                                        </li>
                                    
                                        <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
                                            <a href="/contact/">Contact</a>
                                        </li>
                                    
                                </ul>
                            </li>
                        
                    
                
                </ul>
        </div>
        <div class="menu" id="menu-mobile"></div>
    </div>
    <div id="top-search">
        <a href="#" class="search"><i class="fa fa-search"></i></a>
        <div class="show-search">
            <form role="search" method="get" action="https://www.google.com/search" id="searchform">
                <input type="search" placeholder="Search and hit enter..." value="" name="s" id="s" title="Search and hit enter...">
                <input type="hidden" name="sitesearch" value="asquaredozen.com">
                <button type="submit" value="Search"/>
            </form>
        </div>
    </div>
</div>
				<header id="header" class="noslider">
	<div class="container">
		<div id="logo">
			<h1><a href="https://blog.asquaredozen.com"><img src="/img/A-Square-Dozen-Logo-BlogHeader-1.png" alt="A Square Dozen" /></a></h1>
		</div>
	</div>
</header>
				<div class="container">
					<div id="content">
						<div id="main">
							
		<article class="post type-post status-publish format-standard has-post-thumbnail hentry">
			<div class="post-header">
				<h1>Enabling Dynamic Update AND Ignoring Dissmissable Compatibility Warnings during an Windows 10 In-Place Upgrade Task Sequence in ConfigMgr</h1>
				<span class="post-date">July 18, 2018</span>
			</div>
			<div class="post-entry">
				<h1 id="warning">WARNING!!</h1>
<p>8/21/2018 - The following steps will enable Dynamic Updates for Windows 10 In-Place Upgrade. If you have not serviced your WIM with THE LATEST Cumulative updates - like today is patch Tuesday and you haven&rsquo;t updated your WIM with today&rsquo;s CU, proceed with caution! Your Enabling Dynamic Updates will allow your clients to go to the internet and download the latest Cumulative Update and install it during the upgrade. This is an extra ~800 MB per client from the internet. If this is not desirable, <a href="http://www.asquaredozen.com/2018/08/20/adding-dynamic-updates-to-windows-10-in-place-upgrade-media-during-offline-servicing/">please check out how to offline service your media with the latest Dynamic Updates here</a>.</p>
<p>If you haven&rsquo;t already, check out <a href="http://www.asquaredozen.com/2018/07/18/enabling-dynamic-updates-and-servicing-drivers-from-microsoft-update-during-a-windows-10-in-place-upgrade-task-sequence-in-configmgr/">Part 1 Here</a>, otherwise this won&rsquo;t make as much sense.</p>
<p>In all of the haze of my attempts to get out to Windows Update, I lost sight of my ultimate goal, which was to be able to go out to Windows Update AND ignore dismissible compatibility warnings when using the <strong>Upgrade Operating System</strong> step in a ConfigMgr Task Sequence. While I was researching this issue, I had run across the Task Sequence option <strong>OSDSetupAdditionalUpgradeOptions</strong> as documented <a href="https://docs.microsoft.com/sccm/osd/understand/task-sequence-action-variables">here</a>. Johan (<a href="https://twitter.com/jarwidmark">@jarwidmark</a>) has a good write-up on that <a href="https://deploymentresearch.com/Research/Post/565/Specify-additional-command-line-options-to-Setup-during-a-Windows-10-upgrade-when-using-ConfigMgr">here</a>. It was late as I was finishing up testing, so I just made a note to look into it because I wanted to use the <strong>/DiagnosticPrompt enable</strong> <a href="https://docs.microsoft.com/windows-hardware/manufacture/desktop/windows-setup-command-line-options">Windows Setup command line option</a> for testing in my Task Sequence.</p>
<p>As I got back into the office and started testing, I realized that I wasn&rsquo;t done. If you have ever checked all 3 boxes,</p>
<p><div class="image">

<a href="2018-07-18_8-21-11.jpg" target="_blank">
  <img src="2018-07-18_8-21-11.jpg" alt="All 3 Boxes">
</a>

</div></p>
<p>you will have seen the message in the smsts.log stating that the <strong>Ignore</strong> flag was being <em>Ignored</em>:</p>
<p><code>When dynamic update is enabled, ignore warnings is not allowed, ignoring the switch /compat.</code></p>
<p><div class="image">

<a href="2018-07-18_8-37-24.jpg" target="_blank">
  <img src="2018-07-18_8-37-24.jpg" alt="Ignoring the Ignore">
</a>

</div></p>
<p>Now that we know the secret behind getting past ConfigMgr and out to Windows Update, we don&rsquo;t need to check the boxes. In fact, we can bypass MOST of the checkboxes (Time-Out is a ConfigMgr option, so if you need it, check the box). We can just use <strong>OSDSetupAdditionalUpgradeOptions</strong> to add any command line options that we want. Technically, you could just run it all from a <strong>Run Command Line</strong> step instead of using the <strong>Upgrade Operating System</strong> step, however, there is some behind-the-scenes integration that makes it worth keeping around.</p>
<p>Quick Tangent about the <strong>Upgrade Operating System</strong> step. Open <strong>Task Manager</strong> and you will see <strong>OSDUpgradeOS.exe</strong> running during the Upgrade Operating System step.</p>
<p><div class="image">

<a href="2018-07-18_8-32-16.jpg" target="_blank">
  <img src="2018-07-18_8-32-16.jpg" alt="osdupgradeos">
</a>

</div></p>
<p>This step manages the Task Sequence and Windows Setup integration. It adds the SetupComplete.cmd and SetupRollBack.cmd files and manages the Task Sequence UI between reboots. So, don&rsquo;t dismiss this step, maybe just don&rsquo;t use the check boxes.</p>
<p>Speaking of check boxes, the Task Sequence knows what boxes you checked, but doesn&rsquo;t check the <strong>OSDSetupAdditionalUpgradeOptions</strong> variable to see what you added there. Can you guess where I&rsquo;m headed with this?? Just move the items from the check box to the <strong>OSDSetupAdditionalUpgradeOptions</strong> variable and you the Task Sequence ignores the ignore but in a good way this time!</p>
<h1 id="the-hack-v20">The Hack v2.0</h1>
<p>Update you Task Sequence from my previous post, to be more like this:</p>
<p><strong>Type:</strong> Group<br>
<strong>Name:</strong> Upgrade the Operating System</p>
<p><strong>Type:</strong> Run Command Line Step<br>
<strong>Name:</strong> Rename Registry.pol<br>
<strong>Command Line:</strong></p>
<p><code>cmd /c &quot;ren c:\Windows\System32\groupPolicy\Machine\Registry.pol Registry.bkp&quot;</code></p>
<p><strong>Type:</strong> Run Command Line Step<br>
<strong>Name:</strong> DELETE WindowsUpdate Key<br>
<strong>Command Line:</strong></p>
<p><code>REG ADD &quot;HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU&quot; /v UseWUServer /t REG_DWORD /d 0 /f</code></p>
<p>*You can get fancy and rename this key then rename it back at the end, but you get the point. We just don&rsquo;t want this key for now.</p>
<p><strong>Type:</strong> Run Command Line Step<br>
<strong>Name:</strong> Restart Windows Update Service<br>
<strong>Command Line:</strong></p>
<p><code>%SYSTEMROOT%\System32\WindowsPowerShell\v1.0\powershell.exe -NoProfile -WindowStyle Hidden -ExecutionPolicy Bypass -Command &quot;Restart-Service wuauserv&quot;</code></p>
<p><strong>Type:</strong> Set Task Sequence Variable<br>
<strong>Name:</strong> Set OSDSetupAdditionalUpgradeOptions<br>
<strong>Task Sequence Variable:</strong><br>
<strong>Value:</strong></p>
<p><code>/Compat ScanOnly /Compat IgnoreWarning /DynamicUpdate enable</code></p>
<p>Refer to <a href="https://docs.microsoft.com/windows-hardware/manufacture/desktop/windows-setup-command-line-options">Windows Setup Command Line Options</a> for additional options.</p>
<p><strong>Type:</strong> Upgrade Operating System<br>
<strong>Name:</strong> Upgrade Operating System<br>
Select your Upgrade media and Don&rsquo;t Check ANYTHING!!<br>
See <a href="https://docs.microsoft.com/sccm/osd/understand/task-sequence-steps#BKMK_UpgradeOS">The bottom of this post for more info</a></p>
<p><div class="image">

<a href="2018-07-18_8-47-21.jpg" target="_blank">
  <img src="2018-07-18_8-47-21.jpg" alt="Upgrade Operating System">
</a>

</div></p>
<p><strong>Type:</strong> Group<br>
<strong>Name:</strong> Cleanup</p>
<p><strong>Type:</strong> Run Command Line Step<br>
<strong>Name:</strong> Rename Registry.pol<br>
<strong>Command Line:</strong></p>
<p><code>cmd /c &quot;ren c:\Windows\System32\groupPolicy\Machine\Registry.bkp Registry.pol&quot;</code></p>
<p>*Note: At this point, your machine is still pointed to Windows Update, so you will need to <code>gpupdate /force</code> to have it regenerated. I haven&rsquo;t tested this far yet, but I would assume by the end of the Task Sequence, the machine will have updated policies and rebuilt the key.</p>
<p>The end result should look something like this if you started with my previous Task Sequence and just commented out the steps:</p>
<p><div class="image">

<a href="2018-07-18_8-14-43.jpg" target="_blank">
  <img src="2018-07-18_8-14-43.jpg" alt="Updated Hacked TS!!">
</a>

</div></p>

			</div>
			
			<script src="https://utteranc.es/client.js"
				repo="AdamGrossTX/asquaredozen"
				issue-term="title"
				label="blog comment"
				theme="github-light"
				crossorigin="anonymous"
				async>
			</script>
		</article>

						</div>
						<aside id="sidebar">
	<div class="widget widget_search">
		<form role="search" method="get" action="https://www.google.com/search" id="searchform">
			<input type="search" placeholder="Search and hit enter..." value="" name="q" id="q" title="Search and hit enter...">
			<input type="hidden" name="sitesearch" value="asquaredozen.com">
			<button type="submit" value="Search"/>
		</form>
		</div>
	<div>
	<div class="widget widget_MVP">
		<a href="https://mvp.microsoft.com/en-us/PublicProfile/5003519?fullName=Adam%20Gross" target="_blank">
		<img src="/img/MVP_Logo_Horizontal_Secondary_Black_RGB_300ppi.png">
		</a>
	</div>	
	<div class="widget widget_recent_entries">
		<h4 class="widget-title">Recent Posts</h4>
		<ul>
			
			<li><a href="/2021/02/04/using-configmgr-run-scripts-and-microsoft-quick-assist-to-repair-a-broken-domain-trust-relationship/" target="_blank">Using ConfigMgr Run Scripts and Microsoft Quick Assist to Repair a Broken Domain Trust Relationship</a></li>
			
			<li><a href="/2021/01/12/how-to-find-settings-preventing-application-deletion-in-configmgr/" target="_blank">How to find Settings Preventing Application Deletion in ConfigMgr</a></li>
			
			<li><a href="/2020/12/02/autopilot-profile-causes-device-rename-after-configmgr-osd-task-sequence-and-breaks-ad-domain-trust/" target="_blank">Autopilot Profile causes Device Rename after ConfigMgr OSD Task Sequence and Breaks AD Domain Trust</a></li>
			
			<li><a href="/2020/09/30/new-post-on-sysmansquad-com-configmgr-and-the-case-of-the-mysterious-3da228be-34da-49f4-a081-66465b077429-folder/" target="_blank">New Post on SysManSquad.com – ConfigMgr and The Case of the Mysterious {3DA228BE-34DA-49f4-A081-66465B077429} Folder</a></li>
			
			<li><a href="/2020/09/13/windows-10-feature-updates-testing-the-migneo-disable-parameter/" target="_blank">Windows 10 Feature Updates – Testing the /MigNEO Disable Parameter</a></li>
			
		</ul>
	</div>
	<div class="widget widget_SCD">
		<h4 class="widget-title">Consulting</h4>
		<a href="https://systemcenterdudes.com/sccm-consulting-services/?ref=5&campaign=Consulting" target="_blank">
		<img src="/img/SCDLogo.png">
		</a>
	</div>
	<div class="widget widget_SCD">
		<h4 class="widget-title">Intune.Training</h4>
		<a href="http://intune.training" target="_blank">
		<img src="/img/ITLogo.png">
		</a>
	</div>	
</aside>

					</div>
				</div>
				<footer id="footer">
	<div class="container">
		<div id="footer-copyright">
			<p class="copyright">&copy; 2021 Adam Gross - https://blog.asquaredozen.com - A Square Dozen</a></p>
		</div>
	</div>
</footer>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
<script src="css/SlickNav/jquery.slicknav.js"></script>
			</div>
		</body>
</html>
