<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=keyword content="ConfigMgr Microsoft MVP Gross Intune Windows"><meta name=viewport content="width=device-width"><meta name=description content="A.Gross Blog | Adam Gross Enterprise Mobility MVP"><link rel="shortcut icon" href=/img/favicon.ico><title>WinPE Image fails to load on HP Proliant Gen9 servers using ADK 1709-A Square Dozen | A. Gross Blog</title><link rel=canonical href=/2018/01/27/winpe-image-fails-load-hp-proliant-gen9-servers-using-adk-1709/><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=https://www.asquaredozen.com/css/custom.css><script src=https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js></script>
<script src=https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js></script>
<script src=https://www.asquaredozen.com/js/jquery.slicknav.js></script>
<script src=https://www.asquaredozen.com/js/asd_SlickNav_Mobile.js></script>
<script src=https://www.asquaredozen.com/js/custom.js></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-DYVXTRTXN4"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-DYVXTRTXN4",{anonymize_ip:!1})}</script><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.asquaredozen.com/img/ASquareDozen-Logo_Horiz_Twitter.png"><meta name=twitter:title content="WinPE Image fails to load on HP Proliant Gen9 servers using ADK 1709"><meta name=twitter:description content="We have several generations of HP ProLiant servers in our environment. We recently upgraded SCCM to 1710 then applied ADK 1709. We have been imaging these servers using the ADK 1703 Boot Image without issue. After upgrading to ADK 1709 and creating new boot images, we are unable to boot to into WinPE on any of our Gen9 servers. After doing the standard diagnostics (testing old, testing new, updating drivers, updating firmware, etc) we found that these servers would still freeze after downloading the boot WIM and get stuck on this screen:"><meta property="og:title" content="WinPE Image fails to load on HP Proliant Gen9 servers using ADK 1709"><meta property="og:description" content="We have several generations of HP ProLiant servers in our environment. We recently upgraded SCCM to 1710 then applied ADK 1709. We have been imaging these servers using the ADK 1703 Boot Image without issue. After upgrading to ADK 1709 and creating new boot images, we are unable to boot to into WinPE on any of our Gen9 servers. After doing the standard diagnostics (testing old, testing new, updating drivers, updating firmware, etc) we found that these servers would still freeze after downloading the boot WIM and get stuck on this screen:"><meta property="og:type" content="article"><meta property="og:url" content="https://www.asquaredozen.com/2018/01/27/winpe-image-fails-load-hp-proliant-gen9-servers-using-adk-1709/"><meta property="og:image" content="https://www.asquaredozen.com/img/ASquareDozen-Logo_Horiz_Twitter.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2018-01-28T02:15:45+00:00"><meta property="article:modified_time" content="2018-01-28T02:15:45+00:00"><meta property="og:site_name" content="A Square Dozen | A. Gross Blog"></head><body class="home blog"><div id=asd-container><div id=top-bar><div class=container><div id=nav-wrapper><ul class=menu id=menu-top-menu><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/>Home</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=#><span>Feature Updates</span></a><ul class="sub-menu menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2019/08/22/windows-10-feature-updates-leveraging-setupdiag-for-better-reporting/>Windows 10 Feature Updates – Leveraging SetupDiag for Better Reporting</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2019/10/05/windows-10-feature-updates-the-challenge-of-servicing-in-the-enterprise/>Windows 10 Feature Updates – The Challenge of Servicing in the Enterprise</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2019/08/25/windows-10-feature-updates-using-custom-action-scripts/>Windows 10 Feature Updates – Using Custom Action Scripts</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2019/08/25/windows-10-feature-updates-using-setupconfig-ini-to-manage-feature-updates-in-the-enterprise/>Windows 10 Feature Updates – Using Setupconfig.ini to Manage Feature Updates in the Enterprise</a></li></ul></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2019/02/12/the-system-center-configuration-manager-adminservice-guide/><span>ConfigMgr AdminService</span></a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=#><span>802.1x for OSD</span></a><ul class="sub-menu menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/07/29/configuring-802-1x-authentication-for-windows-deployment-part-1-building-an-802-1x-computer-authentication-script/>Part 1 – Building an 802.1x Computer Authentication Script</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/07/29/configuring-802-1x-authentication-for-windows-deployment-part-2-building-an-802-1x-enabled-winpe-boot-image/>Part 2 – Building an 802.1x Enabled WinPE Boot Image</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/07/29/configuring-802-1x-authentication-for-windows-deployment-part-3-integrating-802-1x-authentication-into-a-bare-metal-task-sequence/>Part 3 – Integrating 802.1x Authentication into a Bare Metal Task Sequence</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/07/29/configuring-802-1x-authentication-for-windows-deployment-part-4-integrating-802-1x-authentication-into-an-in-place-upgrade-task-sequence/>Part 4 – Integrating 802.1x Authentication into an In-Place Upgrade Task Sequence</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/09/29/configuring-802-1x-authentication-for-windows-deployment-part-5-dynamic-whitelisting-using-the-cisco-ise-external-restful-service/>Part 5 – Dynamic Whitelisting using the Cisco ISE External RESTful Service</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/07/29/configuring-802-1x-authentication-for-windows-deployment-tips-and-tricks/>Tips and Tricks</a></li></ul></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=#><span>Task Sequence Hacks</span></a><ul class="sub-menu menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/11/29/building-a-better-task-sequence/>Building a Better Task Sequence</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2019/04/30/building-a-smarter-task-sequence/>Building a Smarter Task Sequence</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/12/14/building-an-even-better-task-sequence/>Building An Even Better Task Sequence</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/07/16/clearing-local-group-policies-during-an-windows-7-to-10-in-place-upgrade-task-sequence/>Clearing Local Group Policies during an Windows 7 to 10 In-Place Upgrade Task Sequence</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/10/03/debugging-sccm-configmgr-task-sequences-on-the-fly/>Debugging SCCM/ConfigMgr Task Sequences on the Fly</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/07/11/dynamically-updating-unattend-xml-during-an-osd-task-sequence-using-mdt-variables-and-zti-scripts/>Dynamically Updating Unattend.XML during an OSD Task Sequence using MDT Variables and ZTI Scripts.</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/06/14/triggering-configmgr-client-actions-from-a-task-sequence/>Triggering ConfigMgr Client Actions from a Task Sequence</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/08/27/using-sccm-task-sequence-variables-as-scripts/>Using SCCM Task Sequence Variables as Scripts</a></li></ul></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=https://github.com/AdamGrossTX><span>GitHub</span></a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=#><span>MORE></span></a><ul class="sub-menu menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/about/>About</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/consulting/>Consulting</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/contact/>Contact</a></li></ul></li></ul></div><div id=top-search><a href=# class=search><i class="fa fa-search"></i></a><div class=show-search><form role=search method=get action=https://www.google.com/search id=searchform><input type=search placeholder="Search and hit enter..." name=q id=q title="Search and hit enter...">
<input type=hidden name=sitesearch value=https://www.asquaredozen.com>
<button type=submit value=Search></form></div></div><div class=menu id=menu-mobile></div></div></div><header id=header class=noslider><div class=container><div id=logo><h1><a href=https://www.asquaredozen.com><img src=/img/A-Square-Dozen-Logo-BlogHeader-1.png alt="A Square Dozen"></a></h1></div></div></header><div class=container><div id=content><div id=main class=fullwidth><article class="post type-post status-publish format-standard has-post-thumbnail hentry"><div class=post-header><h1>WinPE Image fails to load on HP Proliant Gen9 servers using ADK 1709</h1><span class=post-date>January 28, 2018</span></div><div class=post-entry><p>We have several generations of HP ProLiant servers in our environment. We recently upgraded SCCM to 1710 then applied ADK 1709. We have been imaging these servers using the ADK 1703 Boot Image without issue. After upgrading to ADK 1709 and creating new boot images, we are unable to boot to into WinPE on any of our Gen9 servers. After doing the standard diagnostics (testing old, testing new, updating drivers, updating firmware, etc) we found that these servers would still freeze after downloading the boot WIM and get stuck on this screen:</p><p><a href=/2018/01/27/winpe-image-fails-load-hp-proliant-gen9-servers-using-adk-1709/hpbootscreen/><div class=image><figure><a href=HPBootScreen.jpg target=_blank><img src=HPBootScreen.jpg alt="A Square Dozen Image"></a></figure></div></a></p><p>We found a <a href="https://support.hpe.com/hpsc/doc/public/display?docId=emr_na-a00037880en_us">support article from HP</a> that referred to Microsoft KB4055537, which didn&rsquo;t exist at the time we were troubleshooting and our Microsoft contacts didn&rsquo;t have any information either.</p><p>In the meantime, I <a href="https://social.technet.microsoft.com/Forums/windowsserver/36858bf9-b9ad-4eb9-9b46-7b457be85f42/hp-proliant-gen9-servers-unable-to-pxe-boot-with-adk-1709-boot-image-older-adk-version-work-other?forum=winserversetup&prof=required">posted the issue on the TechNet forums</a> and didn&rsquo;t get much help until earlier this week when <a href="https://social.technet.microsoft.com/profile/michael_jakob/?ws=usercard-mini">Michael Jakob</a>, who has been a TechNet member since 2014, made his first ever post with the solution. I had given up on the issue and turned it over to our server team who where waiting to hear back from Microsoft. As soon as I got the email alert from Technet, I forwarded the info over to the server guys who tested and verified it was indeed the solution.</p><p>HP&rsquo;s initial support article had the correct KB <a href=https://support.microsoft.com/help/4055537/config-initialization-failed-error-when-installing-windows-server>KB055537</a>, but they were about a week early on the release date. Even now, when I use Google or Bing to search for &lsquo;KB4055537&rsquo;, I only get the HP article referencing it and a handful of TechNet posts including my original and <a href="https://social.technet.microsoft.com/Forums/4e6e7937-7efa-45d7-aede-d64119cb75e4/winpe-boot-issue-proliant-gen9-server-with-winpe-1709-where-is-the-fix-kb4055537?forum=ConfigMgrCBOSD">this one</a> which led me to the right info. If you search for &lsquo;Microsoft 4055537&rsquo;, you can find it (KB4055537 isn&rsquo;t listed anywhere in the keywords or link, so it&rsquo;s not getting matched) - Lesson Learned.</p><p>The fix for this issue is included in KB 4056892. Search for <a href="http://catalog.update.microsoft.com/v7/site/Search.aspx?q=KB4056892">2018-01 Cumulative Update for Windows Server 2016 (1709) for x64-based Systems (KB4056892)</a> from Microsoft Update Catalog website to download the rollup.</p><p><strong>The Fix</strong></p><ol><li>From the &lsquo;Deployment and Imaging Tools Environment&rsquo;, you will need too mount your boot WIM and apply the update using DISM.</li></ol><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-1>1</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-2>2</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-3>3</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Batchfile data-lang=Batchfile><span style=display:flex><span>dism /mount-image /imagefile:\sources\boot.wim /index:1 /mountdir:\offline  
</span></span><span style=display:flex><span>dism /image:\offline /add-package /packagepath:&#39;\Windows10.0-KB4056892-x64.cab&#39;  
</span></span><span style=display:flex><span>dism /unmount-image /mountdir:\offline /commit
</span></span></code></pre></td></tr></table></div></div><ol start=2><li>Go to your WIM source directory and check the date stamp to ensure that it was updated.</li><li>Redistribute your boot WIM and test with a Gen9 server.</li></ol><p>So, there you have it, a very long winded way to tell you to just use DISM to apply a hotfix. Enjoy.</p></div><div class=post-share><div class="post-share-box share-comments">hello</div></div><div class=post-author></div><comments id=comments><script src=https://utteranc.es/client.js repo=AdamGrossTX/asquaredozen issue-term=title label="blog comment" theme=github-light crossorigin=anonymous async></script></comments></article></div></div></div><footer id=footer><div class=container><div id=footer-copyright><p class=copyright>&copy; 2022 Adam Gross - https://www.asquaredozen.com - A Square Dozen</a></p></div></div></footer></div></body></html>