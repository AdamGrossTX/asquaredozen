<!doctype html><html lang=en-us><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=keyword content="ConfigMgr Microsoft MVP Gross Intune Windows"><meta name=viewport content="width=device-width"><meta name=description content="A.Gross Blog | Adam Gross Enterprise Mobility MVP"><link rel="shortcut icon" href=/img/favicon.ico><title>The ConfigMgr OData Web Service – V2-A Square Dozen | A. Gross Blog</title>
<link rel=canonical href=/2018/10/14/the-configmgr-odata-web-service-v2/><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=https://www.asquaredozen.com/css/custom.css><script src=https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js></script><script src=https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js></script><script src=https://www.asquaredozen.com/js/jquery.slicknav.js></script><script src=https://www.asquaredozen.com/js/asd_SlickNav_Mobile.js></script><script src=https://www.asquaredozen.com/js/custom.js></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-DYVXTRTXN4"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-DYVXTRTXN4",{anonymize_ip:!1})}</script><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.asquaredozen.com/img/ASquareDozen-Logo_Horiz_Twitter.png"><meta name=twitter:title content="The ConfigMgr OData Web Service – V2"><meta name=twitter:description content="I went to Microsoft Ignite 2018 for the first time this year. During the week, I got to chat with lots of folks, including some of the SCCM/ConfigMgr product group. Mark Silvey was kind enough to chat with me about plans for the OData connector that was first introduced in ConfigMgr 1612 Technical Preview. When it was first released it was called CMRestProvider and it had to be enabled in the console (you can read more about this initial implementation here)."><meta property="og:title" content="The ConfigMgr OData Web Service – V2"><meta property="og:description" content="I went to Microsoft Ignite 2018 for the first time this year. During the week, I got to chat with lots of folks, including some of the SCCM/ConfigMgr product group. Mark Silvey was kind enough to chat with me about plans for the OData connector that was first introduced in ConfigMgr 1612 Technical Preview. When it was first released it was called CMRestProvider and it had to be enabled in the console (you can read more about this initial implementation here)."><meta property="og:type" content="article"><meta property="og:url" content="https://www.asquaredozen.com/2018/10/14/the-configmgr-odata-web-service-v2/"><meta property="og:image" content="https://www.asquaredozen.com/img/ASquareDozen-Logo_Horiz_Twitter.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2018-10-15T03:41:42+00:00"><meta property="article:modified_time" content="2018-10-15T03:41:42+00:00"><meta property="og:site_name" content="A Square Dozen | A. Gross Blog"></head><body class="home blog"><div id=asd-container><div id=top-bar><div class=container><div id=nav-wrapper><ul class=menu id=menu-top-menu><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/>Home</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=#><span>Feature Updates</span></a><ul class="sub-menu menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2020/07/26/demystifying-windows-10-feature-update-blocks/>Demystifying Windows 10 Feature Update Blocks</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2019/08/22/windows-10-feature-updates-leveraging-setupdiag-for-better-reporting/>Windows 10 Feature Updates – Leveraging SetupDiag for Better Reporting</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2019/10/05/windows-10-feature-updates-the-challenge-of-servicing-in-the-enterprise/>Windows 10 Feature Updates – The Challenge of Servicing in the Enterprise</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2019/08/25/windows-10-feature-updates-using-custom-action-scripts/>Windows 10 Feature Updates – Using Custom Action Scripts</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2019/08/25/windows-10-feature-updates-using-setupconfig-ini-to-manage-feature-updates-in-the-enterprise/>Windows 10 Feature Updates – Using Setupconfig.ini to Manage Feature Updates in the Enterprise</a></li></ul></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2019/02/12/the-system-center-configuration-manager-adminservice-guide/><span>ConfigMgr AdminService</span></a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=#><span>802.1x for OSD</span></a><ul class="sub-menu menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/07/29/configuring-802-1x-authentication-for-windows-deployment-part-1-building-an-802-1x-computer-authentication-script/>Part 1 – Building an 802.1x Computer Authentication Script</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/07/29/configuring-802-1x-authentication-for-windows-deployment-part-2-building-an-802-1x-enabled-winpe-boot-image/>Part 2 – Building an 802.1x Enabled WinPE Boot Image</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/07/29/configuring-802-1x-authentication-for-windows-deployment-part-3-integrating-802-1x-authentication-into-a-bare-metal-task-sequence/>Part 3 – Integrating 802.1x Authentication into a Bare Metal Task Sequence</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/07/29/configuring-802-1x-authentication-for-windows-deployment-part-4-integrating-802-1x-authentication-into-an-in-place-upgrade-task-sequence/>Part 4 – Integrating 802.1x Authentication into an In-Place Upgrade Task Sequence</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/09/29/configuring-802-1x-authentication-for-windows-deployment-part-5-dynamic-whitelisting-using-the-cisco-ise-external-restful-service/>Part 5 – Dynamic Whitelisting using the Cisco ISE External RESTful Service</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/07/29/configuring-802-1x-authentication-for-windows-deployment-tips-and-tricks/>Tips and Tricks</a></li></ul></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=#><span>Task Sequence Hacks</span></a><ul class="sub-menu menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/11/29/building-a-better-task-sequence/>Building a Better Task Sequence</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2019/04/30/building-a-smarter-task-sequence/>Building a Smarter Task Sequence</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/12/14/building-an-even-better-task-sequence/>Building An Even Better Task Sequence</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/07/16/clearing-local-group-policies-during-an-windows-7-to-10-in-place-upgrade-task-sequence/>Clearing Local Group Policies during an Windows 7 to 10 In-Place Upgrade Task Sequence</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/10/03/debugging-sccm-configmgr-task-sequences-on-the-fly/>Debugging SCCM/ConfigMgr Task Sequences on the Fly</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/07/11/dynamically-updating-unattend-xml-during-an-osd-task-sequence-using-mdt-variables-and-zti-scripts/>Dynamically Updating Unattend.XML during an OSD Task Sequence using MDT Variables and ZTI Scripts.</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/06/14/triggering-configmgr-client-actions-from-a-task-sequence/>Triggering ConfigMgr Client Actions from a Task Sequence</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/2018/08/27/using-sccm-task-sequence-variables-as-scripts/>Using SCCM Task Sequence Variables as Scripts</a></li></ul></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=https://github.com/AdamGrossTX><span>GitHub</span></a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=#><span>MORE></span></a><ul class="sub-menu menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/about/>About</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/consulting/>Consulting</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/contact/>Contact</a></li></ul></li></ul></div><div id=top-search><a href=# class=search><i class="fa fa-search"></i></a><div class=show-search><form role=search method=get action=https://www.google.com/search id=searchform><input type=search placeholder="Search and hit enter..." name=q id=q title="Search and hit enter...">
<input type=hidden name=sitesearch value=https://www.asquaredozen.com>
<button type=submit value=Search></form></div></div><div class=menu id=menu-mobile></div></div></div><header id=header class=noslider><div class=container><div id=logo><h1><a href=https://www.asquaredozen.com><img src=/img/A-Square-Dozen-Logo-BlogHeader-1.png alt="A Square Dozen"></a></h1></div></div></header><div class=container><div id=content><div id=main class=fullwidth><article class="post type-post status-publish format-standard has-post-thumbnail hentry"><div class=post-header><h1>The ConfigMgr OData Web Service – V2</h1><span class=post-date>October 15, 2018</span></div><div class=post-entry><p>I went to Microsoft Ignite 2018 for the first time this year. During the week, I got to chat with lots of folks, including some of the SCCM/ConfigMgr product group. <a href=http://www.twitter.com/ConfigMgrDev>Mark Silvey</a> was kind enough to chat with me about plans for the OData connector that was first introduced in ConfigMgr 1612 Technical Preview. When it was first released it was called CMRestProvider and it had to be enabled in the console (you can read more about this initial implementation <a href=https://docs.microsoft.com/sccm/core/get-started/capabilities-in-technical-preview-1612#odata-endpoint-data-access>here</a>). I never tested the 1612 TP or the service so I was anxious to see how it worked. Mark mentioned that the new service was enabled by default as in the 1810 TP and included an option to enable it to work through a Cloud Management Gateway, meaning, you can access ConfigMgr from internet based clients! Additionally, he mentioned that they are making strides towards to replace ConfigMgr&rsquo;s WMI implementation with this new connector called AdminService. I just started playing with it, so this is not a complete write up, but it should get you started if you want to poke around with the 1810 Technical Preview.</p><p><div class=image><figure><a href=2018-10-14_21-53-54.png target=_blank><img src=2018-10-14_21-53-54.png alt="A Square Dozen Image"></a></figure></div></p><p>The service is installed under <code>&lt;InstallDir>\bin\X64\CMRestProvider</code> where you will find <code>sccmprovidergraph.exe</code> and <code>sccmprovidergraph.exe.config</code> as well as all of the related components. If you check TaskMgr, you will see that <code>sccmprovidergraph.exe</code> is running and the command line that it launches is <code>&lt;InstallDir>\bin\X64\CMRestProvider\sccmprovidergraph.exe -Namespace root\sms\site_&lt;SITECODE></code>. Additionally you will find new log files – 1 for the installation and 2 for services</p><ul><li><code>&lt;InstallDir>\Logs\RESTPROVIDERSetup.log</code> – Install Log</li><li><code>&lt;InstallDir>\CMProviderLog\SMS_REST_PROVIDER.log</code> – Monitors the Graph service.</li><li><code>&lt;InstallDir>\CMProviderLog\AdminService.log</code> – Logs execution of web service calls.</li></ul><p>AdminService is configured to use HTTPS on port 443 by default. I don’t know if it’s supported, but for testing, I changed the setting to use HTTP and port 80 in the <code>sccmprovidergraph.exe.config</code> file since I was having issues authenticating with SSL in PowerShell. I’m sure when they fully document the service, the HTTPS stuff will get easier.</p><p>To test, I used a simple PowerShell script, but you can use your web browser or something like <a href=https://www.getpostman.com/>PostMan</a> - an API testing tool. The script is pretty self-explanatory. You can download it from <a href=https://github.com/AdamGrossTX/PowershellScripts/tree/master/ConfigMgr/AdminService>GitHub</a>.</p><p><div class=image><figure><a href=2018-10-14_21-49-16.jpg target=_blank><img src=2018-10-14_21-49-16.jpg alt="A Square Dozen Image"></a></figure></div></p><p>Edit 10/15/2018 - I missed this initially. If you call the base URL, you can list all of the available AdminService functions. In the <a href=https://renekierstein.wordpress.com/2017/03/26/with-cm-1612-technical-preview-comes-the-restful-odata-api/>blog post</a> by <a href=https://twitter.com/ReneKierstein>René Kierstein</a>, he showed how to do it but the end quote got changed to HTML code ” and I thought it was some secret code. Anyway, here&rsquo;s the script to list all of the functions. I added it to the <a href=https://github.com/AdamGrossTX/PowershellScripts/tree/master/ConfigMgr/AdminService>GitHub Repo</a> as well. Looks like there&rsquo;s about 715 from that list.</p><p>Based on the original documentation, you can get more advanced an pass in ResourceIDs, CollectionIDs, etc. Basically, anything you can do in WMI today, you should be able to do in the AdminService.</p><p>I mentioned the <strong>Cloud Management Gateway</strong> (<strong>CMG</strong>) option. I haven&rsquo;t tested it yet in my TP lab because it requires a <strong>CMG</strong> and other stuff that I don&rsquo;t have set up yet. However, I did check the box to see what happens. It breaks stuff! If you check the AdminService.log you will see that it changes to use <strong>Azure Active Directory</strong> (<strong>AAD</strong>) credentials and if you aren&rsquo;t using AAD, it can&rsquo;t authenticate you to use the service.</p><p><div class=image><figure><a href=2018-10-14_21-57-08.png target=_blank><img src=2018-10-14_21-57-08.png alt="A Square Dozen Image"></a></figure></div></p><p>Additionally, I found a <a href=https://renekierstein.wordpress.com/2017/03/26/with-cm-1612-technical-preview-comes-the-restful-odata-api/>blog post</a> by <a href=https://twitter.com/ReneKierstein>René Kierstein</a> that talked about the 1612 <strong>CMRestProvider</strong> and he has a Word document with all of the available functions at the time (<strong>590</strong>). I set up my PowerShell to loop through each function and attempt the call and check for failures. <del>I ended up with a list of <strong>565</strong> that worked with no extra parameters. I&rsquo;ve uploaded my list to <a href=https://github.com/AdamGrossTX/PowershellScripts/tree/master/ConfigMgr/AdminService>GitHub</a>.</del> EDIT: 10/15/2018 - See script above for listing functions. Current count is <strong>715</strong>. Updated list added to <a href=https://github.com/AdamGrossTX/PowershellScripts/tree/master/ConfigMgr/AdminService>GitHub Repo</a>.</p><p>One last thing. This only worked once and now I can’t seem to reproduce it. I used TaskMgr and stop <code>sccmprovidergraph.exe</code> and relaunch it using psexec.exe -i -s cmd to open a new cmd prompt window as System then launch <code>sccmprovidergraph.exe -Namespace root\sms\site_&lt;SITECODE></code> and it left a command window open and I was able to watch the Graph service in action. It will log all of the AdminService actions live.</p><p>That&rsquo;s it for now. I have only spent a few hours testing it today but it looks encouraging. It will go a long way to helping reduce our dependency on as many amazing community/third party tools that are currently bridging the gap. I can&rsquo;t wait to plug it into <strong>Power BI</strong> and see how it works!</p></div><div class=post-share><div class="post-share-box share-comments">hello</div></div><div class=post-author></div><comments id=comments><script src=https://utteranc.es/client.js repo=AdamGrossTX/asquaredozen issue-term=title label="blog comment" theme=github-light crossorigin=anonymous async></script></comments></article></div></div></div><footer id=footer><div class=container><div id=footer-copyright><p class=copyright>&copy; 2024 Adam Gross - https://www.asquaredozen.com - A Square Dozen</a></p></div></div></footer></div></body></html>